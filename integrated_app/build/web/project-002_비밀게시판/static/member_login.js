console.log('âœ… member_login.js íŒŒì¼ ë¡œë“œ ì™„ë£Œ');function checkLoginStatus(){console.log('ğŸ“ ë¡œê·¸ì¸ í˜ì´ì§€ - ë¡œê·¸ì¸ í¼ í‘œì‹œ');updateLoginUI(false);return false;}
function updateLoginUI(isLoggedIn){const userInfoBar=document.getElementById('userInfoBar');const loginForm=document.getElementById('loginForm');const displayUserId=document.getElementById('displayUserId');const displayUserName=document.getElementById('displayUserName');const session=window.getMemberSession();if(isLoggedIn&&session.sMem_id){userInfoBar.classList.add('active');displayUserId.textContent=session.sMem_id;displayUserName.textContent=session.sMem_name||'ì´ë¦„ì—†ìŒ';loginForm.style.display='none';const sMem_idInput=document.getElementById('sMem_id');const sMem_pwdInput=document.getElementById('sMem_pwd');if(sMem_idInput)sMem_idInput.value='';if(sMem_pwdInput)sMem_pwdInput.value='';console.log('ğŸ§¹ ë¡œê·¸ì¸ ì…ë ¥ í•„ë“œ ì´ˆê¸°í™” ì™„ë£Œ');}else{userInfoBar.classList.remove('active');loginForm.style.display='';displayUserId.textContent='';displayUserName.textContent='';console.log('ğŸ§¹ ë¡œê·¸ì•„ì›ƒ - ì‚¬ìš©ì ì •ë³´ í‘œì‹œ ì˜ì—­ ì´ˆê¸°í™” ì™„ë£Œ');}}
function handleLogout(){window.clearMemberSession();const sMem_idInput=document.getElementById('sMem_id');const sMem_pwdInput=document.getElementById('sMem_pwd');if(sMem_idInput)sMem_idInput.value='';if(sMem_pwdInput)sMem_pwdInput.value='';console.log('ğŸ§¹ ë¡œê·¸ì•„ì›ƒ - ì…ë ¥ í•„ë“œ ì´ˆê¸°í™” ì™„ë£Œ');updateLoginUI(false);alert('âœ… ë¡œê·¸ì•„ì›ƒë˜ì—ˆìŠµë‹ˆë‹¤.');}
(function themeInit(){const btn=document.getElementById('themeBtn');const saved=localStorage.getItem('theme');if(saved)document.documentElement.setAttribute('data-theme',saved);btn.textContent=document.documentElement.getAttribute('data-theme')==='dark'?'ë‹¤í¬':'ë¼ì´íŠ¸';btn.setAttribute('aria-pressed',document.documentElement.getAttribute('data-theme')==='dark');btn.addEventListener('click',()=>{const cur=document.documentElement.getAttribute('data-theme');const next=cur==='dark'?'':'dark';if(next)document.documentElement.setAttribute('data-theme',next);else document.documentElement.removeAttribute('data-theme');localStorage.setItem('theme',next);btn.textContent=next==='dark'?'ë‹¤í¬':'ë¼ì´íŠ¸';btn.setAttribute('aria-pressed',next==='dark');});})();(function(){console.log('ğŸš€ member_login.js ë¡œê·¸ì¸ í¼ ì´ˆê¸°í™” ì‹œì‘');console.log('ğŸ“… í˜„ì¬ ì‹œê°„:',new Date().toISOString());console.log('ğŸŒ í˜„ì¬ URL:',window.location.href);console.log('ğŸ“„ ë¬¸ì„œ ì¤€ë¹„ ìƒíƒœ:',document.readyState);function initLoginForm(){console.log('ğŸ”§ initLoginForm í•¨ìˆ˜ ì‹¤í–‰ ì‹œì‘');const form=document.getElementById('loginForm');const idEl=document.getElementById('loginId');const pwdEl=document.getElementById('loginPwd');const pwdToggle=document.getElementById('pwdToggle');const pwdToggleIcon=document.getElementById('pwdToggleIcon');const remember=document.getElementById('remember');const caps=document.getElementById('capsNotice');console.log('ğŸ” í¼ ìš”ì†Œ í™•ì¸ ì¤‘...');console.log('  - loginForm:',form?'âœ… ë°œê²¬':'âŒ ì—†ìŒ');console.log('  - loginId:',idEl?'âœ… ë°œê²¬':'âŒ ì—†ìŒ');console.log('  - loginPwd:',pwdEl?'âœ… ë°œê²¬':'âŒ ì—†ìŒ');console.log('  - pwdToggle:',pwdToggle?'âœ… ë°œê²¬':'âŒ ì—†ìŒ');console.log('  - remember:',remember?'âœ… ë°œê²¬':'âŒ ì—†ìŒ');console.log('  - caps:',caps?'âœ… ë°œê²¬':'âŒ ì—†ìŒ');if(!form){console.error('âŒ loginForm ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤!');console.error('   - document.body:',document.body);console.error('   - document.querySelector("#loginForm"):',document.querySelector('#loginForm'));return;}
if(!idEl){console.error('âŒ loginId ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤!');return;}
if(!pwdEl){console.error('âŒ loginPwd ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤!');return;}
console.log('âœ… ëª¨ë“  í¼ ìš”ì†Œ ë°œê²¬ ì™„ë£Œ');if(pwdToggle&&pwdEl){pwdToggle.addEventListener('click',()=>{const isPassword=pwdEl.type==='password';pwdEl.type=isPassword?'text':'password';pwdToggleIcon.textContent=isPassword?'ğŸ™ˆ':'ğŸ‘ï¸';pwdToggle.setAttribute('aria-label',isPassword?'ë¹„ë°€ë²ˆí˜¸ ìˆ¨ê¸°ê¸°':'ë¹„ë°€ë²ˆí˜¸ í‘œì‹œ');});}
function handleKey(e){const isCaps=e.getModifierState&&e.getModifierState('CapsLock');caps.style.display=isCaps?'block':'none';}
pwdEl.addEventListener('keydown',handleKey);pwdEl.addEventListener('keyup',handleKey);(function restore(){try{const saved=JSON.parse(localStorage.getItem('loginRemember')||'null');if(saved&&saved.id){idEl.value=saved.id;remember.checked=true;}}catch{}})();function showErr(name){const e=form.querySelector(`.error[data-err="${name}"]`);if(e)e.style.display='block';}
function hideErrs(){form.querySelectorAll('.error').forEach((e)=>(e.style.display='none'));}
async function authenticateUser(id,pwd){try{console.log('ğŸ“¡ ë¡œê·¸ì¸ API í˜¸ì¶œ ì‹œì‘:',{id,pwdLength:pwd.length});const apiUrl='/secret/api/v1/smembers/login';console.log('ğŸŒ API URL:',apiUrl);const response=await fetch(apiUrl,{method:'POST',headers:{'Content-Type':'application/json',},body:JSON.stringify({sMem_id:id,password:pwd,}),});console.log('ğŸ“¨ API ì‘ë‹µ ìƒíƒœ:',response.status,response.statusText);const result=await response.json();console.log('ğŸ“¦ API ì‘ë‹µ ë°ì´í„°:',result);if(result.ok&&result.data){console.log('âœ… ë¡œê·¸ì¸ ì„±ê³µ!');sessionStorage.setItem('currentUser',JSON.stringify(result.data));return{success:true,memberData:result.data,};}
console.log('âŒ ë¡œê·¸ì¸ ì‹¤íŒ¨:',result.error);return{success:false,error:result.error||'ë¡œê·¸ì¸ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.',};}catch(error){console.error('âŒ ì¸ì¦ ì˜¤ë¥˜:',error);console.error('   - ì˜¤ë¥˜ íƒ€ì…:',error.constructor.name);console.error('   - ì˜¤ë¥˜ ë©”ì‹œì§€:',error.message);return{success:false,error:'ì„œë²„ ì—°ê²°ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: '+error.message,};}}
console.log('âœ… loginForm ìš”ì†Œ ë°œê²¬, submit ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë“±ë¡ ì¤‘...');console.log('  - form ìš”ì†Œ:',form);console.log('  - form.id:',form.id);console.log('  - form.tagName:',form.tagName);const submitBtn=form.querySelector('button[type="submit"]');if(submitBtn){console.log('âœ… submit ë²„íŠ¼ ë°œê²¬:',submitBtn);submitBtn.addEventListener('click',function(e){console.log('ğŸ–±ï¸ ë¡œê·¸ì¸ ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸ ë°œìƒ!');console.log('  - ì´ë²¤íŠ¸ íƒ€ì…:',e.type);console.log('  - ë²„íŠ¼:',submitBtn);console.log('  - í¼:',form);if(!form.checkValidity()){console.log('âš ï¸ í¼ ìœ íš¨ì„± ê²€ì‚¬ ì‹¤íŒ¨');form.reportValidity();return;}});}else{console.error('âŒ submit ë²„íŠ¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤!');}
form.addEventListener('submit',async(e)=>{console.log('ğŸ” ë¡œê·¸ì¸ í¼ submit ì´ë²¤íŠ¸ ë°œìƒ!');console.log('  - ì´ë²¤íŠ¸ íƒ€ì…:',e.type);console.log('  - ê¸°ë³¸ ë™ì‘ ì°¨ë‹¨ ì „');e.preventDefault();console.log('  - ê¸°ë³¸ ë™ì‘ ì°¨ë‹¨ í›„');hideErrs();const id=idEl.value.trim();const pwd=pwdEl.value;console.log('ğŸ“ ì…ë ¥ê°’ í™•ì¸:',{id:id?'ì…ë ¥ë¨':'ë¹„ì–´ìˆìŒ',pwdLength:pwd.length});let ok=true;if(!id){showErr('loginId');ok=false;}
if(!pwd||pwd.length<6){showErr('loginPwd');ok=false;}
if(!ok)return;const submitBtn=form.querySelector('button[type="submit"]');const originalText=submitBtn.textContent;submitBtn.textContent='ë¡œê·¸ì¸ ì¤‘...';submitBtn.disabled=true;const result=await authenticateUser(id,pwd);submitBtn.textContent=originalText;submitBtn.disabled=false;if(result.success){if(remember.checked){localStorage.setItem('loginRemember',JSON.stringify({id}));}else{localStorage.removeItem('loginRemember');}
const memberStatus=(result.memberData.sMem_status||result.memberData.smem_status||'').toUpperCase();console.log('ğŸ“‹ íšŒì› ìƒíƒœ(sMem_status):',memberStatus);if(memberStatus!=='OPEN'){alert('âŒ ë¡œê·¸ì¸í•  ìˆ˜ ì—†ëŠ” ê³„ì • ìƒíƒœì…ë‹ˆë‹¤.\nê³„ì • ìƒíƒœ: '+
memberStatus);return;}
const token=Math.random().toString(36).slice(2)+
Math.random().toString(36).slice(2);sessionStorage.setItem('mock_access_token',token);console.log('âœ… ë¡œê·¸ì¸ ì„±ê³µ! ì„œë²„ ì‘ë‹µ:',result);console.log('ğŸ“¦ íšŒì› ë°ì´í„°:',result.memberData);const memberData={sMem_id:result.memberData.sMem_id||result.memberData.smem_id||'',sMem_name:result.memberData.sMem_name||result.memberData.smem_name||'',sMem_nickname:result.memberData.sMem_nickname||result.memberData.smem_nickname||'',sMem_status:memberStatus,adviser_role:result.memberData.adviser_role||result.memberData.adviser_role||'A',};console.log('âœ… ë¡œê·¸ì¸ ì„±ê³µ! íšŒì› ì •ë³´:',memberData);console.log('ğŸ‘¤ ìƒë‹´ì‚¬ ì—­í• (adviser_role):',memberData.adviser_role);window.setMemberSession(memberData);updateLoginUI(true);if(window.parent!==window){console.log('ğŸ“¤ ë¶€ëª¨ í˜ì´ì§€ì— ë¡œê·¸ì¸ ì„±ê³µ ë©”ì‹œì§€ ì „ì†¡');window.parent.postMessage('memberLoginSuccess','*');}else{console.log('âš ï¸ iframeì´ ì•„ë‹Œ í™˜ê²½ì—ì„œ ì‹¤í–‰ ì¤‘');}
alert('âœ… ë¡œê·¸ì¸ ì„±ê³µ!');}else{alert('âŒ '+(result.error||'ë¡œê·¸ì¸ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.'));}});const goSignupBtn=document.getElementById('goSignup');if(goSignupBtn){goSignupBtn.addEventListener('click',(e)=>{e.preventDefault();window.location.href='/secret/member_cardup';});}else{console.error('âŒ goSignup ë²„íŠ¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤!');}}
if(document.readyState==='loading'){console.log('â³ DOMContentLoaded ëŒ€ê¸° ì¤‘...');document.addEventListener('DOMContentLoaded',initLoginForm);}else{console.log('âœ… DOMì´ ì´ë¯¸ ë¡œë“œë¨, ì¦‰ì‹œ ì‹¤í–‰');initLoginForm();}
window.addEventListener('load',function(){console.log('ğŸ“„ window.load ì´ë²¤íŠ¸ ë°œìƒ');const form=document.getElementById('loginForm');if(form){console.log('âœ… window.loadì—ì„œ loginForm í™•ì¸ë¨');const hasListener=form.getAttribute('data-listener-attached');if(!hasListener){console.log('âš ï¸ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆê°€ ì—†ìŒ, ì¬ë“±ë¡ ì‹œë„');initLoginForm();}}});})();(function(){const openBtn=document.getElementById('findBtn');const modal=document.getElementById('findModal');const closeBtn=document.getElementById('findClose');const backdrop=document.getElementById('findBackdrop');const tabId=document.getElementById('tabIdFind');const tabPw=document.getElementById('tabPwdReset');const formIdFind=document.getElementById('formIdFind');const formPwdReset=document.getElementById('formPwdReset');const findEmail=document.getElementById('findEmail');const findMobile=document.getElementById('findMobile');const findBirthdt=document.getElementById('findBirthdt');const resetId=document.getElementById('resetId');const resetEmail=document.getElementById('resetEmail');const resetMobile=document.getElementById('resetMobile');const resetBirthdt=document.getElementById('resetBirthdt');const resultIdFind=document.getElementById('resultIdFind');const resultPwdReset=document.getElementById('resultPwdReset');function openModal(){modal.style.display='block';modal.setAttribute('aria-hidden','false');setTimeout(()=>findEmail.focus(),0);document.body.style.overflow='hidden';window.addEventListener('keydown',escClose);}
function closeModal(){modal.style.display='none';modal.setAttribute('aria-hidden','true');document.body.style.overflow='';window.removeEventListener('keydown',escClose);}
function escClose(e){if(e.key==='Escape')closeModal();}
openBtn?.addEventListener('click',()=>openModal());closeBtn?.addEventListener('click',()=>closeModal());backdrop?.addEventListener('click',()=>closeModal());function setTab(which){const a=which==='id';tabId.classList.toggle('pri',a);tabPw.classList.toggle('pri',!a);tabId.setAttribute('aria-selected',a);tabPw.setAttribute('aria-selected',!a);formIdFind.style.display=a?'':'none';formPwdReset.style.display=a?'none':'';(a?findEmail:resetId).focus();resultIdFind.textContent='';resultPwdReset.textContent='';if(a){findEmail.value='';findMobile.value='';findBirthdt.value='';}else{resetId.value='';resetEmail.value='';resetMobile.value='';resetBirthdt.value='';}}
tabId?.addEventListener('click',()=>setTab('id'));tabPw?.addEventListener('click',()=>setTab('pw'));setTab('id');function getDraft(){try{return(JSON.parse(localStorage.getItem('sMembersDraft')||'null')||null);}catch{return null;}}
function isEmail(v){return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(v||'');}
formIdFind.addEventListener('submit',async(e)=>{e.preventDefault();resultIdFind.textContent='';resultIdFind.style.color='';const mail=(findEmail.value||'').trim();const mobile=(findMobile.value||'').trim();const birthdt=(findBirthdt.value||'').trim();if(!isEmail(mail)){resultIdFind.textContent='ìœ íš¨í•œ ì´ë©”ì¼ì„ ì…ë ¥í•´ ì£¼ì„¸ìš”.';resultIdFind.style.color='var(--err)';return;}
if(!mobile){resultIdFind.textContent='íœ´ëŒ€í°ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ ì£¼ì„¸ìš”.';resultIdFind.style.color='var(--err)';return;}
if(!birthdt){resultIdFind.textContent='ìƒì¼ì„ ì…ë ¥í•´ ì£¼ì„¸ìš”.';resultIdFind.style.color='var(--err)';return;}
try{const response=await fetch('/secret/api/v1/smembers/');if(!response.ok){resultIdFind.textContent='íšŒì› ì •ë³´ ì¡°íšŒì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.';resultIdFind.style.color='var(--err)';return;}
const result=await response.json();const members=result.data||[];console.log('ğŸ” ì•„ì´ë”” ì°¾ê¸° - ì „ì²´ íšŒì› ìˆ˜:',members.length);console.log('ğŸ” ê²€ìƒ‰ ì¡°ê±´:',{mail,mobile,birthdt});const found=members.find((m)=>{const dbEmail=String(m.sMem_email||m.smem_email||'').toLowerCase();const dbMobile=String(m.sMem_mobile||m.smem_mobile||'').trim();const dbBirthdt=String(m.sMem_birthdt||m.smem_birthdt||'').trim();const searchEmail=mail.toLowerCase();const searchMobile=mobile.trim();const searchBirthdt=birthdt.trim();const normalizeDate=(dateStr)=>{if(!dateStr)return'';const date=new Date(dateStr);if(isNaN(date.getTime()))return dateStr;return date.toISOString().split('T')[0];};const dbDateNormalized=normalizeDate(dbBirthdt);const searchDateNormalized=normalizeDate(searchBirthdt);const emailMatch=dbEmail===searchEmail;const mobileMatch=dbMobile===searchMobile;const birthdtMatch=dbDateNormalized===searchDateNormalized;console.log('  ë¹„êµ:',{email:{db:dbEmail,search:searchEmail,match:emailMatch},mobile:{db:dbMobile,search:searchMobile,match:mobileMatch},birthdt:{db:dbDateNormalized,search:searchDateNormalized,match:birthdtMatch}});return emailMatch&&mobileMatch&&birthdtMatch;});if(found){const foundId=found.sMem_id||found.smem_id;console.log('âœ… ì•„ì´ë”” ì°¾ê¸° ì„±ê³µ:',foundId);resultIdFind.innerHTML='<strong style="color: var(--ok);">âœ… ì•„ì´ë””ë¥¼ ì°¾ì•˜ìŠµë‹ˆë‹¤!</strong><br>'+
'ê°€ì… ì•„ì´ë””: <strong style="color: var(--pri); font-size: 16px;">'+
String(foundId)+
'</strong>';resultIdFind.style.color='var(--ok)';findEmail.value='';findMobile.value='';findBirthdt.value='';}else{console.log('âŒ ì•„ì´ë”” ì°¾ê¸° ì‹¤íŒ¨ - ì¼ì¹˜í•˜ëŠ” ì •ë³´ ì—†ìŒ');resultIdFind.textContent='ì…ë ¥í•˜ì‹  ì •ë³´ì™€ ì¼ì¹˜í•˜ëŠ” íšŒì›ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.';resultIdFind.style.color='var(--err)';}}catch(error){console.error('ì•„ì´ë”” ì°¾ê¸° ì˜¤ë¥˜:',error);resultIdFind.textContent='ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš”.';resultIdFind.style.color='var(--err)';}});formPwdReset.addEventListener('submit',async(e)=>{e.preventDefault();resultPwdReset.textContent='';resultPwdReset.style.color='';const id=(resetId.value||'').trim();const mail=(resetEmail.value||'').trim();const mobile=(resetMobile.value||'').trim();const birthdt=(resetBirthdt.value||'').trim();if(!id){resultPwdReset.textContent='ì•„ì´ë””ë¥¼ ì…ë ¥í•´ ì£¼ì„¸ìš”.';resultPwdReset.style.color='var(--err)';return;}
if(!isEmail(mail)){resultPwdReset.textContent='ìœ íš¨í•œ ì´ë©”ì¼ì„ ì…ë ¥í•´ ì£¼ì„¸ìš”.';resultPwdReset.style.color='var(--err)';return;}
if(!mobile){resultPwdReset.textContent='íœ´ëŒ€í°ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ ì£¼ì„¸ìš”.';resultPwdReset.style.color='var(--err)';return;}
if(!birthdt){resultPwdReset.textContent='ìƒì¼ì„ ì…ë ¥í•´ ì£¼ì„¸ìš”.';resultPwdReset.style.color='var(--err)';return;}
try{const checkResponse=await fetch('/secret/api/v1/smembers/');if(!checkResponse.ok){resultPwdReset.textContent='íšŒì› ì •ë³´ ì¡°íšŒì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.';resultPwdReset.style.color='var(--err)';return;}
const checkResult=await checkResponse.json();const members=checkResult.data||[];console.log('ğŸ” ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì • - ì „ì²´ íšŒì› ìˆ˜:',members.length);console.log('ğŸ” ê²€ìƒ‰ ì¡°ê±´:',{id,mail,mobile,birthdt});const found=members.find((m)=>{const dbId=String(m.sMem_id||m.smem_id||'').trim();const dbEmail=String(m.sMem_email||m.smem_email||'').toLowerCase();const dbMobile=String(m.sMem_mobile||m.smem_mobile||'').trim();const dbBirthdt=String(m.sMem_birthdt||m.smem_birthdt||'').trim();const searchId=id.trim();const searchEmail=mail.toLowerCase();const searchMobile=mobile.trim();const searchBirthdt=birthdt.trim();const normalizeDate=(dateStr)=>{if(!dateStr)return'';const date=new Date(dateStr);if(isNaN(date.getTime()))return dateStr;return date.toISOString().split('T')[0];};const dbDateNormalized=normalizeDate(dbBirthdt);const searchDateNormalized=normalizeDate(searchBirthdt);const idMatch=dbId===searchId;const emailMatch=dbEmail===searchEmail;const mobileMatch=dbMobile===searchMobile;const birthdtMatch=dbDateNormalized===searchDateNormalized;console.log('  ë¹„êµ:',{id:{db:dbId,search:searchId,match:idMatch},email:{db:dbEmail,search:searchEmail,match:emailMatch},mobile:{db:dbMobile,search:searchMobile,match:mobileMatch},birthdt:{db:dbDateNormalized,search:searchDateNormalized,match:birthdtMatch}});return idMatch&&emailMatch&&mobileMatch&&birthdtMatch;});if(!found){console.log('âŒ ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì • ì‹¤íŒ¨ - ì¼ì¹˜í•˜ëŠ” ì •ë³´ ì—†ìŒ');resultPwdReset.textContent='ì…ë ¥í•˜ì‹  ì •ë³´ì™€ ì¼ì¹˜í•˜ëŠ” íšŒì›ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.';resultPwdReset.style.color='var(--err)';return;}
const response=await fetch('/secret/api/v1/smembers/reset-password',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({sMem_id:id,sMem_email:mail,sMem_mobile:mobile,sMem_birthdt:birthdt,}),});const result=await response.json();if(result.ok&&result.data){resultPwdReset.innerHTML='<strong style="color: var(--ok);">âœ… ì„ì‹œ ë¹„ë°€ë²ˆí˜¸ê°€ ë°œê¸‰ë˜ì—ˆìŠµë‹ˆë‹¤!</strong><br>'+
'ì„ì‹œ ë¹„ë°€ë²ˆí˜¸: <strong style="color: var(--pri); font-size: 16px;">'+
result.data.tempPassword+
'</strong><br>'+
'<small style="color: var(--warn);">âš ï¸ ë¡œê·¸ì¸ í›„ ë°˜ë“œì‹œ ë¹„ë°€ë²ˆí˜¸ë¥¼ ë³€ê²½í•´ì£¼ì„¸ìš”.</small>';resultPwdReset.style.color='var(--ok)';resetId.value='';resetEmail.value='';resetMobile.value='';resetBirthdt.value='';}else{resultPwdReset.textContent=result.error||'ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì •ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.';resultPwdReset.style.color='var(--err)';}}catch(error){console.error('ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì • ì˜¤ë¥˜:',error);resultPwdReset.textContent='ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš”.';resultPwdReset.style.color='var(--err)';}});function genTempPwd(){const chars='ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnpqrstuvwxyz23456789!@#$%';let s='';for(let i=0;i<10;i++){s+=chars[Math.floor(Math.random()*chars.length)];}
return s;}})();document.addEventListener('DOMContentLoaded',()=>{checkLoginStatus();const logoutBtn=document.getElementById('logoutBtn');if(logoutBtn){logoutBtn.addEventListener('click',handleLogout);}});