<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ì „ë¬¸ê°€ê¸‰ ì‚¬ì£¼ë³´ê¸° ì‹¤ì „ ìƒë‹´ ì‹œìŠ¤í…œìœ¼ë¡œ ì‚¬ì£¼í’€ì´ ë¬´ë£Œë³´ê¸° | ì •í™•í•œ ì‚¬ì£¼ë¶„ì„ - ë‚˜ë¼í†¡í†¡(naratt.kr) ìš´ì„¸ë³´ê¸°</title>
    <meta name="description" content="ì •í™•í•œ ìƒë…„ì›”ì¼ì‹œë¥¼ ë°”íƒ•ìœ¼ë¡œ í•œ ë§Œì„¸ë ¥ ì¡°íšŒì™€ ì‹¬ì¸µ ì‚¬ì£¼í’€ì´ ë¬´ë£Œë³´ê¸°ë¡œ ì—°ì• ìš´, ì¬ë¬¼ìš´, ì§ì—…ìš´ì„ í™•ì¸í•˜ì„¸ìš”. ë‚˜ë¼í†¡í†¡ì—ì„œ ì •í™•í•œ ì‚¬ì£¼ë¶„ì„ ì„œë¹„ìŠ¤ë¥¼ ì œê³µí•©ë‹ˆë‹¤.">
    <meta name="keywords" content="ì‚¬ì£¼í’€ì´, ë¬´ë£Œì‚¬ì£¼, ì‚¬ì£¼ë³´ê¸°, ëª…ë¦¬í•™">
    <link rel="stylesheet" href="{{ url_for('static', filename='saju_style_exec.css') }}" />
    <link
      rel="stylesheet"
      href="{{ url_for('common_static', filename='security.css') }}"
    />
  </head>
  <body>
    <div class="container">
      <header class="header">
        <h1>ì „ë¬¸ê°€ê¸‰ ì‚¬ì£¼ë³´ê¸° ì‹¤ì „ ìƒë‹´ ì‹œìŠ¤í…œ</h1>
        <p class="subtitle">
          ê²©êµ­ Â· ìš©ì‹  Â· í¬ê¸°ì‹  Â· ìœ¡ì¹œ Â· ì‚¬ì£¼ê°•ì•½ Â· ì‹­ì´ìš´ì„± Â· ì§€ì¥ê°„ Â· í˜•ì¶©íŒŒí•´
          Â· ì‹ ì‚´ Â· ë‚©ìŒ ë¶„ì„
        </p>
      </header>

      <div class="input-section">
        <h2>ì‚¬ì£¼ ì •ë³´ ì…ë ¥</h2>

        <!-- ì„±ëª… ì…ë ¥ -->
        <div class="input-row-inline">
          <label for="name">ì„±ëª… (å§“å)</label>
          <input
            type="text"
            id="name"
            placeholder="ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”"
            style="flex: 1; font-size: 0.9em"
          />
        </div>

        <!-- ì„±ë³„ ì„ íƒ -->
        <div class="input-row-inline">
          <label>ì„±ë³„ (æ€§åˆ¥)</label>
          <div class="radio-group" style="flex: 1; display: flex; gap: 20px">
            <label class="radio-label">
              <input type="radio" name="gender" value="male" checked />
              <span>ë‚¨ì (ä¹¾å‘½)</span>
            </label>
            <label class="radio-label">
              <input type="radio" name="gender" value="female" />
              <span>ì—¬ì (å¤å‘½)</span>
            </label>
          </div>
        </div>

        <!-- ì—­ë²• ì„ íƒ -->
        <div class="input-row-inline">
          <label>ì—­ë²• (æ›†æ³•)</label>
          <div class="radio-group" style="flex: 1; display: flex; gap: 20px; align-items: center;">
            <label class="radio-label">
              <input type="radio" name="calendar" value="solar" checked />
              <span>ì–‘ë ¥ (é™½æ›†)</span>
            </label>
            <label class="radio-label">
              <input type="radio" name="calendar" value="lunar" />
              <span>ìŒë ¥ (é™°æ›†)</span>
            </label>
            <!-- ìœ¤ë‹¬ ì²´í¬ (ìŒë ¥ì¼ ë•Œë§Œ í‘œì‹œ) -->
            <label class="checkbox-label" id="yundal-section" style="display: none; margin-left: 10px;">
              <input type="checkbox" id="yundal" name="yundal" />
              <span>ìœ¤ë‹¬ (é–æœˆ)</span>
            </label>
          </div>
        </div>

        <!-- ìƒë…„ì›”ì¼ ì…ë ¥ (í•œ ì¤„) -->
        <div
          class="input-row-inline"
          style="gap: 0; display: flex; align-items: center"
        >
          <label style="margin: 0; padding-right: 33px"
            >ìƒë…„ì›”ì¼ (å¹´æœˆæ—¥)</label
          >
          <input
            type="number"
            id="year"
            placeholder="1990"
            min="1900"
            max="2100"
            style="width: 30px; margin: 0; padding: 8px 6px"
          />
          <label style="margin: 0; padding-left: 10px; padding-right: 8px"
            >ë…„(å¹´)</label
          >
          <input
            type="number"
            id="month"
            placeholder="1-12"
            min="1"
            max="12"
            style="width: 30px; margin: 0; padding: 8px 6px"
          />
          <label style="margin: 0; padding-left: 10px; padding-right: 8px"
            >ì›”(æœˆ)</label
          >
          <input
            type="number"
            id="day"
            placeholder="1-31"
            min="1"
            max="31"
            style="width: 30px; margin: 0; padding: 8px 6px"
          />
          <label style="margin: 0; padding-left: 10px; padding-right: 8px"
            >ì¼(æ—¥)</label
          >
        </div>

        <!-- ì¶œìƒì‹œê° ì…ë ¥ ë°©ì‹ ì„ íƒ -->
        <div class="input-row-inline">
          <label>ì¶œìƒì‹œê° ì…ë ¥ ë°©ì‹</label>
          <div class="radio-group" style="flex: 1; display: flex; gap: 20px">
            <label class="radio-label">
              <input type="radio" name="timeInputType" value="time" checked />
              <span>ì‹œê° ì…ë ¥</span>
            </label>
            <label class="radio-label">
              <input type="radio" name="timeInputType" value="ganji" />
              <span>ê°„ì§€ ì…ë ¥</span>
            </label>
          </div>
        </div>

        <!-- ì‹œê° ì§ì ‘ ì…ë ¥ -->
        <div id="time-input-section" class="time-input-section">
          <div class="input-row-inline">
            <label>ì¶œìƒì‹œê° (æ™‚åˆ»)</label>
            <input
              type="number"
              id="hour"
              placeholder="ì‹œ (0-23)"
              min="0"
              max="23"
              style="width: 50px"
            />
            <span style="margin: 0 3px; font-size: 1.2em; font-weight: 700"
              >:</span
            >
            <input
              type="number"
              id="minute"
              placeholder="ë¶„ (0-59)"
              min="0"
              max="59"
              style="width: 50px"
            />
            <span style="margin-left: 10px; font-size: 0.9em; color: #666"
              >24ì‹œê°„ í˜•ì‹ (ì˜ˆ: ì˜¤í›„ 3ì‹œ 30ë¶„ = 15:30)</span
            >
          </div>
        </div>

        <!-- ê°„ì§€ ì„ íƒ ì…ë ¥ -->
        <div
          id="ganji-input-section"
          class="ganji-input-section"
          style="display: none"
        >
          <label>ì¶œìƒ ì‹œì£¼ (æ™‚æŸ±)</label>
          <select id="hour-ji-select" class="ganji-select">
            <option value="">ì‹œì£¼ë¥¼ ì„ íƒí•˜ì„¸ìš”</option>
            <option value="å­-å¤œ">
              å¤œå­æ™‚ (23:30~00:29) - ë°¤ 11ì‹œ 30ë¶„ ~ ìì • 29ë¶„
            </option>
            <option value="å­-æœ">
              æœå­æ™‚ (00:30~01:29) - ìì • 30ë¶„ ~ ìƒˆë²½ 1ì‹œ 29ë¶„
            </option>
            <option value="å­">
              å­æ™‚ (23:30~01:29) - ë°¤ 11ì‹œ 30ë¶„ ~ ìƒˆë²½ 1ì‹œ 29ë¶„
            </option>
            <option value="ä¸‘">
              ä¸‘æ™‚ (01:30~03:29) - ìƒˆë²½ 1ì‹œ 30ë¶„ ~ 3ì‹œ 29ë¶„
            </option>
            <option value="å¯…">
              å¯…æ™‚ (03:30~05:29) - ìƒˆë²½ 3ì‹œ 30ë¶„ ~ 5ì‹œ 29ë¶„
            </option>
            <option value="å¯">
              å¯æ™‚ (05:30~07:29) - ìƒˆë²½ 5ì‹œ 30ë¶„ ~ 7ì‹œ 29ë¶„
            </option>
            <option value="è¾°">
              è¾°æ™‚ (07:30~09:29) - ì•„ì¹¨ 7ì‹œ 30ë¶„ ~ 9ì‹œ 29ë¶„
            </option>
            <option value="å·³">
              å·³æ™‚ (09:30~11:29) - ì˜¤ì „ 9ì‹œ 30ë¶„ ~ 11ì‹œ 29ë¶„
            </option>
            <option value="åˆ">
              åˆæ™‚ (11:30~13:29) - ë‚® 11ì‹œ 30ë¶„ ~ ì˜¤í›„ 1ì‹œ 29ë¶„
            </option>
            <option value="æœª">
              æœªæ™‚ (13:30~15:29) - ì˜¤í›„ 1ì‹œ 30ë¶„ ~ 3ì‹œ 29ë¶„
            </option>
            <option value="ç”³">
              ç”³æ™‚ (15:30~17:29) - ì˜¤í›„ 3ì‹œ 30ë¶„ ~ 5ì‹œ 29ë¶„
            </option>
            <option value="é…‰">
              é…‰æ™‚ (17:30~19:29) - ì˜¤í›„ 5ì‹œ 30ë¶„ ~ 7ì‹œ 29ë¶„
            </option>
            <option value="æˆŒ">
              æˆŒæ™‚ (19:30~21:29) - ì €ë… 7ì‹œ 30ë¶„ ~ 9ì‹œ 29ë¶„
            </option>
            <option value="äº¥">
              äº¥æ™‚ (21:30~23:29) - ë°¤ 9ì‹œ 30ë¶„ ~ 11ì‹œ 29ë¶„
            </option>
            <option value="ë¯¸ìƒ">æ™‚æœªè©³ (ì‹œê°ì„ ëª¨ë¦„)</option>
          </select>
          <div class="input-help">
            ì¶œìƒ ì‹œê°„ì„ ì •í™•íˆ ëª¨ë¥´ì‹œë©´ 'æ™‚æœªè©³'ì„ ì„ íƒí•˜ì„¸ìš”
          </div>
        </div>

        <div style="display: flex; gap: 10px; align-items: center; flex-wrap: wrap;">
          <button class="analyze-btn" id="analyze-btn">ğŸ”® ì‚¬ì£¼ë³´ê¸°</button>
          <button class="analyze-btn" id="db-save-btn" style="background-color: #ffc107; border-color: #ffc107; color: #000;">ğŸ’¾ DBì €ì¥</button>
          <button class="analyze-btn" id="send-btn" style="background-color: #17a2b8; border-color: #17a2b8;">ğŸ“¤ ë³´ë‚´ê¸°</button>
          <button class="analyze-btn" id="db-view-btn" style="background-color: #28a745; border-color: #28a745;">ğŸ“Š DBë³´ê¸°</button>
        </div>

        <!-- <div class="input-notice"> -->
        <!--  <p>ğŸ“Œ <strong>ì…ë ¥ ì•ˆë‚´:</strong></p> -->
        <!--  <ul> -->
        <!--    <li>ì •í™•í•œ ì‚¬ì£¼ ë¶„ì„ì„ ìœ„í•´ ì˜¬ë°”ë¥¸ ì •ë³´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”</li> -->
        <!--    <li>ìŒë ¥ì˜ ê²½ìš° ìœ¤ë‹¬ ì—¬ë¶€ë¥¼ ì •í™•íˆ ì²´í¬í•´ì£¼ì„¸ìš”</li> -->
        <!--    <li> -->
        <!--      ì‹œê°ì„ ëª¨ë¥´ì‹œë©´ ì‹œì£¼ ë¶„ì„ì´ ì œì™¸ë˜ì§€ë§Œ, ë‚˜ë¨¸ì§€ ë¶„ì„ì€ ê°€ëŠ¥í•©ë‹ˆë‹¤ -->
        <!--    </li> -->
        <!--  </ul> -->
        <!--</div> -->
      </div>

      <div id="result-section" class="result-section hidden">
        <!-- STEP 1: ì‚¬ì£¼íŒ”ì ê¸°ë³¸ êµ¬ì¡° -->
        <section class="analysis-section">
          <!--<h2 class="section-title"> -->
          <!--  ğŸ“Š STEP 1. å››æŸ±å…«å­— (ì‚¬ì£¼íŒ”ì) ê¸°ë³¸ êµ¬ì¡° -->
          <!--</h2> -->
          <div class="pillars-container">
            <div class="pillar-card">
              <div class="pillar-title">æ™‚æŸ± (ì‹œì£¼)</div>
              <div class="pillar-content">
                <div class="sipseong-label" id="hour-gan-sipseong"></div>
                <div class="gan-box" id="hour-gan"></div>
                <div class="ji-box" id="hour-ji"></div>
                <div class="sipseong-label" id="hour-ji-sipseong"></div>
                <div class="sibiun-box" id="hour-sibiun"></div>
              </div>
              <div class="napeum-info" id="hour-napeum"></div>
              <div class="gongmang-info" id="hour-gongmang"></div>
              <div class="pillar-desc">ë§ë…„Â·ìì‹Â·55ì„¸ ì´í›„</div>
            </div>
            <div class="pillar-card highlight-day">
              <div class="pillar-title">æ—¥æŸ± (ì¼ì£¼) â­</div>
              <div class="pillar-content">
                <div class="sipseong-label" id="day-gan-sipseong"></div>
                <div class="gan-box" id="day-gan"></div>
                <div class="ji-box" id="day-ji"></div>
                <div class="sipseong-label" id="day-ji-sipseong"></div>
                <div class="sibiun-box" id="day-sibiun"></div>
              </div>
              <div class="napeum-info" id="day-napeum"></div>
              <div class="gongmang-info" id="day-gongmang"></div>
              <div class="pillar-desc">ë³¸ì¸Â·ë°°ìš°ìÂ·33-55ì„¸</div>
            </div>
            <div class="pillar-card">
              <div class="pillar-title">æœˆæŸ± (ì›”ì£¼)</div>
              <div class="pillar-content">
                <div class="sipseong-label" id="month-gan-sipseong"></div>
                <div class="gan-box" id="month-gan"></div>
                <div class="ji-box" id="month-ji"></div>
                <div class="sipseong-label" id="month-ji-sipseong"></div>
                <div class="sibiun-box" id="month-sibiun"></div>
              </div>
              <div class="napeum-info" id="month-napeum"></div>
              <div class="gongmang-info" id="month-gongmang"></div>
              <div class="pillar-desc">ë¶€ëª¨Â·ì§ì¥Â·17-33ì„¸</div>
            </div>
            <div class="pillar-card">
              <div class="pillar-title">å¹´æŸ± (ë…„ì£¼)</div>
              <div class="pillar-content">
                <div class="sipseong-label" id="year-gan-sipseong"></div>
                <div class="gan-box" id="year-gan"></div>
                <div class="ji-box" id="year-ji"></div>
                <div class="sipseong-label" id="year-ji-sipseong"></div>
                <div class="sibiun-box" id="year-sibiun"></div>
              </div>
              <div class="napeum-info" id="year-napeum"></div>
              <div class="gongmang-info" id="year-gongmang"></div>
              <div class="pillar-desc">ì¡°ìƒÂ·ì–´ë¦°ì‹œì ˆÂ·1-17ì„¸</div>
            </div>
          </div>

          <!-- ì˜¤í–‰ ì§‘ê³„ -->
          <div
            id="pillar-element-summary"
            style="
              margin-top: 8px;
              padding: 8px;
              background: #f8f9fa;
              border-radius: 6px;
              text-align: center;
              font-size: 0.9em;
              font-weight: 600;
              color: #333;
            "
          ></div>
        </section>

        <!-- STEP 17: ëŒ€ìš´ ë¶„ì„ (ìœ„ì¹˜ ì´ë™) -->
        <section class="analysis-section">
          <div class="analysis-card full-width">
            <!-- <h3 style="display: none"> -->
            <!--   ğŸŒŠ STEP 17. å¤§é‹ (ëŒ€ìš´) íë¦„ - 10ë…„ ì£¼ê¸° -->
            <!-- </h3> -->
            <div id="daeun-chart" class="daeun-chart"></div>
            <div id="daeun-summary"></div>
          </div>
        </section>

        <!-- STEP 2: ì¼ê°„ ë¶„ì„ -->
        <section class="analysis-section">
          <h2 class="section-title">ğŸ¯ 2.æ—¥å¹² (ì¼ê°„)</h2>
          <div class="analysis-card critical-card">
            <div id="daymaster-analysis"></div>
          </div>
        </section>

        <!-- STEP 3: ì‚¬ì£¼ ê°•ì•½ íŒë‹¨ -->
        <section class="analysis-section">
          <h2 class="section-title">âš–ï¸ 3.å››æŸ±å¼ºå¼± (ì‚¬ì£¼ ê°•ì•½)</h2>
          <div class="analysis-card critical-card">
            <div id="strength-analysis"></div>
          </div>
        </section>

        <!-- STEP 4: ê²©êµ­ ë¶„ì„ -->
        <section class="analysis-section">
          <h2 class="section-title">ğŸ‘‘ 4.æ ¼å±€ (ê²©êµ­)</h2>
          <div class="analysis-card important-card">
            <div id="gyeokguk-analysis"></div>
          </div>
        </section>

        <!-- STEP 5: ìš©ì‹ Â·í¬ì‹ Â·ê¸°ì‹  ë¶„ì„ -->
        <section class="analysis-section">
          <h2 class="section-title">ğŸ”‘ 5.ç”¨ç¥Â·å–œç¥Â·å¿Œç¥ (ìš©ì‹ Â·í¬ì‹ Â·ê¸°ì‹ )</h2>
          <div class="analysis-card critical-card">
            <div id="yongsin-analysis"></div>
          </div>
        </section>

        <div class="analysis-grid">
          <!-- STEP 6: ì˜¤í–‰ ë¶„ì„ -->
          <div class="analysis-card">
            <h3>ğŸ“Š 6.äº”è¡Œ (ì˜¤í–‰) ë¶„í¬ë„</h3>
            <div id="element-chart" class="element-chart"></div>
            <div id="element-summary" class="element-summary"></div>
          </div>

          <!-- STEP 7: ìŒì–‘ ë¶„ì„ -->
          <div class="analysis-card">
            <h3>â˜¯ï¸ 7.é™°é™½ (ìŒì–‘) ê· í˜•</h3>
            <div id="yinyang-chart" class="yinyang-chart"></div>
            <div id="yinyang-summary" class="yinyang-summary"></div>
          </div>

          <!-- STEP 8: ì§€ì¥ê°„ ë¶„ì„ -->
          <div class="analysis-card full-width">
            <h3>ğŸŒ¿ 8.åœ°è—å¹² (ì§€ì¥ê°„)</h3>
            <div id="jijanggan-analysis" class="jijanggan-analysis"></div>
          </div>

          <!-- STEP 9: ì‹­ì„± ë¶„ì„ -->
          <div class="analysis-card full-width">
            <h3>â­ 9.åæ˜Ÿ (ì‹­ì„±)</h3>
            <div id="sipseong-analysis" class="sipseong-analysis"></div>
            <div id="sipseong-summary" class="sipseong-summary"></div>
          </div>

          <!-- STEP 10: ì‹­ì´ìš´ì„± ë¶„ì„ -->
          <div class="analysis-card full-width">
            <h3>ğŸ”„ 10.åäºŒé‹æ˜Ÿ (ì‹­ì´ìš´ì„±)</h3>
            <div id="sibiun-detail-analysis"></div>
          </div>

          <!-- STEP 11: ìœ¡ì¹œ ë¶„ì„ -->
          <div class="analysis-card full-width important-card">
            <h3>ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ 11.å…­è¦ª (ìœ¡ì¹œ) - ì¸ê°„ê´€ê³„</h3>
            <div id="yukchin-analysis"></div>
          </div>

          <!-- STEP 12: í•© ë¶„ì„ -->
          <div class="analysis-card full-width">
            <h3>ğŸ¤ 12.åˆ (í•©)</h3>
            <div id="hap-analysis"></div>
          </div>

          <!-- STEP 13: í˜•ì¶©íŒŒí•´ ë¶„ì„ (ê°•í™” ë²„ì „) -->
          <div class="analysis-card full-width warning-card">
            <h3>âš¡ 13.åˆ‘æ²–ç ´å®³ (í˜•ì¶©íŒŒí•´)</h3>
            <div id="hyungchung-analysis"></div>
          </div>

          <!-- STEP 14: ì‹ ì‚´ ë¶„ì„ -->
          <div class="analysis-card full-width">
            <h3>âœ¨ 14.ì‹ ì‚´(ç¥æ®º) - íŠ¹ìˆ˜ ê¸¸í‰</h3>
            <div id="sinsal-analysis"></div>
          </div>

          <!-- STEP 21: ì‹­ì´ì‹ ì‚´ ë¶„ì„ -->
          <div class="analysis-card full-width">
            <h3>ğŸ”® 21.åäºŒç¥æ®º (ì‹­ì´ì‹ ì‚´)</h3>
            <div id="sibi-sinsal-analysis"></div>
          </div>

          <!-- STEP 22: ê¸¸ì‹ ë¥˜ ë¶„ì„ -->
          <div class="analysis-card full-width">
            <h3>ğŸŒŸ 22.å‰ç¥é¡ (ê¸¸ì‹ ë¥˜)</h3>
            <div id="gilsin-analysis"></div>
          </div>

          <!-- STEP 23: ê·¸ì™¸ ì‹ ì‚´ ë¶„ì„ -->
          <div class="analysis-card full-width">
            <h3>â­ 23.å…¶ä»–ç¥æ®º (ê·¸ì™¸ ì‹ ì‚´)</h3>
            <div id="extra-sinsal-analysis"></div>
          </div>

          <!-- STEP 15: ê³µë§ ìƒì„¸ ë¶„ì„ -->
          <div class="analysis-card full-width">
            <h3>ğŸ•³ï¸ 15.ê³µë§(ç©ºäº¡)</h3>
            <div id="gongmang-detail-analysis"></div>
          </div>

          <!-- STEP 16: íŠ¹ìˆ˜ ì‹ ì‚´ -->
          <div class="analysis-card full-width">
            <h3>ğŸ”® 16.íŠ¹ìˆ˜ ì‹ ì‚´</h3>
            <div id="special-sinsal-analysis"></div>
          </div>

          <!-- STEP 18: ì„¸ìš´ ë¶„ì„ -->
          <div class="analysis-card full-width">
            <h3>ğŸ“… 18.æ­²é‹ (ì„¸ìš´)/ 17.å¤§é‹ (ëŒ€ìš´) íë¦„(ìœ„ì—ì°¸ì¡°)</h3>
            <div id="sewun-analysis"></div>
          </div>

          <!-- STEP 19: ì¢…í•© í•´ì„ -->
          <div class="analysis-card full-width final-card">
            <h3>ğŸ“– 19.ç¶œåˆå‘½ç† (ì¢…í•© ëª…ë¦¬)</h3>
            <div id="comprehensive-analysis"></div>
          </div>

          <!-- STEP 20: ê°œìš´ ë°©ë²• -->
          <div class="analysis-card full-width action-card">
            <h3>ğŸ 20.ê°œìš´(é–‹é‹) ë°©ë²• ë° ì‹¤ì²œ ì‚¬í•­</h3>
            <div id="gaewun-guide"></div>
          </div>
        </div>


        <section id="resultWrap" class="card result-card hidden">
          <div id="sajuDisplay" class="saju-grid"></div>
          <div id="gwaeBlock" class="gwae-block"></div>
          <div id="disclaimer" class="disclaimer">
            <!-- í•˜ë‹¨ SEO ì„¤ëª… ì˜ì—­ <section class="seo-description"> -->
            <h2>ì‚¬ì£¼í’€ì´ ë¬´ë£Œë³´ê¸°</h2>
            <p>
            â€» ì‚¬ì£¼í’€ì´ëŠ” íƒœì–´ë‚œ ì—°Â·ì›”Â·ì¼Â·ì‹œë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì˜¤í–‰ê³¼ ì‹­ì„±ì„ ë¶„ì„í•˜ì—¬
            ì¸ìƒì˜ íë¦„ê³¼ ìš´ì„¸ë¥¼ í•´ì„í•˜ëŠ” ë™ì–‘ ëª…ë¦¬í•™ì…ë‹ˆë‹¤.
            </p>
            <p>
            â€» ë‚˜ë¼í†¡í†¡ ì‚¬ì£¼í’€ì´ëŠ” ì´ˆë³´ìë„ ì´í•´í•˜ê¸° ì‰½ê²Œ í’€ì´ë¥¼ ì œê³µí•©ë‹ˆë‹¤.
            </p>
            â€» ì‚¬ì£¼í’€ì´ëŠ” ì°¸ê³ ìë£Œì…ë‹ˆë‹¤. ì‹¤ì œ ì„ íƒê³¼ ë…¸ë ¥ì´ ë” ì¤‘ìš”í•©ë‹ˆë‹¤.
            ç›¡äººäº‹å¾…å¤©å‘½
          </div>
        </section>    


      </div>
    </div>
        
    

    <script src="{{ url_for('static', filename='saju_api_exec.js') }}"></script>
    <script src="{{ url_for('static', filename='saju_sinsal_extended.js') }}"></script>
    <script src="{{ url_for('static', filename='saju_script_exec.js') }}"></script>

    <!-- íšŒì› ì„¸ì…˜ ì „ì—­ ë³€ìˆ˜ (ê³µí†µ íŒŒì¼) -->
    <script src="{{ url_for('common_static', filename='member_session.js') }}"></script>
    <!-- ê´€ë¦¬ì ì„¸ì…˜ ì „ì—­ ë³€ìˆ˜ ê´€ë¦¬ (ê³µí†µ íŒŒì¼) -->
    <script src="{{ url_for('common_static', filename='admin_session.js') }}"></script>
    <!-- ì„œë²„ ì„¸ì…˜ ë°ì´í„°ë¡œ ì „ì—­ ë³€ìˆ˜ ì´ˆê¸°í™” -->
    <script>
      // ì„œë²„ì—ì„œ ì „ë‹¬ë°›ì€ ì„¸ì…˜ ë°ì´í„°ë¡œ ì „ì—­ ë³€ìˆ˜ ì´ˆê¸°í™”
      console.log('ğŸ”§ ì„œë²„ ì„¸ì…˜ ì´ˆê¸°í™” ì‹œì‘');
      {% if member_session %}
      console.log('âœ… member_session ì¡´ì¬:', {{ member_session | tojson }});
      if (typeof setMemberSession === 'function') {
        setMemberSession({{ member_session | tojson }});
        console.log('âœ… setMemberSession í˜¸ì¶œ ì™„ë£Œ');
      } else {
        console.error('âŒ setMemberSession í•¨ìˆ˜ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
      }
      {% else %}
      console.log('âš ï¸ member_sessionì´ ì„œë²„ì—ì„œ ì „ë‹¬ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.');
      console.log('   - íšŒì› ë¡œê·¸ì¸ì„ í•˜ì…¨ë‹¤ë©´, ë‹¤ë¥¸ íƒ­ì—ì„œ ë¡œê·¸ì¸í•˜ì‹  ê²ƒì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
      console.log('   - ì´ í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨(F5) í•´ë³´ì„¸ìš”.');
      {% endif %}
      {% if admin_session %}
      if (typeof setAdminSession === 'function') {
        setAdminSession({{ admin_session | tojson }});
      }
      {% endif %}
    </script>
    <!-- ë³µì‚¬ë°©ì§€ ì„¸ì…˜ ì „ì—­ ë³€ìˆ˜ ê´€ë¦¬ -->
    <script src="{{ url_for('common_static', filename='security.js') }}"></script>
    <script>
      // ticket_idë¥¼ ì €ì¥í•  ì „ì—­ ë³€ìˆ˜
      let currentTicketId = null;
      
      // URLì—ì„œ ticket_id íŒŒë¼ë¯¸í„° ì½ê¸°
      function getTicketIdFromUrl() {
        const urlParams = new URLSearchParams(window.location.search);
        let ticketId = urlParams.get('ticket_id');
        
        // URLì— ticket_idê°€ ì—†ìœ¼ë©´ pendingTicketId í™•ì¸ (ë¡œê·¸ì¸ í›„ ëŒì•„ì˜¨ ê²½ìš°)
        if (!ticketId) {
          const pendingTicketId = sessionStorage.getItem('pendingTicketId');
          if (pendingTicketId) {
            console.log('   ğŸ“‹ pendingTicketId ë°œê²¬:', pendingTicketId);
            ticketId = pendingTicketId;
            sessionStorage.removeItem('pendingTicketId');
          }
        }
        
        return ticketId;
      }
      
      // í˜ì´ì§€ ë¡œë“œ ì‹œ ticket_id í™•ì¸ ë° ë°ì´í„° ë¡œë“œ/ë³µì›
      window.addEventListener('DOMContentLoaded', function() {
        console.log('ğŸš€ DOMContentLoaded - í˜ì´ì§€ ì´ˆê¸°í™” ì‹œì‘');
        
        const ticketId = getTicketIdFromUrl();
        console.log('   - ticket_id:', ticketId);
        
        const returnAfterLogin = sessionStorage.getItem('returnAfterLogin');
        const hasSajuFormData = sessionStorage.getItem('sajuFormData');
        console.log('   - returnAfterLogin:', returnAfterLogin);
        console.log('   - hasSajuFormData:', hasSajuFormData ? 'YES' : 'NO');
        
        if (ticketId) {
          currentTicketId = ticketId;
          console.log('âœ… ticket_id ì¡´ì¬ - í‹°ì¼“ ë°ì´í„° ë¡œë“œ:', currentTicketId);
          
          // ticket_idê°€ ìˆìœ¼ë©´ ë°”ë¡œ ë°ì´í„° ë¡œë“œ (ì¸ì¦ì€ APIì—ì„œ ì²˜ë¦¬)
          window['loadTicketData'](ticketId);
        } else if (returnAfterLogin === 'true' && hasSajuFormData) {
          // ë¡œê·¸ì¸ í›„ ëŒì•„ì˜¨ ê²½ìš° ë°ì´í„°ë§Œ ë³µì› (ìë™ ì‹¤í–‰ ì•ˆ í•¨)
          console.log('ğŸ”„ ë¡œê·¸ì¸ í›„ ëŒì•„ì˜´ - ë°ì´í„° ë³µì›ë§Œ ìˆ˜í–‰');
          
          // ì•½ê°„ì˜ ì§€ì—° í›„ ë³µì› (DOMì´ ì™„ì „íˆ ì¤€ë¹„ë˜ë„ë¡)
          setTimeout(() => {
            console.log('â° ë°ì´í„° ë³µì› ì‹¤í–‰');
            
            // ë°ì´í„° ë³µì›
            const restored = restoreFormData();
            
            if (restored) {
              console.log('âœ… ë°ì´í„° ë³µì› ì™„ë£Œ');
              console.log('â„¹ï¸  ì´ì œ ë¡œê·¸ì¸ëœ ìƒíƒœì´ë¯€ë¡œ ì›í•˜ëŠ” ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”.');
              
              // sessionStorage í´ë¦¬ì–´
              sessionStorage.removeItem('returnAfterLogin');
              
              // ì‚¬ìš©ìì—ê²Œ ì•Œë¦¼
              alert('âœ… ë¡œê·¸ì¸ ì„±ê³µ!\n\nì…ë ¥í•˜ì‹  ë°ì´í„°ê°€ ë³µì›ë˜ì—ˆìŠµë‹ˆë‹¤.\n"ì‚¬ì£¼ë³´ê¸°" ë²„íŠ¼ì„ í´ë¦­í•˜ì—¬ ë‹¤ì‹œ ë¶„ì„í•˜ì‹  í›„\nì›í•˜ëŠ” ì‘ì—…(DBì €ì¥, ë³´ë‚´ê¸°, DBë³´ê¸°)ì„ ìˆ˜í–‰í•˜ì„¸ìš”.');
            } else {
              console.error('âŒ ë°ì´í„° ë³µì› ì‹¤íŒ¨');
              sessionStorage.removeItem('returnAfterLogin');
              sessionStorage.removeItem('sajuFormData');
            }
          }, 500);
        } else if (hasSajuFormData && !ticketId) {
          // ë¡œê·¸ì¸ ì·¨ì†Œ í›„ ëŒì•„ì˜¨ ê²½ìš° (returnAfterLoginì€ ì—†ì§€ë§Œ sajuFormDataëŠ” ìˆìŒ)
          console.log('ğŸ”„ ë¡œê·¸ì¸ ì·¨ì†Œ í›„ ëŒì•„ì˜´ - ë°ì´í„° ë³µì› ìˆ˜í–‰');
          
          setTimeout(() => {
            console.log('â° ë°ì´í„° ë³µì› ì‹¤í–‰ (ì·¨ì†Œ í›„ ë³µê·€)');
            
            const restored = restoreFormData();
            
            if (restored) {
              console.log('âœ… ë°ì´í„° ë³µì› ì™„ë£Œ (ì·¨ì†Œ í›„ ë³µê·€)');
              // ì•Œë¦¼ ì—†ì´ ì¡°ìš©íˆ ë³µì›
            } else {
              console.error('âŒ ë°ì´í„° ë³µì› ì‹¤íŒ¨');
              sessionStorage.removeItem('sajuFormData');
            }
          }, 300);
        } else {
          console.log('â„¹ï¸ ì¼ë°˜ í˜ì´ì§€ ë¡œë“œ (ë³µì› ì—†ìŒ)');
        }
      });
      
      // ticket ë°ì´í„° ë¡œë“œ í•¨ìˆ˜
      async function loadTicketData(ticketId) {
        try {
          console.log('ğŸ”„ í‹°ì¼“ ë°ì´í„° ë¡œë“œ ì‹œì‘:', ticketId);
          const response = await fetch(`/secret/api/v1/tickets/${ticketId}`);
          
          if (!response.ok) {
            throw new Error(`HTTP ${response.status}: ${response.statusText}`);
          }
          
            const result = await response.json();
            console.log('ğŸ“¦ API ì‘ë‹µ:', result);
            console.log('ğŸ“¦ API ì‘ë‹µ (JSON):', JSON.stringify(result, null, 2));
            
            if (result.ok && result.ticket) {
              const ticket = result.ticket;
              console.log('ğŸ“‹ í‹°ì¼“ ë°ì´í„°:', ticket);
              console.log('ğŸ“‹ í‹°ì¼“ ë°ì´í„° (ìƒì„¸):', {
                author_name: ticket.author_name,
                birth_datetime: ticket.birth_datetime,
                birth_hour: ticket.birth_hour,
                birth_minute: ticket.birth_minute,
                calendar_type: ticket.calendar_type,
                yundal: ticket.yundal,
                author_gender: ticket.author_gender,
                hour_ji: ticket.hour_ji
              });
            
            // 1. ì„±ëª… ì…ë ¥
            console.log('1ï¸âƒ£ ì„±ëª… ì„¤ì •:', ticket.author_name);
            const nameInput = document.getElementById('name');
            if (nameInput) {
              nameInput.value = ticket.author_name || '';
              console.log('   âœ… ì„±ëª… ì…ë ¥ ì™„ë£Œ:', nameInput.value);
            } else {
              console.error('   âŒ name ì…ë ¥ í•„ë“œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
            }
            
            // 2. ìƒë…„ì›”ì¼ ì„¤ì •
            console.log('2ï¸âƒ£ ìƒë…„ì›”ì¼ ì„¤ì •:', ticket.birth_datetime, '(íƒ€ì…:', typeof ticket.birth_datetime, ')');
            if (ticket.birth_datetime) {
              // birth_datetimeì€ ISO ë¬¸ìì—´ ë˜ëŠ” Date ê°ì²´
              const birthDate = new Date(ticket.birth_datetime);
              
              // ìœ íš¨í•œ ë‚ ì§œì¸ì§€ í™•ì¸
              if (isNaN(birthDate.getTime())) {
                console.error('   âŒ birth_datetime íŒŒì‹± ì‹¤íŒ¨:', ticket.birth_datetime);
              } else {
                const yearInput = document.getElementById('year');
                const monthInput = document.getElementById('month');
                const dayInput = document.getElementById('day');
                
                if (yearInput) {
                  yearInput.value = birthDate.getFullYear();
                  console.log('   âœ… ë…„ë„:', yearInput.value);
                } else {
                  console.error('   âŒ year ì…ë ¥ í•„ë“œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                }
                
                if (monthInput) {
                  monthInput.value = birthDate.getMonth() + 1;
                  console.log('   âœ… ì›”:', monthInput.value);
                } else {
                  console.error('   âŒ month ì…ë ¥ í•„ë“œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                }
                
                if (dayInput) {
                  dayInput.value = birthDate.getDate();
                  console.log('   âœ… ì¼:', dayInput.value);
                } else {
                  console.error('   âŒ day ì…ë ¥ í•„ë“œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                }
              }
            } else {
              console.warn('   âš ï¸ birth_datetime ì—†ìŒ');
            }
            
            // 3. ì‹œê°„ ì„¤ì •
            console.log('3ï¸âƒ£ ì‹œê°„ ì„¤ì •:', ticket.birth_hour);
            if (ticket.birth_hour !== null && ticket.birth_hour !== undefined) {
              const hourInput = document.getElementById('hour');
              if (hourInput) {
                hourInput.value = ticket.birth_hour;
                console.log('   âœ… ì‹œê°„:', hourInput.value);
              } else {
                console.error('   âŒ hour ì…ë ¥ í•„ë“œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
              }
            } else {
              console.warn('   âš ï¸ birth_hour ì—†ìŒ');
            }
            
            // 4. ë¶„ ì„¤ì •
            console.log('4ï¸âƒ£ ë¶„ ì„¤ì •:', ticket.birth_minute);
            if (ticket.birth_minute !== null && ticket.birth_minute !== undefined) {
              const minuteInput = document.getElementById('minute');
              if (minuteInput) {
                minuteInput.value = ticket.birth_minute;
                console.log('   âœ… ë¶„:', minuteInput.value);
              } else {
                console.error('   âŒ minute ì…ë ¥ í•„ë“œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
              }
            } else {
              console.warn('   âš ï¸ birth_minute ì—†ìŒ');
            }
            
            // 5. ì—­ë²• ì„¤ì • (calendar_type)
            console.log('5ï¸âƒ£ ì—­ë²• ì„¤ì •:', ticket.calendar_type);
            if (ticket.calendar_type) {
              // DBì—ì„œ í•œê¸€ë¡œ ì €ì¥ëœ ê²½ìš°ì™€ ì˜ë¬¸ ëª¨ë‘ ì²˜ë¦¬
              const isLunar = ticket.calendar_type === 'ìŒë ¥' || ticket.calendar_type === 'LUNAR' || ticket.calendar_type === 'lunar';
              const calendarValue = isLunar ? 'lunar' : 'solar';
              
              const calendarRadio = document.querySelector(`input[name="calendar"][value="${calendarValue}"]`);
              if (calendarRadio) {
                calendarRadio.checked = true;
                console.log('   âœ… ì—­ë²•:', calendarValue);
                
                // ìŒë ¥ì¼ ê²½ìš° ìœ¤ë‹¬ ì„¹ì…˜ í‘œì‹œ
                if (isLunar) {
                  const yundalSection = document.getElementById('yundal-section');
                  if (yundalSection) {
                    yundalSection.style.display = 'block';
                    console.log('   âœ… ìœ¤ë‹¬ ì„¹ì…˜ í‘œì‹œ');
                  }
                  
                  // 6. ìœ¤ë‹¬ ì²´í¬
                  console.log('6ï¸âƒ£ ìœ¤ë‹¬ ì„¤ì •:', ticket.yundal, '(íƒ€ì…:', typeof ticket.yundal, ')');
                  // yundalì€ DBì—ì„œ BOOLEANì´ë¯€ë¡œ true/false, ë˜ëŠ” 'Y'/'N' ë¬¸ìì—´ ëª¨ë‘ ì²˜ë¦¬
                  if (ticket.yundal === true || ticket.yundal === 'Y' || ticket.yundal === 1) {
                    const yundalCheck = document.getElementById('yundal');
                    if (yundalCheck) {
                      yundalCheck.checked = true;
                      console.log('   âœ… ìœ¤ë‹¬ ì²´í¬ë¨');
                    } else {
                      console.error('   âŒ yundal ì²´í¬ë°•ìŠ¤ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                    }
                  }
                }
              } else {
                console.error('   âŒ calendar ë¼ë””ì˜¤ ë²„íŠ¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
              }
            } else {
              console.warn('   âš ï¸ calendar_type ì—†ìŒ');
            }
            
            // 7. ì„±ë³„ ì„¤ì •
            console.log('7ï¸âƒ£ ì„±ë³„ ì„¤ì •:', ticket.author_gender);
            if (ticket.author_gender) {
              const genderValue = ticket.author_gender === 'M' ? 'male' : 'female';
              const genderRadio = document.querySelector(`input[name="gender"][value="${genderValue}"]`);
              if (genderRadio) {
                genderRadio.checked = true;
                console.log('   âœ… ì„±ë³„:', genderValue);
              } else {
                console.error('   âŒ gender ë¼ë””ì˜¤ ë²„íŠ¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
              }
            } else {
              console.warn('   âš ï¸ author_gender ì—†ìŒ');
            }
            
            // 8. ì‹œì£¼ ì„¤ì • (hour_ji ê°’ ìœ ë¬´ì— ë”°ë¼ ì…ë ¥ ëª¨ë“œ ìë™ ì „í™˜)
            console.log('8ï¸âƒ£ ì‹œì£¼ ì„¤ì •:', ticket.hour_ji);
            if (ticket.hour_ji && ticket.hour_ji.trim() !== '') {
              // âœ… hour_ji ê°’ì´ ìˆëŠ” ê²½ìš° â†’ ê°„ì§€ì…ë ¥ ëª¨ë“œ
              console.log('   ğŸ“ hour_ji ê°’ ìˆìŒ â†’ ê°„ì§€ì…ë ¥ ëª¨ë“œë¡œ ì „í™˜');
              
              // 8-1. ì‹œê° ì…ë ¥ ë°©ì‹ì„ "ê°„ì§€ ì…ë ¥"ìœ¼ë¡œ ë³€ê²½
              const ganjiRadio = document.querySelector('input[name="timeInputType"][value="ganji"]');
              if (ganjiRadio) {
                ganjiRadio.checked = true;
                console.log('   âœ… ì‹œê° ì…ë ¥ ë°©ì‹: ê°„ì§€ ì…ë ¥ ì²´í¬');
                
                // UI ì—…ë°ì´íŠ¸ (ê°„ì§€ ì…ë ¥ í•„ë“œ í‘œì‹œ, ì‹œê° ì…ë ¥ í•„ë“œ ìˆ¨ê¹€)
                const timeInputSection = document.getElementById('time-input-section');
                const ganjiInputSection = document.getElementById('ganji-input-section');
                if (timeInputSection) {
                  timeInputSection.style.display = 'none';
                  console.log('   âœ… ì‹œê° ì…ë ¥ í•„ë“œ ìˆ¨ê¹€');
                }
                if (ganjiInputSection) {
                  ganjiInputSection.style.display = 'block';
                  console.log('   âœ… ê°„ì§€ ì…ë ¥ í•„ë“œ í‘œì‹œ');
                }
              } else {
                console.error('   âŒ ê°„ì§€ ì…ë ¥ ë¼ë””ì˜¤ ë²„íŠ¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
              }
              
              // 8-2. ì‹œì£¼ ì„ íƒ
              const hourJiSelect = document.getElementById('hour-ji-select');
              if (hourJiSelect) {
                hourJiSelect.value = ticket.hour_ji;
                console.log('   âœ… ì‹œì£¼ ì„ íƒ:', hourJiSelect.value);
              } else {
                console.error('   âŒ hour-ji-selectë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
              }
            } else {
              // âœ… hour_ji ê°’ì´ ì—†ëŠ” ê²½ìš° â†’ ì‹œê°ì…ë ¥ ëª¨ë“œ (ê¸°ë³¸ê°’)
              console.log('   ğŸ“ hour_ji ê°’ ì—†ìŒ â†’ ì‹œê°ì…ë ¥ ëª¨ë“œ ìœ ì§€');
              
              // 8-1. ì‹œê° ì…ë ¥ ë°©ì‹ì„ "ì‹œê° ì…ë ¥"ìœ¼ë¡œ ëª…ì‹œì  ì„¤ì •
              const timeRadio = document.querySelector('input[name="timeInputType"][value="time"]');
              if (timeRadio) {
                timeRadio.checked = true;
                console.log('   âœ… ì‹œê° ì…ë ¥ ë°©ì‹: ì‹œê° ì…ë ¥ ì²´í¬');
                
                // UI ì—…ë°ì´íŠ¸ (ì‹œê° ì…ë ¥ í•„ë“œ í‘œì‹œ, ê°„ì§€ ì…ë ¥ í•„ë“œ ìˆ¨ê¹€)
                const timeInputSection = document.getElementById('time-input-section');
                const ganjiInputSection = document.getElementById('ganji-input-section');
                if (timeInputSection) {
                  timeInputSection.style.display = 'block';
                  console.log('   âœ… ì‹œê° ì…ë ¥ í•„ë“œ í‘œì‹œ');
                }
                if (ganjiInputSection) {
                  ganjiInputSection.style.display = 'none';
                  console.log('   âœ… ê°„ì§€ ì…ë ¥ í•„ë“œ ìˆ¨ê¹€');
                }
              } else {
                console.error('   âŒ ì‹œê° ì…ë ¥ ë¼ë””ì˜¤ ë²„íŠ¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
              }
            }
            
            console.log('âœ… í‹°ì¼“ ë°ì´í„° ë¡œë“œ ì™„ë£Œ');
            console.log('ğŸ“Š ë¡œë“œëœ ë°ì´í„° ìš”ì•½:', {
              ì„±ëª…: ticket.author_name,
              ìƒë…„ì›”ì¼: ticket.birth_datetime,
              ì‹œê°„: ticket.birth_hour,
              ë¶„: ticket.birth_minute,
              ì—­ë²•: ticket.calendar_type,
              ìœ¤ë‹¬: ticket.yundal,
              ì„±ë³„: ticket.author_gender,
              ì‹œì£¼: ticket.hour_ji
            });
            
            // 9. ë°ì´í„° ë¡œë“œ í›„ ìë™ìœ¼ë¡œ ì‚¬ì£¼ ë¶„ì„ ì‹¤í–‰
            console.log('9ï¸âƒ£ ìë™ ì‚¬ì£¼ ë¶„ì„ ì¤€ë¹„');
            setTimeout(() => {
              console.log('ğŸ”® ìë™ìœ¼ë¡œ ì‚¬ì£¼ ë¶„ì„ ì‹¤í–‰');
              const analyzeBtn = document.getElementById('analyze-btn');
              if (analyzeBtn) {
                analyzeBtn.click();
                console.log('âœ… ì‚¬ì£¼ë³´ê¸° ë²„íŠ¼ í´ë¦­ ì™„ë£Œ');
              } else {
                console.error('âŒ ì‚¬ì£¼ë³´ê¸° ë²„íŠ¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
              }
            }, 800); // 0.8ì´ˆ ì§€ì—° í›„ ì‹¤í–‰ (DOM ì—…ë°ì´íŠ¸ ëŒ€ê¸°)
          } else {
            console.error('âŒ í‹°ì¼“ ë°ì´í„°ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤:', result);
            alert('í‹°ì¼“ ë°ì´í„°ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\n\nì‘ë‹µ: ' + JSON.stringify(result, null, 2));
          }
        } catch (error) {
          console.error('âŒ í‹°ì¼“ ë°ì´í„° ë¡œë“œ ì˜¤ë¥˜:', error);
          console.error('   ìŠ¤íƒ:', error.stack);
          alert('ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.\n\nì˜¤ë¥˜: ' + error.message);
        }
      }
      // ğŸ”’ ì¦‰ì‹œ ë‚œë…í™” ë°©ì§€ ë“±ë¡
      window['loadTicketData'] = loadTicketData;
      
      // ë‚œë…í™” ë°©ì§€: ì „ì—­ ê°ì²´ì— ëª…ì‹œì ìœ¼ë¡œ í• ë‹¹ (DOMContentLoadedì—ì„œ ì²˜ë¦¬)
      
      // íšŒì› ë¡œê·¸ì¸ ì²´í¬ í•¨ìˆ˜
      function checkMemberLogin() {
        let memberId = null;
        
        console.log('ğŸ” íšŒì› ë¡œê·¸ì¸ ì²´í¬ ì‹œì‘ ============');
        console.log('   ğŸŒ í˜„ì¬ í™˜ê²½:', window.location.hostname);
        console.log('   ğŸ“ URL:', window.location.href);
        
        // 1. window.MEMBER_SESSION í™•ì¸ (ìµœìš°ì„ )
        console.log('   1ï¸âƒ£ window.MEMBER_SESSION í™•ì¸:', window.MEMBER_SESSION);
        if (window.MEMBER_SESSION) {
          console.log('      - typeof:', typeof window.MEMBER_SESSION);
          console.log('      - keys:', Object.keys(window.MEMBER_SESSION));
          console.log('      - sMem_id:', window.MEMBER_SESSION.sMem_id);
          console.log('      - isLoggedIn:', window.MEMBER_SESSION.isLoggedIn);
          
          if (window.MEMBER_SESSION.sMem_id) {
            memberId = window.MEMBER_SESSION.sMem_id;
            console.log('   âœ… MEMBER_SESSIONì—ì„œ íšŒì› ID í™•ì¸:', memberId);
            console.log('ğŸ”„ checkMemberLogin í•¨ìˆ˜ ì¢…ë£Œ - ë°˜í™˜ê°’:', memberId);
            console.log('=====================================');
            return memberId;
          } else {
            console.log('   âš ï¸ MEMBER_SESSIONì€ ìˆì§€ë§Œ sMem_idê°€ ì—†ìŒ');
          }
        } else {
          console.log('   âš ï¸ window.MEMBER_SESSIONì´ ì—†ìŒ (undefined ë˜ëŠ” null)');
        }
        
        // 2. sessionStorageì—ì„œ í™•ì¸
        console.log('   2ï¸âƒ£ sessionStorage í™•ì¸...');
        try {
          const storedSession = sessionStorage.getItem('memberSession');
          console.log('      - sessionStorage.memberSession:', storedSession);
          if (storedSession) {
            const sessionData = JSON.parse(storedSession);
            console.log('      - íŒŒì‹±ëœ ë°ì´í„°:', sessionData);
            if (sessionData && sessionData.sMem_id) {
              memberId = sessionData.sMem_id;
              console.log('   âœ… sessionStorageì—ì„œ íšŒì› ID í™•ì¸:', memberId);
              console.log('ğŸ”„ checkMemberLogin í•¨ìˆ˜ ì¢…ë£Œ - ë°˜í™˜ê°’:', memberId);
              console.log('=====================================');
              return memberId;
            }
          }
        } catch (e) {
          console.error('   âŒ sessionStorage íŒŒì‹± ì˜¤ë¥˜:', e);
        }
        
        // 3. ì „ì—­ë³€ìˆ˜ì—ì„œ íšŒì› ID í™•ì¸
        console.log('   3ï¸âƒ£ ì „ì—­ë³€ìˆ˜ í™•ì¸...');
        console.log('      - window.sMem_id:', typeof window.sMem_id, window.sMem_id);
        console.log('      - sMem_id:', typeof sMem_id !== 'undefined' ? sMem_id : 'undefined');
        
        if (typeof window.sMem_id !== 'undefined' && window.sMem_id) {
          memberId = window.sMem_id;
          console.log('   âœ… window.sMem_idì—ì„œ íšŒì› ID í™•ì¸:', memberId);
        } else if (typeof sMem_id !== 'undefined' && sMem_id) {
          memberId = sMem_id;
          console.log('   âœ… ì „ì—­ sMem_idì—ì„œ íšŒì› ID í™•ì¸:', memberId);
        } else {
          console.log('   âš ï¸ ì „ì—­ë³€ìˆ˜ì—ì„œë„ íšŒì› IDë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ');
        }
        
        console.log('ğŸ”„ checkMemberLogin í•¨ìˆ˜ ì¢…ë£Œ - ìµœì¢… ë°˜í™˜ê°’:', memberId);
        console.log('=====================================');
        return memberId;
      }
      // ğŸ”’ ì¦‰ì‹œ ë‚œë…í™” ë°©ì§€ ë“±ë¡ (ë‹¤ì¤‘ ë³´í˜¸)
      window['checkMemberLogin'] = checkMemberLogin;
      (function(fn) { window['checkMemberLogin'] = fn; })(checkMemberLogin);
      
      // ë‚œë…í™” ë°©ì§€: ì „ì—­ ê°ì²´ì— ëª…ì‹œì ìœ¼ë¡œ í• ë‹¹ (DOMContentLoadedì—ì„œ ì²˜ë¦¬)
      
      // ì…ë ¥ ë°ì´í„°ë§Œ ì €ì¥ (ì‚¬ì£¼ ë¶„ì„ ê²°ê³¼ëŠ” ì œì™¸)
      function saveFormData() {
        const formData = {
          // ì…ë ¥ ë°ì´í„°ë§Œ ì €ì¥
          name: document.getElementById('name')?.value || '',
          year: document.getElementById('year')?.value || '',
          month: document.getElementById('month')?.value || '',
          day: document.getElementById('day')?.value || '',
          hour: document.getElementById('hour')?.value || '',
          minute: document.getElementById('minute')?.value || '',
          calendar: document.querySelector('input[name="calendar"]:checked')?.value || 'solar',
          yundal: document.getElementById('yundal')?.checked || false,
          gender: document.querySelector('input[name="gender"]:checked')?.value || 'male',
          hourJi: document.getElementById('hour-ji-select')?.value || ''
        };
        
        sessionStorage.setItem('sajuFormData', JSON.stringify(formData));
        console.log('ğŸ’¾ ì…ë ¥ ë°ì´í„° ì €ì¥ ì™„ë£Œ (ì‚¬ì£¼ ê²°ê³¼ëŠ” ì œì™¸):', formData);
      }
      // ğŸ”’ ì¦‰ì‹œ ë‚œë…í™” ë°©ì§€ ë“±ë¡
      window['saveFormData'] = saveFormData;
      
      // ì…ë ¥ ë°ì´í„°ë§Œ ë³µì› (ì‚¬ì£¼ ë¶„ì„ ê²°ê³¼ëŠ” ì œì™¸)
      function restoreFormData() {
        const savedData = sessionStorage.getItem('sajuFormData');
        if (!savedData) {
          console.log('âš ï¸ ì €ì¥ëœ ë°ì´í„° ì—†ìŒ');
          return false;
        }
        
        try {
          const formData = JSON.parse(savedData);
          console.log('ğŸ“¥ ì…ë ¥ ë°ì´í„° ë³µì› ì‹œì‘:', formData);
          
          // ì…ë ¥ ë°ì´í„°ë§Œ ë³µì›
          if (formData.name) document.getElementById('name').value = formData.name;
          if (formData.year) document.getElementById('year').value = formData.year;
          if (formData.month) document.getElementById('month').value = formData.month;
          if (formData.day) document.getElementById('day').value = formData.day;
          if (formData.hour) document.getElementById('hour').value = formData.hour;
          if (formData.minute) document.getElementById('minute').value = formData.minute;
          
          // ë¼ë””ì˜¤ ë²„íŠ¼ ë³µì›
          const calendarRadio = document.querySelector(`input[name="calendar"][value="${formData.calendar}"]`);
          if (calendarRadio) calendarRadio.checked = true;
          
          const genderRadio = document.querySelector(`input[name="gender"][value="${formData.gender}"]`);
          if (genderRadio) genderRadio.checked = true;
          
          // ì²´í¬ë°•ìŠ¤ ë³µì›
          if (formData.yundal) document.getElementById('yundal').checked = true;
          
          // ì‹œì£¼ ë³µì›
          if (formData.hourJi) document.getElementById('hour-ji-select').value = formData.hourJi;
          
          console.log('âœ… ì…ë ¥ ë°ì´í„° ë³µì› ì™„ë£Œ (ì‚¬ì£¼ ê²°ê³¼ëŠ” ì œì™¸ - ì‚¬ì£¼ë³´ê¸° ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”)');
          
          return true;
        } catch (error) {
          console.error('âŒ ë°ì´í„° ë³µì› ì˜¤ë¥˜:', error);
          return false;
        }
      }
      // ğŸ”’ ì¦‰ì‹œ ë‚œë…í™” ë°©ì§€ ë“±ë¡
      window['restoreFormData'] = restoreFormData;
      
      // ì‚¬ì£¼ ë¶„ì„ ê²°ê³¼ ì²´í¬
      function checkSajuResult() {
        // resultWrapì´ í‘œì‹œë˜ì–´ ìˆëŠ”ì§€ í™•ì¸
        const resultWrap = document.getElementById('resultWrap');
        if (!resultWrap || resultWrap.classList.contains('hidden')) {
          console.log('âŒ resultWrapì´ ìˆ¨ê²¨ì ¸ ìˆìŒ');
          return false;
        }
        
        // ì¼ì£¼(day-gan)ê°€ ì±„ì›Œì ¸ ìˆëŠ”ì§€ í™•ì¸ (í•„ìˆ˜ ìš”ì†Œ)
        const dayGan = document.getElementById('day-gan');
        if (!dayGan || !dayGan.textContent.trim()) {
          console.log('âŒ ì¼ì£¼(day-gan)ê°€ ë¹„ì–´ìˆìŒ');
          return false;
        }
        
        // ì¼ì§€(day-ji)ê°€ ì±„ì›Œì ¸ ìˆëŠ”ì§€ í™•ì¸
        const dayJi = document.getElementById('day-ji');
        if (!dayJi || !dayJi.textContent.trim()) {
          console.log('âŒ ì¼ì§€(day-ji)ê°€ ë¹„ì–´ìˆìŒ');
          return false;
        }
        
        console.log('âœ… ì‚¬ì£¼ ë¶„ì„ ê²°ê³¼ í™•ì¸: day-gan =', dayGan.textContent, ', day-ji =', dayJi.textContent);
        return true;
      }
      // ğŸ”’ ì¦‰ì‹œ ë‚œë…í™” ë°©ì§€ ë“±ë¡ (ë‹¤ì¤‘ ë³´í˜¸)
      window['checkSajuResult'] = checkSajuResult;
      (function(fn) { window['checkSajuResult'] = fn; })(checkSajuResult);
      // ğŸ›¡ï¸ ìµœê°• ë³´í˜¸: í•¨ìˆ˜ ì°¸ì¡°ë¥¼ ì¦‰ì‹œ ì €ì¥
      window['_checkSajuResult'] = (function() { return checkSajuResult; })();
      
      // ë‚œë…í™” ë°©ì§€: ì „ì—­ ê°ì²´ì— ëª…ì‹œì ìœ¼ë¡œ í• ë‹¹ (DOMContentLoadedì—ì„œ ì²˜ë¦¬)
      
      // ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ì´ë™
      function redirectToLogin(message) {
        // confirm ê²°ê³¼ì™€ ìƒê´€ì—†ì´ í•­ìƒ ë°ì´í„° ì €ì¥ (ì·¨ì†Œí•´ë„ ë‚˜ì¤‘ì— ë¡œê·¸ì¸í•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ)
        saveFormData();
        console.log('ğŸ’¾ í˜„ì¬ í™”ë©´ ë°ì´í„° ì €ì¥ ì™„ë£Œ');
        
        if (confirm(message + '\n\në¡œê·¸ì¸ í˜ì´ì§€ë¡œ ì´ë™í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
          // í˜„ì¬ í˜ì´ì§€ URLì„ ì €ì¥
          sessionStorage.setItem('returnUrl', window.location.href);
          sessionStorage.setItem('returnAfterLogin', 'true');
          
          console.log('ğŸ”„ ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ì´ë™');
          window.location.href = '/secret/member_login.html';
        } else {
          console.log('âŒ ì‚¬ìš©ìê°€ ë¡œê·¸ì¸ ì´ë™ì„ ì·¨ì†Œí•¨ (ë°ì´í„°ëŠ” ì €ì¥ë¨)');
        }
      }
      // ğŸ”’ ì¦‰ì‹œ ë‚œë…í™” ë°©ì§€ ë“±ë¡
      window['redirectToLogin'] = redirectToLogin;
      
      // ë‚œë…í™” ë°©ì§€: ì „ì—­ ê°ì²´ì— ëª…ì‹œì ìœ¼ë¡œ í• ë‹¹ (DOMContentLoadedì—ì„œ ì²˜ë¦¬)
      
      // ğŸ”’ ë‚œë…í™” ë°©ì§€: í•¨ìˆ˜ ë“±ë¡ì€ DOMContentLoadedì—ì„œ í•¨ìˆ˜ ì •ì˜ ì´í›„ì— ì²˜ë¦¬
      
      // ğŸš¨ ê¸´ê¸‰ ëŒ€ì•ˆ: ê°•ì œ í•¨ìˆ˜ ë“±ë¡ (DOMContentLoadedê°€ ì‹¤í–‰ë˜ì§€ ì•ŠëŠ” ê²½ìš° ëŒ€ë¹„)
      setTimeout(function() {
        console.log('ğŸš¨ ê°•ì œ í•¨ìˆ˜ ë“±ë¡ ì‹œì‘ (3ì´ˆ í›„)...');
        
        // í•¨ìˆ˜ ì •ì˜ ìƒíƒœ í™•ì¸
        console.log('   - checkSajuResult ì •ì˜ë¨:', typeof checkSajuResult);
        console.log('   - checkMemberLogin ì •ì˜ë¨:', typeof checkMemberLogin);
        
        // ì •ì˜ëœ í•¨ìˆ˜ë“¤ë§Œ ë“±ë¡
        if (typeof checkSajuResult !== 'undefined') {
          window['checkSajuResult'] = checkSajuResult;
          console.log('   âœ… checkSajuResult ê°•ì œ ë“±ë¡ ì™„ë£Œ');
        }
        if (typeof checkMemberLogin !== 'undefined') {
          window['checkMemberLogin'] = checkMemberLogin;
          console.log('   âœ… checkMemberLogin ê°•ì œ ë“±ë¡ ì™„ë£Œ');
        }
        if (typeof redirectToLogin !== 'undefined') {
          window['redirectToLogin'] = redirectToLogin;
          console.log('   âœ… redirectToLogin ê°•ì œ ë“±ë¡ ì™„ë£Œ');
        }
        if (typeof saveFormData !== 'undefined') {
          window['saveFormData'] = saveFormData;
          console.log('   âœ… saveFormData ê°•ì œ ë“±ë¡ ì™„ë£Œ');
        }
        if (typeof restoreFormData !== 'undefined') {
          window['restoreFormData'] = restoreFormData;
          console.log('   âœ… restoreFormData ê°•ì œ ë“±ë¡ ì™„ë£Œ');
        }
        if (typeof loadTicketData !== 'undefined') {
          window['loadTicketData'] = loadTicketData;
          console.log('   âœ… loadTicketData ê°•ì œ ë“±ë¡ ì™„ë£Œ');
        }
        if (typeof generateSajuShareText !== 'undefined') {
          window['generateSajuShareText'] = generateSajuShareText;
          console.log('   âœ… generateSajuShareText ê°•ì œ ë“±ë¡ ì™„ë£Œ');
        }
        if (typeof showShareOptions !== 'undefined') {
          window['showShareOptions'] = showShareOptions;
          console.log('   âœ… showShareOptions ê°•ì œ ë“±ë¡ ì™„ë£Œ');
        }
        if (typeof copyToClipboard !== 'undefined') {
          window['copyToClipboard'] = copyToClipboard;
          console.log('   âœ… copyToClipboard ê°•ì œ ë“±ë¡ ì™„ë£Œ');
        }
        if (typeof fallbackCopyToClipboard !== 'undefined') {
          window['fallbackCopyToClipboard'] = fallbackCopyToClipboard;
          console.log('   âœ… fallbackCopyToClipboard ê°•ì œ ë“±ë¡ ì™„ë£Œ');
        }
        if (typeof shareToKakao !== 'undefined') {
          window['shareToKakao'] = shareToKakao;
          console.log('   âœ… shareToKakao ê°•ì œ ë“±ë¡ ì™„ë£Œ');
        }
        if (typeof shareViaWeb !== 'undefined') {
          window['shareViaWeb'] = shareViaWeb;
          console.log('   âœ… shareViaWeb ê°•ì œ ë“±ë¡ ì™„ë£Œ');
        }
        
        console.log('ğŸš¨ ê°•ì œ í•¨ìˆ˜ ë“±ë¡ ì™„ë£Œ!');
        
        // ë“±ë¡ ìƒíƒœ ì¬í™•ì¸
        console.log('ğŸ” ê°•ì œ ë“±ë¡ í›„ ìƒíƒœ í™•ì¸:');
        console.log('   - checkSajuResult:', typeof window['checkSajuResult']);
        console.log('   - checkMemberLogin:', typeof window['checkMemberLogin']);
        console.log('   - generateSajuShareText:', typeof window['generateSajuShareText']);
        console.log('   - showShareOptions:', typeof window['showShareOptions']);
      }, 3000);

      // ğŸ” DOMContentLoaded ìƒíƒœ ì§„ë‹¨ ë° ëª¨ë‹ˆí„°ë§
      function diagnoseDOMState() {
        console.log('=== ğŸ” DOM ìƒíƒœ ì§„ë‹¨ ===');
        console.log('1. ë¬¸ì„œ ìƒíƒœ:', document.readyState);
        console.log('2. í˜„ì¬ ì‹œê°„:', new Date().toLocaleTimeString());
        console.log('3. ë²„íŠ¼ ì¡´ì¬ ì—¬ë¶€:');
        console.log('   - DBì €ì¥:', !!document.getElementById('db-save-btn'));
        console.log('   - ë³´ë‚´ê¸°:', !!document.getElementById('send-btn'));
        console.log('   - DBë³´ê¸°:', !!document.getElementById('db-view-btn'));
        console.log('4. í•¨ìˆ˜ ë“±ë¡ ìƒíƒœ:');
        console.log('   - checkSajuResult:', typeof window['checkSajuResult']);
        console.log('   - checkMemberLogin:', typeof window['checkMemberLogin']);
        console.log('   - generateSajuShareText:', typeof window['generateSajuShareText']);
        
        // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ í™•ì¸ (ê°€ëŠ¥í•œ ê²½ìš°)
        const dbBtn = document.getElementById('db-save-btn');
        if (dbBtn) {
          // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¡´ì¬ ì—¬ë¶€ë¥¼ ê°„ì ‘ì ìœ¼ë¡œ í™•ì¸
          const hasClickListener = dbBtn.onclick !== null || 
                                  (dbBtn.getAttribute && dbBtn.getAttribute('onclick')) ||
                                  (window.getEventListeners && Object.keys(window.getEventListeners(dbBtn)).length > 0);
          console.log('5. DBì €ì¥ ë²„íŠ¼ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ:', hasClickListener ? 'ë“±ë¡ë¨' : 'ì—†ìŒ');
        }
        console.log('========================');
      }
      
      // ì¦‰ì‹œ ì§„ë‹¨ ì‹¤í–‰
      diagnoseDOMState();
      
      // ë¬¸ì„œ ìƒíƒœë³„ ì§„ë‹¨
      if (document.readyState === 'loading') {
        console.log('ğŸ“‹ ë¬¸ì„œ ë¡œë”© ì¤‘ - DOMContentLoaded ëŒ€ê¸°');
      } else if (document.readyState === 'interactive') {
        console.log('ğŸ“‹ ë¬¸ì„œ ì¸í„°ë™í‹°ë¸Œ ìƒíƒœ - DOM ì¤€ë¹„ë¨');
      } else if (document.readyState === 'complete') {
        console.log('ğŸ“‹ ë¬¸ì„œ ì™„ì „ ë¡œë“œë¨ - ëª¨ë“  ë¦¬ì†ŒìŠ¤ ì¤€ë¹„');
      }

      // ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸
      document.addEventListener('DOMContentLoaded', function() {
        console.log('ğŸš€ DOMContentLoaded ì´ë²¤íŠ¸ ì‹¤í–‰ - ë²„íŠ¼ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë“±ë¡ ì‹œì‘');
        
        // DOMContentLoaded ì‹¤í–‰ í›„ ì¬ì§„ë‹¨
        setTimeout(() => {
          console.log('ğŸ”„ DOMContentLoaded í›„ ìƒíƒœ ì¬ì§„ë‹¨:');
          diagnoseDOMState();
        }, 100);
        
        // DBë³´ê¸° ë²„íŠ¼
        const dbViewBtn = document.getElementById('db-view-btn');
        if (dbViewBtn) {
          console.log('ğŸ”§ DBë³´ê¸° ë²„íŠ¼ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë“±ë¡ ì‹œì‘...');
          
          dbViewBtn.addEventListener('click', function(event) {
            console.log('=====================================');
            console.log('ğŸ” DBë³´ê¸° ë²„íŠ¼ í´ë¦­ë¨');
            console.log('   - ì´ë²¤íŠ¸ íƒ€ì…:', event.type);
            console.log('   - íƒ€ê²Ÿ:', event.target);
            console.log('=====================================');
            
            // íšŒì› ë¡œê·¸ì¸ ì²´í¬
            console.log('1ï¸âƒ£ íšŒì› ë¡œê·¸ì¸ ì²´í¬ ì‹œì‘...');
            const memberId = window['checkMemberLogin']();
            console.log('   - checkMemberLogin() ë°˜í™˜ê°’:', memberId);
            
            if (!memberId) {
              console.log('âŒ ë¡œê·¸ì¸ë˜ì§€ ì•ŠìŒ - redirectToLogin í˜¸ì¶œ');
              window['redirectToLogin']('íšŒì› ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.\në¡œê·¸ì¸ í˜ì´ì§€ë¡œ ì´ë™í•©ë‹ˆë‹¤.');
              return;
            }
            console.log('âœ… ë¡œê·¸ì¸ í™•ì¸ ì™„ë£Œ - memberId:', memberId);
            
            // í˜„ì¬ í™”ë©´ ë°ì´í„° ì €ì¥ (ì´ì „ ë²„íŠ¼ìœ¼ë¡œ ëŒì•„ì˜¬ ë•Œ ë³µì›ìš©)
            window['saveFormData']();
            console.log('ğŸ’¾ í˜„ì¬ í™”ë©´ ë°ì´í„° ì €ì¥ ì™„ë£Œ (DBë³´ê¸° ì´ë™ ì „)');
            
            // ğŸ”’ ë³´ì•ˆ ê·œì¹™: ì‚¬ì£¼ ë°ì´í„°(B0001) ì¡°íšŒ ì‹œ ë³¸ì¸ ê²ƒë§Œ ì¡°íšŒ
            // âš ï¸ í•„ìˆ˜ ì¡°ê±´ (ì ˆëŒ€ ë³€ê²½ ê¸ˆì§€):
            //    1. snsgu=B0001 (ì‚¬ì£¼ ë°ì´í„°)
            //    2. smember_id=ë¡œê·¸ì¸í•œ íšŒì› ID (ë³¸ì¸ ë°ì´í„°ë§Œ)
            // ğŸ‘‰ íƒ€ì¸ì˜ ì‚¬ì£¼ ë°ì´í„°ë¥¼ ë³¼ ìˆ˜ ì—†ë„ë¡ ë³´í˜¸
            console.log('ğŸ”’ í•„í„° ì¡°ê±´:', {snsgu: 'B0001', smember_id: memberId});
            window.location.href = `/secret/tickboard?snsgu=B0001&smember_id=${memberId}`;
          });
          console.log('âœ… DBë³´ê¸° ë²„íŠ¼ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë“±ë¡ ì™„ë£Œ');
        } else {
          console.error('âŒ DBë³´ê¸° ë²„íŠ¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
        }
        
        // DBì €ì¥ ë²„íŠ¼ (ì‹ ê·œ ì €ì¥ + ê¸°ì¡´ ë°ì´í„° ìˆ˜ì •)
        const dbSaveBtn = document.getElementById('db-save-btn');
        if (dbSaveBtn) {
          console.log('ğŸ”§ DBì €ì¥ ë²„íŠ¼ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë“±ë¡ ì‹œì‘...');
          
          dbSaveBtn.addEventListener('click', async function(event) {
            console.log('=====================================');
            console.log('ğŸ’¾ DBì €ì¥ ë²„íŠ¼ í´ë¦­ë¨');
            console.log('   - ì´ë²¤íŠ¸ íƒ€ì…:', event.type);
            console.log('   - íƒ€ê²Ÿ:', event.target);
            console.log('=====================================');
            
            // 1. ì‚¬ì£¼ ë¶„ì„ ê²°ê³¼ ì²´í¬
            console.log('1ï¸âƒ£ ì‚¬ì£¼ ë¶„ì„ ê²°ê³¼ ì²´í¬...');
            const sajuResultExists = window['checkSajuResult']();
            console.log('   - checkSajuResult() ë°˜í™˜ê°’:', sajuResultExists);
            
            if (!sajuResultExists) {
              console.log('âŒ ì‚¬ì£¼ ë¶„ì„ ê²°ê³¼ ì—†ìŒ - alert í‘œì‹œ');
              alert('ë¨¼ì € "ì‚¬ì£¼ë³´ê¸°" ë²„íŠ¼ì„ í´ë¦­í•˜ì—¬ ì‚¬ì£¼ë¥¼ ë¶„ì„í•´ì£¼ì„¸ìš”.');
              return;
            }
            console.log('âœ… ì‚¬ì£¼ ë¶„ì„ ê²°ê³¼ í™•ì¸ ì™„ë£Œ');
            
            // 2. íšŒì› ë¡œê·¸ì¸ ì²´í¬
            console.log('2ï¸âƒ£ íšŒì› ë¡œê·¸ì¸ ì²´í¬ ì‹œì‘...');
            const memberId = window['checkMemberLogin']();
            console.log('   - checkMemberLogin() ë°˜í™˜ê°’:', memberId);
            console.log('   - íƒ€ì…:', typeof memberId);
            console.log('   - Boolean:', !!memberId);
            
            if (!memberId) {
              console.log('âŒ ë¡œê·¸ì¸ë˜ì§€ ì•ŠìŒ - redirectToLogin í˜¸ì¶œ');
              window['redirectToLogin']('íšŒì› ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.\në¡œê·¸ì¸ í˜ì´ì§€ë¡œ ì´ë™í•©ë‹ˆë‹¤.');
              return;
            }
            
            console.log('âœ… ë¡œê·¸ì¸ í™•ì¸ ì™„ë£Œ - memberId:', memberId);
            console.log('3ï¸âƒ£ DBì €ì¥ í”„ë¡œì„¸ìŠ¤ ì‹œì‘...');
            
            try {
              // ì…ë ¥ í•„ë“œì—ì„œ ë°ì´í„° ìˆ˜ì§‘
              const nameInput = document.getElementById('name');
              const yearInput = document.getElementById('year');
              const monthInput = document.getElementById('month');
              const dayInput = document.getElementById('day');
              const hourInput = document.getElementById('hour');
              const minuteInput = document.getElementById('minute');
              const calendarRadio = document.querySelector('input[name="calendar"]:checked');
              const yundalCheckbox = document.getElementById('yundal');
              const genderRadio = document.querySelector('input[name="gender"]:checked');
              const hourJiInput = document.getElementById('hour-ji-select');
              
              // í•„ìˆ˜ ì…ë ¥ ì²´í¬
              if (!nameInput || !nameInput.value.trim()) {
                alert('ì„±ëª…ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
              }
              
              if (!yearInput || !yearInput.value || !monthInput || !monthInput.value || !dayInput || !dayInput.value) {
                alert('ìƒë…„ì›”ì¼ì„ ì„ íƒí•´ì£¼ì„¸ìš”.');
                return;
              }
              
              // ìƒì¼ ë‚ ì§œ ë¬¸ìì—´ ìƒì„± (ISO 8601 í˜•ì‹ + ì‹œê°„ + ë¶„)
              const year = yearInput.value;
              const month = String(monthInput.value).padStart(2, '0');
              const day = String(dayInput.value).padStart(2, '0');
              const hour = hourInput && hourInput.value ? String(hourInput.value).padStart(2, '0') : '00';
              const minute = minuteInput && minuteInput.value ? String(minuteInput.value).padStart(2, '0') : '00';
              const birthDatetime = `${year}-${month}-${day}T${hour}:${minute}:00`;
              
              console.log('ğŸ“… birth_datetime ìƒì„±:', birthDatetime, `(${year}ë…„ ${month}ì›” ${day}ì¼ ${hour}ì‹œ ${minute}ë¶„)`);
              
              // content_enc ìƒì„±: ì‚¬ì£¼ ì •ë³´ ìƒì„¸ í…ìŠ¤íŠ¸ ë³€í™˜
              console.log('ğŸ“ content_enc ìƒì„± ì‹œì‘');
              let contentText = '';
              
              contentText += `â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n`;
              contentText += `ğŸ“Š ì‚¬ì£¼íŒ”ì ë¶„ì„ ê²°ê³¼\n`;
              contentText += `â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\n`;
              
              // ì‚¬ìš©ì ì •ë³´ (user-info-displayì—ì„œ ì¶”ì¶œ)
              const userInfoDisplay = document.getElementById('user-info-display');
              console.log('   - user-info-display ìš”ì†Œ:', userInfoDisplay ? 'ì°¾ìŒ' : 'ì—†ìŒ');
              
              if (userInfoDisplay) {
                const nameAgeElement = userInfoDisplay.querySelector('h3');
                if (nameAgeElement) {
                  const nameAgeText = nameAgeElement.textContent.trim();
                  contentText += `ğŸ‘¤ ${nameAgeText}\n\n`;
                  console.log('   - ì´ë¦„/ë‚˜ì´:', nameAgeText);
                }
                
                // ì„±ë³„, ìƒë…„ì›”ì¼, ì¶œìƒì‹œê° ì •ë³´
                const infoBoxes = userInfoDisplay.querySelectorAll('div[style*="background:white"]');
                console.log('   - ì •ë³´ ë°•ìŠ¤ ê°œìˆ˜:', infoBoxes.length);
                
                infoBoxes.forEach((box, idx) => {
                  const label = box.querySelector('div[style*="color:#6c757d"]');
                  const value = box.querySelector('div[style*="font-weight:700"]');
                  if (label && value) {
                    const labelText = label.textContent.trim();
                    const valueText = value.textContent.trim();
                    contentText += `${labelText}: ${valueText}\n`;
                    console.log(`   - ì •ë³´[${idx}] ${labelText}: ${valueText}`);
                  }
                });
                contentText += `\n`;
              } else {
                console.warn('âš ï¸ user-info-displayë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ì‚¬ì£¼ ë¶„ì„ì„ ë¨¼ì € ì‹¤í–‰í•˜ì„¸ìš”.');
              }
              
              contentText += `â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n`;
              contentText += `ğŸ”® å››æŸ±å…«å­— (ì‚¬ì£¼íŒ”ì)\n`;
              contentText += `â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\n`;
              
              console.log('   - ì‚¬ì£¼ê¸°ë‘¥ ì •ë³´ ì¶”ì¶œ ì‹œì‘');
              
              // ì‚¬ì£¼ê¸°ë‘¥ ì •ë³´ (pillar-cardì—ì„œ ì¶”ì¶œ)
              const pillars = ['hour', 'day', 'month', 'year'];
              const pillarNames = ['æ™‚æŸ±(ì‹œì£¼)', 'æ—¥æŸ±(ì¼ì£¼)â­', 'æœˆæŸ±(ì›”ì£¼)', 'å¹´æŸ±(ë…„ì£¼)'];
              const pillarDescs = ['ë§ë…„Â·ìì‹Â·55ì„¸ ì´í›„', 'ë³¸ì¸Â·ë°°ìš°ìÂ·33-55ì„¸', 'ë¶€ëª¨Â·ì§ì¥Â·17-33ì„¸', 'ì¡°ìƒÂ·ì–´ë¦°ì‹œì ˆÂ·1-17ì„¸'];
              
              // ì‚¬ì£¼íŒ”ì ìš”ì•½ (ê°„ì§€ë§Œ) í‘œ í˜•íƒœë¡œ ì¶”ì¶œ
              const sajuGanList = [];
              const sajuJiList = [];
              
              pillars.forEach((pillar, idx) => {
                const ganEl = document.getElementById(`${pillar}-gan`);
                const jiEl = document.getElementById(`${pillar}-ji`);
                
                if (ganEl && jiEl) {
                  const ganDivs = ganEl.querySelectorAll('div');
                  const jiDivs = jiEl.querySelectorAll('div');
                  
                  let ganText = '';
                  let jiText = '';
                  
                  if (ganDivs.length >= 2) {
                    ganText = ganDivs[1].textContent.trim();
                  } else {
                    ganText = ganEl.textContent.trim().split('\n').filter(t => t.trim())[0] || '';
                  }
                  
                  if (jiDivs.length >= 2) {
                    jiText = jiDivs[0].textContent.trim();
                  } else {
                    jiText = jiEl.textContent.trim().split('\n').filter(t => t.trim())[0] || '';
                  }
                  
                  sajuGanList.push(ganText);
                  sajuJiList.push(jiText);
                }
              });
              
              // ì‚¬ì£¼íŒ”ì ìš”ì•½ í‘œ í˜•íƒœë¡œ ì¶œë ¥ (ê°„ì§€ë¥¼ ë¶™ì—¬ì„œ í‘œì‹œ)
              if (sajuGanList.length === 4 && sajuJiList.length === 4) {
                contentText += `ã€æ™‚æŸ±(ì‹œì£¼)ã€‘: "${sajuGanList[0]}${sajuJiList[0]}" / ã€æ—¥æŸ±(ì¼ì£¼)â­ã€‘: "${sajuGanList[1]}${sajuJiList[1]}" / ã€æœˆæŸ±(ì›”ì£¼)ã€‘: "${sajuGanList[2]}${sajuJiList[2]}" / ã€å¹´æŸ±(ë…„ì£¼)ã€‘: "${sajuGanList[3]}${sajuJiList[3]}"\n\n`;
                
                console.log('   - ì‚¬ì£¼íŒ”ì ìš”ì•½ (ê°„ê²° í˜•íƒœ):');
                console.log(`     æ™‚: ${sajuGanList[0]}${sajuJiList[0]}, æ—¥: ${sajuGanList[1]}${sajuJiList[1]}, æœˆ: ${sajuGanList[2]}${sajuJiList[2]}, å¹´: ${sajuGanList[3]}${sajuJiList[3]}`);
              }
              
              // ìƒì„¸ ì •ë³´ ì¶œë ¥
              pillars.forEach((pillar, idx) => {
                const ganEl = document.getElementById(`${pillar}-gan`);
                const jiEl = document.getElementById(`${pillar}-ji`);
                const sibiunEl = document.getElementById(`${pillar}-sibiun`);
                const napeumEl = document.getElementById(`${pillar}-napeum`);
                const gongmangEl = document.getElementById(`${pillar}-gongmang`);
                
                console.log(`   - ${pillarNames[idx]}: gan=${ganEl?'O':'X'}, ji=${jiEl?'O':'X'}`);
                
                if (ganEl && jiEl) {
                  // ì²œê°„ ì •ë³´ ì¶”ì¶œ
                  const ganDivs = ganEl.querySelectorAll('div');
                  let ganText = '';
                  let ganSipseong = '';
                  if (ganDivs.length >= 2) {
                    ganSipseong = ganDivs[0].textContent.trim();
                    ganText = ganDivs[1].textContent.trim();
                  } else {
                    ganText = ganEl.textContent.trim().split('\n').filter(t => t.trim())[0] || '';
                  }
                  
                  // ì§€ì§€ ì •ë³´ ì¶”ì¶œ
                  const jiDivs = jiEl.querySelectorAll('div');
                  let jiText = '';
                  let jiSipseong = '';
                  if (jiDivs.length >= 2) {
                    jiText = jiDivs[0].textContent.trim();
                    jiSipseong = jiDivs[1].textContent.trim();
                  } else {
                    jiText = jiEl.textContent.trim().split('\n').filter(t => t.trim())[0] || '';
                  }
                  
                  const sibiun = sibiunEl ? sibiunEl.textContent.trim() : '';
                  const napeum = napeumEl ? napeumEl.textContent.trim() : '';
                  const gongmang = gongmangEl && gongmangEl.classList.contains('empty') ? 'ê³µë§' : '';
                  
                  contentText += `ã€${pillarNames[idx]}ã€‘ ${pillarDescs[idx]}\n`;
                  contentText += `  å¤©å¹²: ${ganText} ${ganSipseong}\n`;
                  contentText += `  åœ°æ”¯: ${jiText} ${jiSipseong}\n`;
                  if (sibiun) contentText += `  åäºŒé‹: ${sibiun}\n`;
                  if (napeum) contentText += `  ç´éŸ³: ${napeum}\n`;
                  if (gongmang) contentText += `  ç©ºäº¡: ${gongmang}\n`;
                  contentText += `\n`;
                }
              });
              
              // ì˜¤í–‰ ì§‘ê³„ ì •ë³´
              console.log('   - ì˜¤í–‰ ë¶„ì„ ì •ë³´ ì¶”ì¶œ ì‹œì‘');
              const elementSummary = document.getElementById('element-summary-header');
              console.log('   - element-summary-header:', elementSummary ? 'ì°¾ìŒ' : 'ì—†ìŒ');
              
              if (elementSummary) {
                contentText += `â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n`;
                contentText += `ğŸŒŸ ì˜¤í–‰ ë¶„ì„\n`;
                contentText += `â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n`;
                const summaryText = elementSummary.textContent.trim().replace(/\(í´ë¦­:ç¥æ®ºë³´ê¸°\)/g, '').trim();
                contentText += summaryText + `\n\n`;
                console.log('   - ì˜¤í–‰ ìš”ì•½:', summaryText.substring(0, 50));
                
                // ìƒì„¸ ì •ë³´ (í•©, í˜•ì¶©íŒŒí•´, ì‹ ì‚´ ë“±)
                const detailsDiv = document.getElementById('element-summary-details');
                if (detailsDiv) {
                  const detailItems = detailsDiv.querySelectorAll('div[style*="margin-bottom"]');
                  console.log('   - ìƒì„¸ í•­ëª© ê°œìˆ˜:', detailItems.length);
                  
                  detailItems.forEach(item => {
                    const itemText = item.textContent.trim()
                      .replace(/\s+/g, ' ')
                      .replace(/\//g, '\n  ');
                    if (itemText && !itemText.includes('ì—†ìŒ') && itemText.length > 5) {
                      contentText += itemText + `\n`;
                    }
                  });
                }
                contentText += `\n`;
              }
              
              const saveDateTime = new Date().toLocaleString('ko-KR');
              contentText += `â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n`;
              contentText += `ì €ì¥ì¼ì‹œ: ${saveDateTime}\n`;
              contentText += `â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n`;
              
              console.log('   - ì €ì¥ì¼ì‹œ:', saveDateTime);
              console.log('âœ… content_enc ìƒì„± ì™„ë£Œ (ì´', contentText.length, 'ì)');
              
              // íšŒì› ID ê°€ì ¸ì˜¤ê¸° (ì „ì—­ë³€ìˆ˜ì—ì„œ)
              let memberId = null;
              
              // window.MEMBER_SESSION í™•ì¸ (ìµœìš°ì„ )
              if (window.MEMBER_SESSION && window.MEMBER_SESSION.sMem_id) {
                memberId = window.MEMBER_SESSION.sMem_id;
                console.log('âœ… MEMBER_SESSIONì—ì„œ íšŒì› ID:', memberId);
              } else if (typeof window.sMem_id !== 'undefined' && window.sMem_id) {
                memberId = window.sMem_id;
                console.log('âœ… window.sMem_idì—ì„œ íšŒì› ID:', memberId);
              } else if (typeof sMem_id !== 'undefined' && sMem_id) {
                memberId = sMem_id;
                console.log('âœ… ì „ì—­ sMem_idì—ì„œ íšŒì› ID:', memberId);
              }
              
              if (!memberId) {
                console.log('âš ï¸ íšŒì› IDë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
              }
              
              // ì €ì¥í•  ë°ì´í„° êµ¬ì„± (ê° í•„ë“œ ê²€ì¦)
              console.log('â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”');
              console.log('ğŸ“‹ DBì €ì¥ ë°ì´í„° ìˆ˜ì§‘ ì‹œì‘');
              console.log('â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”');
              
              // 1. title, title_masked
              const title = 'ì¼ë°˜ì‚¬ì£¼ë³´ê¸°';
              const title_masked = 'ì¼ë°˜ì‚¬ì£¼ë³´ê¸°';
              console.log('1. title:', title);
              console.log('2. title_masked:', title_masked);
              
              // 3. author_name
              const author_name = nameInput.value.trim();
              console.log('3. author_name:', author_name);
              
              // 4. birth_datetime (ISO 8601 í˜•ì‹)
              console.log('4. birth_datetime:', birthDatetime);
              
              // 5. ì‹œê° ì…ë ¥ ë°©ì‹ í™•ì¸ (ì‹œê° ì…ë ¥ vs ê°„ì§€ ì…ë ¥)
              const timeInputTypeRadio = document.querySelector('input[name="timeInputType"]:checked');
              const isTimeInput = timeInputTypeRadio && timeInputTypeRadio.value === 'time';
              const isGanjiInput = timeInputTypeRadio && timeInputTypeRadio.value === 'ganji';
              
              console.log('5. ì‹œê° ì…ë ¥ ë°©ì‹:', isTimeInput ? 'ì‹œê° ì…ë ¥' : (isGanjiInput ? 'ê°„ì§€ ì…ë ¥' : 'ì•Œ ìˆ˜ ì—†ìŒ'));
              
              // 6. birth_hour, birth_minute, hour_ji (ì¡°ê±´ë¶€ ì„¤ì •)
              let birth_hour = null;
              let birth_minute = null;
              let hour_ji = '';
              
              if (isTimeInput) {
                // âœ… ì‹œê° ì…ë ¥ ëª¨ë“œ: ì‹œê°„/ë¶„ ì €ì¥, hour_ji ì´ˆê¸°í™”
                birth_hour = hourInput && hourInput.value ? parseInt(hourInput.value) : 0;
                birth_minute = minuteInput && minuteInput.value ? parseInt(minuteInput.value) : 0;
                hour_ji = '';  // ê°„ì§€ ì´ˆê¸°í™”
                console.log('   âœ… ì‹œê° ì…ë ¥ ëª¨ë“œ - birth_hour:', birth_hour, ', birth_minute:', birth_minute);
                console.log('   âœ… hour_ji ì´ˆê¸°í™”: ""');
              } else if (isGanjiInput) {
                // âœ… ê°„ì§€ ì…ë ¥ ëª¨ë“œ: hour_ji ì €ì¥, ì‹œê°„/ë¶„ ì´ˆê¸°í™”
                birth_hour = null;  // ì‹œê°„ ì´ˆê¸°í™”
                birth_minute = null;  // ë¶„ ì´ˆê¸°í™”
                hour_ji = hourJiInput && hourJiInput.value ? hourJiInput.value : '';
                console.log('   âœ… ê°„ì§€ ì…ë ¥ ëª¨ë“œ - hour_ji:', hour_ji);
                console.log('   âœ… birth_hour ì´ˆê¸°í™”: null');
                console.log('   âœ… birth_minute ì´ˆê¸°í™”: null');
              }
              
              // 7. birth_year
              const birth_year = yearInput && yearInput.value ? parseInt(yearInput.value) : 0;
              console.log('7. birth_year:', birth_year, '(ì…ë ¥ê°’:', yearInput?.value, ')');
              
              // 8. calendar_type (DBëŠ” í•œê¸€ë§Œ í—ˆìš©: 'ì–‘ë ¥', 'ìŒë ¥')
              const calendar_type = calendarRadio && calendarRadio.value === 'solar' ? 'ì–‘ë ¥' : 'ìŒë ¥';
              console.log('8. calendar_type:', calendar_type, '(ë¼ë””ì˜¤ê°’:', calendarRadio?.value, ')');
              
              // 9. yundal
              const yundal = yundalCheckbox && yundalCheckbox.checked ? 'Y' : 'N';
              console.log('9. yundal:', yundal, '(ì²´í¬ë¨:', yundalCheckbox?.checked, ')');
              
              // 10. author_gender
              const author_gender = genderRadio && genderRadio.value === 'male' ? 'M' : 'F';
              console.log('10. author_gender:', author_gender, '(ë¼ë””ì˜¤ê°’:', genderRadio?.value, ')');
              
              // 11. content_enc
              console.log('11. content_enc ê¸¸ì´:', contentText.length, 'ì');
              console.log('    content_enc ë¯¸ë¦¬ë³´ê¸°:', contentText.substring(0, 100) + '...');
              
              // 12. created_at (ì„œë²„ì—ì„œ ìë™ ìƒì„±)
              console.log('12. created_at: ì„œë²„ì—ì„œ ìë™ ìƒì„±');
              
              console.log('â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”');
              
              const data = {
                title: title,
                title_masked: title_masked,
                content: `ì„±ëª…: ${author_name}, ìƒë…„ì›”ì¼: ${birthDatetime}`,
                content_enc: contentText,
                post_password: 'saju2024',
                author_name: author_name,
                birth_datetime: birthDatetime,
                birth_hour: birth_hour,
                birth_minute: birth_minute,
                birth_year: birth_year,
                calendar_type: calendar_type,
                yundal: yundal,
                author_gender: author_gender,
                hour_ji: hour_ji,
                // ğŸ”’ ë³´ì•ˆ í•„ìˆ˜ í•„ë“œ (ì ˆëŒ€ ë³€ê²½ ê¸ˆì§€)
                snsgu: 'B0001',           // ì‚¬ì£¼ ë°ì´í„° êµ¬ë¶„
                smember_id: memberId,     // ë¡œê·¸ì¸í•œ íšŒì› ID (ë³¸ì¸ ë°ì´í„°)
                agreement: 1
              };
              
              console.log('ğŸ“¦ ìµœì¢… ì €ì¥ ë°ì´í„°:', JSON.stringify(data, null, 2));
              
              // API í˜¸ì¶œ
              let url = '/secret/api/v1/tickets';
              let method = 'POST';
              let shouldResetTicketId = false;
              
              // ticket_idê°€ ìˆìœ¼ë©´ ì‚¬ìš©ìì—ê²Œ ì„ íƒí•˜ë„ë¡ í•¨
              if (currentTicketId) {
                console.log('ğŸ“ ê¸°ì¡´ ticket_id ì¡´ì¬:', currentTicketId);
                
                // ì‚¬ìš©ìì—ê²Œ ì„ íƒ ìš”ì²­
                const userChoice = confirm(
                  'ê¸°ì¡´ ë°ì´í„°ê°€ ìˆìŠµë‹ˆë‹¤.\n\n' +
                  '[í™•ì¸] = ìˆ˜ì •í•˜ê¸° (ê¸°ì¡´ ë°ì´í„° ì—…ë°ì´íŠ¸)\n' +
                  '[ì·¨ì†Œ] = ì¶”ê°€í•˜ê¸° (ìƒˆë¡œìš´ ë°ì´í„° ìƒì„±)\n\n' +
                  'ì–´ë–»ê²Œ í•˜ì‹œê² ìŠµë‹ˆê¹Œ?'
                );
                
                if (userChoice) {
                  // í™•ì¸ â†’ ìˆ˜ì •í•˜ê¸° (UPDATE)
                  url = `/secret/api/v1/tickets/${currentTicketId}`;
                  method = 'PUT';
                  shouldResetTicketId = true;  // ìˆ˜ì • í›„ ticket_id ì´ˆê¸°í™”
                  console.log('ğŸ”„ ì‚¬ìš©ì ì„ íƒ: ê¸°ì¡´ í‹°ì¼“ ìˆ˜ì •');
                } else {
                  // ì·¨ì†Œ â†’ ì¶”ê°€í•˜ê¸° (INSERT)
                  method = 'POST';
                  console.log('â• ì‚¬ìš©ì ì„ íƒ: ìƒˆ í‹°ì¼“ ìƒì„±');
                }
              } else {
                console.log('â• ticket_id ì—†ìŒ - ìƒˆ í‹°ì¼“ ìƒì„±');
              }
              
              console.log('ğŸŒ API í˜¸ì¶œ ì‹œì‘:', method, url);
              
              const response = await fetch(url, {
                method: method,
                headers: {
                  'Content-Type': 'application/json'
                },
                body: JSON.stringify(data)
              });
              
              console.log('ğŸ“¡ API ì‘ë‹µ ìƒíƒœ:', response.status, response.statusText);
              
              const result = await response.json();
              console.log('ğŸ“¦ API ì‘ë‹µ ë°ì´í„°:', result);
              
              if (result.ok) {
                if (method === 'POST' && result.ticket_id) {
                  currentTicketId = result.ticket_id;
                  console.log('âœ… ì €ì¥ ì™„ë£Œ. ticket_id:', currentTicketId);
                } else if (method === 'PUT' && shouldResetTicketId) {
                  // ìˆ˜ì • ì™„ë£Œ í›„ ticket_id ì´ˆê¸°í™”
                  console.log('ğŸ”„ ìˆ˜ì • ì™„ë£Œ - ticket_id ì´ˆê¸°í™”:', currentTicketId, 'â†’ null');
                  currentTicketId = null;
                  
                  // URLì—ì„œ ticket_id íŒŒë¼ë¯¸í„° ì œê±°
                  const url = new URL(window.location.href);
                  url.searchParams.delete('ticket_id');
                  window.history.replaceState({}, '', url.toString());
                  console.log('âœ… URLì—ì„œ ticket_id íŒŒë¼ë¯¸í„° ì œê±° ì™„ë£Œ');
                }
                
                // sessionStorage í´ë¦¬ì–´
                sessionStorage.removeItem('sajuFormData');
                sessionStorage.removeItem('returnAfterLogin');
                
                alert(method === 'POST' ? 'DBì— ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.' : 'DBê°€ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤.');
              } else {
                console.error('âŒ ì €ì¥ ì‹¤íŒ¨:', result.error);
                alert('ì €ì¥ ì‹¤íŒ¨: ' + (result.error || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜'));
              }
              
            } catch (error) {
              console.error('âŒ DB ì €ì¥ ì˜¤ë¥˜:', error);
              console.error('   ì˜¤ë¥˜ ìƒì„¸:', error.message);
              console.error('   ìŠ¤íƒ:', error.stack);
              alert('DB ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.\n' + error.message);
            }
          });
          console.log('âœ… DBì €ì¥ ë²„íŠ¼ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë“±ë¡ ì™„ë£Œ');
        } else {
          console.error('âŒ DBì €ì¥ ë²„íŠ¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
        }
        
        // ë³´ë‚´ê¸° ë²„íŠ¼
        const sendBtn = document.getElementById('send-btn');
        if (sendBtn) {
          console.log('ğŸ”§ ë³´ë‚´ê¸° ë²„íŠ¼ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë“±ë¡ ì‹œì‘...');
          
          sendBtn.addEventListener('click', function(event) {
            console.log('=====================================');
            console.log('ğŸ“¤ ë³´ë‚´ê¸° ë²„íŠ¼ í´ë¦­ë¨');
            console.log('   - ì´ë²¤íŠ¸ íƒ€ì…:', event.type);
            console.log('   - íƒ€ê²Ÿ:', event.target);
            console.log('=====================================');
            
            // 1. ì‚¬ì£¼ ë¶„ì„ ê²°ê³¼ ì²´í¬
            console.log('1ï¸âƒ£ ì‚¬ì£¼ ë¶„ì„ ê²°ê³¼ ì²´í¬...');
            const sajuResultExists = window['checkSajuResult']();
            console.log('   - checkSajuResult() ë°˜í™˜ê°’:', sajuResultExists);
            
            if (!sajuResultExists) {
              console.log('âŒ ì‚¬ì£¼ ë¶„ì„ ê²°ê³¼ ì—†ìŒ - alert í‘œì‹œ');
              alert('ë¨¼ì € "ì‚¬ì£¼ë³´ê¸°" ë²„íŠ¼ì„ í´ë¦­í•˜ì—¬ ì‚¬ì£¼ë¥¼ ë¶„ì„í•´ì£¼ì„¸ìš”.');
              return;
            }
            console.log('âœ… ì‚¬ì£¼ ë¶„ì„ ê²°ê³¼ í™•ì¸ ì™„ë£Œ');
            
            // 2. íšŒì› ë¡œê·¸ì¸ ì²´í¬
            console.log('2ï¸âƒ£ íšŒì› ë¡œê·¸ì¸ ì²´í¬ ì‹œì‘...');
            const memberId = window['checkMemberLogin']();
            console.log('   - checkMemberLogin() ë°˜í™˜ê°’:', memberId);
            
            if (!memberId) {
              console.log('âŒ ë¡œê·¸ì¸ë˜ì§€ ì•ŠìŒ - redirectToLogin í˜¸ì¶œ');
              window['redirectToLogin']('íšŒì› ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.\në¡œê·¸ì¸ í˜ì´ì§€ë¡œ ì´ë™í•©ë‹ˆë‹¤.');
              return;
            }
            console.log('âœ… ë¡œê·¸ì¸ í™•ì¸ ì™„ë£Œ - memberId:', memberId);
            
            // 3. ì‚¬ì£¼ ë¶„ì„ ê²°ê³¼ í…ìŠ¤íŠ¸ ìƒì„±
            const shareText = window['generateSajuShareText']();
            
            if (!shareText) {
              alert('ê³µìœ í•  ë°ì´í„°ë¥¼ ìƒì„±í•˜ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
              return;
            }
            
            // 4. ê³µìœ  ë°©ë²• ì„ íƒ
            window['showShareOptions'](shareText);
          });
          console.log('âœ… ë³´ë‚´ê¸° ë²„íŠ¼ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë“±ë¡ ì™„ë£Œ');
        } else {
          console.error('âŒ ë³´ë‚´ê¸° ë²„íŠ¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
        }
        
        // ì‚¬ì£¼ ë¶„ì„ ê²°ê³¼ë¥¼ í…ìŠ¤íŠ¸ë¡œ ìƒì„±í•˜ëŠ” í•¨ìˆ˜
        function generateSajuShareText() {
          try {
            let text = 'â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n';
            text += 'ğŸ“Š ì‚¬ì£¼íŒ”ì ë¶„ì„ ê²°ê³¼\n';
            text += 'â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\n';
            
            // ì‚¬ìš©ì ì •ë³´ ì¶”ì¶œ
            const userInfoDisplay = document.getElementById('user-info-display');
            if (userInfoDisplay) {
              const nameAgeElement = userInfoDisplay.querySelector('h3');
              if (nameAgeElement) {
                text += 'ğŸ‘¤ ' + nameAgeElement.textContent.trim() + '\n\n';
              }
              
              // ì„±ë³„, ìƒë…„ì›”ì¼, ì¶œìƒì‹œê° ì •ë³´
              const infoBoxes = userInfoDisplay.querySelectorAll('div[style*="background:white"]');
              infoBoxes.forEach(box => {
                const label = box.querySelector('div[style*="color:#6c757d"]');
                const value = box.querySelector('div[style*="font-weight:700"]');
                if (label && value) {
                  text += label.textContent.trim() + ': ' + value.textContent.trim() + '\n';
                }
              });
              text += '\n';
            }
            
            text += 'â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n';
            text += 'ğŸ”® å››æŸ±å…«å­— (ì‚¬ì£¼íŒ”ì)\n';
            text += 'â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\n';
            
            // ì‚¬ì£¼ê¸°ë‘¥ ì •ë³´ ì¶”ì¶œ
            const pillars = ['hour', 'day', 'month', 'year'];
            const pillarNames = ['æ™‚æŸ±(ì‹œì£¼)', 'æ—¥æŸ±(ì¼ì£¼)â­', 'æœˆæŸ±(ì›”ì£¼)', 'å¹´æŸ±(ë…„ì£¼)'];
            
            // ì‚¬ì£¼íŒ”ì ìš”ì•½ í‘œ í˜•íƒœë¡œ ì¶”ì¶œ
            const sajuGanList = [];
            const sajuJiList = [];
            
            pillars.forEach((pillar, idx) => {
              const ganEl = document.getElementById(`${pillar}-gan`);
              const jiEl = document.getElementById(`${pillar}-ji`);
              
              if (ganEl && jiEl) {
                const ganDivs = ganEl.querySelectorAll('div');
                const jiDivs = jiEl.querySelectorAll('div');
                
                let ganText = '';
                let jiText = '';
                
                if (ganDivs.length >= 2) {
                  ganText = ganDivs[1].textContent.trim();
                } else {
                  ganText = ganEl.textContent.trim().split('\n').filter(t => t.trim())[0] || '';
                }
                
                if (jiDivs.length >= 2) {
                  jiText = jiDivs[0].textContent.trim();
                } else {
                  jiText = jiEl.textContent.trim().split('\n').filter(t => t.trim())[0] || '';
                }
                
                sajuGanList.push(ganText);
                sajuJiList.push(jiText);
              }
            });
            
            // ì‚¬ì£¼íŒ”ì ìš”ì•½ í‘œ í˜•íƒœë¡œ ì¶œë ¥ (1ì¤„ ê°„ê²° í˜•ì‹ + 3ì¤„ í‘œ í˜•ì‹)
            if (sajuGanList.length === 4 && sajuJiList.length === 4) {
              // 1ì¤„ ê°„ê²° í˜•ì‹
              text += `ã€æ™‚æŸ±(ì‹œì£¼)ã€‘: "${sajuGanList[0]}${sajuJiList[0]}" / ã€æ—¥æŸ±(ì¼ì£¼)â­ã€‘: "${sajuGanList[1]}${sajuJiList[1]}" / ã€æœˆæŸ±(ì›”ì£¼)ã€‘: "${sajuGanList[2]}${sajuJiList[2]}" / ã€å¹´æŸ±(ë…„ì£¼)ã€‘: "${sajuGanList[3]}${sajuJiList[3]}"\n\n`;
              
              // 3ì¤„ í‘œ í˜•ì‹
              text += `ã€æ™‚æŸ±(ì‹œì£¼)ã€‘ã€æ—¥æŸ±(ì¼ì£¼)â­ã€‘ã€æœˆæŸ±(ì›”ì£¼)ã€‘ã€å¹´æŸ±(ë…„ì£¼)ã€‘\n`;
              text += `------"${sajuGanList[0]}"----------"${sajuGanList[1]}"------------"${sajuGanList[2]}"----------"${sajuGanList[3]}"-----\n`;
              text += `------"${sajuJiList[0]}"----------"${sajuJiList[1]}"------------"${sajuJiList[2]}"----------"${sajuJiList[3]}"-----\n\n`;
            }
            
            // ìƒì„¸ ì‚¬ì£¼ê¸°ë‘¥ ì •ë³´
            pillars.forEach((pillar, idx) => {
              const ganEl = document.getElementById(`${pillar}-gan`);
              const jiEl = document.getElementById(`${pillar}-ji`);
              const sibiunEl = document.getElementById(`${pillar}-sibiun`);
              const napeumEl = document.getElementById(`${pillar}-napeum`);
              const pillarDescElements = document.querySelectorAll('.pillar-desc');
              
              if (ganEl && jiEl) {
                const ganText = ganEl.textContent.trim().split('\n').filter(t => t.trim()).join(' ');
                const jiText = jiEl.textContent.trim().split('\n').filter(t => t.trim()).join(' ');
                const sibiun = sibiunEl ? sibiunEl.textContent.trim() : '';
                const napeum = napeumEl ? napeumEl.textContent.trim() : '';
                const pillarDesc = pillarDescElements[idx] ? pillarDescElements[idx].textContent.trim() : '';
                
                text += `ã€${pillarNames[idx]}ã€‘ ${pillarDesc}\n`;
                text += `  å¤©å¹²: ${ganText}\n`;
                text += `  åœ°æ”¯: ${jiText}\n`;
                if (sibiun) text += `  åäºŒé‹: ${sibiun}\n`;
                if (napeum) text += `  ç´éŸ³: ${napeum}\n`;
                text += '\n';
              }
            });
            
            // ì˜¤í–‰ ì§‘ê³„ ì •ë³´
            const elementSummary = document.getElementById('element-summary-header');
            if (elementSummary) {
              text += 'â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n';
              text += 'ğŸŒŸ ì˜¤í–‰ ë¶„ì„\n';
              text += 'â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n';
              const summaryText = elementSummary.textContent.trim().replace(/\(í´ë¦­:ç¥æ®ºë³´ê¸°\)/g, '').trim();
              text += summaryText + '\n\n';
              
              // ìƒì„¸ ì •ë³´ (í•©, í˜•ì¶©íŒŒí•´, ì‹ ì‚´ ë“±)
              const detailsDiv = document.getElementById('element-summary-details');
              if (detailsDiv) {
                const detailItems = detailsDiv.querySelectorAll('div[style*="margin-bottom"]');
                detailItems.forEach(item => {
                  const itemText = item.textContent.trim()
                    .replace(/\s+/g, ' ')
                    .replace(/\//g, '\n  ');
                  if (itemText && !itemText.includes('ì—†ìŒ')) {
                    text += itemText + '\n';
                  }
                });
              }
            }
            
            // ëŒ€ìš´ê°„ì§€ ì •ë³´ ì¶”ê°€
            text += '\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n';
            text += 'ğŸŒŠ å¤§é‹ (ëŒ€ìš´) ê°„ì§€ - 10ë…„ ë‹¨ìœ„ (ì™¼ìª½â†’ì˜¤ë¥¸ìª½)\n';
            text += 'â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n';
            
            // daeun-chartì™€ daeun-summary ëª¨ë‘ í™•ì¸
            const daeunChart = document.getElementById('daeun-chart');
            const daeunSummary = document.getElementById('daeun-summary');
            
            let daeunFound = false;
            
            // 1. daeun-chartì—ì„œ ëŒ€ìš´ ì •ë³´ ì¶”ì¶œ (ì£¼ìš” ë°ì´í„°)
            if (daeunChart && daeunChart.textContent.trim()) {
              console.log('ğŸ” ëŒ€ìš´ ì°¨íŠ¸ ë°œê²¬, ì „ì²´ í…ìŠ¤íŠ¸ íŒŒì‹± ì‹œì‘...');
              
              // ì „ì²´ í…ìŠ¤íŠ¸ë¥¼ ë¨¼ì € ì¶”ì¶œ
              const chartText = daeunChart.textContent.trim();
              console.log('ğŸ“„ ëŒ€ìš´ ì°¨íŠ¸ ì›ë³¸:', chartText.substring(0, 200));
              
              // ëª¨ë“  ìì‹ div ìš”ì†Œ í™•ì¸ (ë” ì •í™•í•œ ì¶”ì¶œ)
              const allDivs = daeunChart.querySelectorAll('div');
              const daeunData = [];
              
              // ë°©ë²• 1: div ìš”ì†Œë¥¼ ìˆœíšŒí•˜ë©° ë°ì´í„° ì¶”ì¶œ
              if (allDivs.length > 0) {
                console.log('ğŸ“¦ ì´ div ê°œìˆ˜:', allDivs.length);
                
                let currentAge = null;
                let currentGan = null;
                let currentJi = null;
                
                allDivs.forEach((div, idx) => {
                  const text = div.textContent.trim();
                  
                  // ë‚˜ì´ ë²”ìœ„ íŒ¨í„´ (ì˜ˆ: "1-10ì„¸", "21-30ì„¸")
                  if (text.match(/^\d+-\d+ì„¸$/)) {
                    // ì´ì „ ë°ì´í„°ê°€ ì™„ì„±ë˜ì—ˆìœ¼ë©´ ì €ì¥
                    if (currentAge && currentGan && currentJi) {
                      daeunData.push({ 
                        ageRange: currentAge, 
                        gan: currentGan, 
                        ji: currentJi 
                      });
                    }
                    // ìƒˆë¡œìš´ ëŒ€ìš´ ì‹œì‘
                    currentAge = text;
                    currentGan = null;
                    currentJi = null;
                  }
                  // ì²œê°„ íŒ¨í„´ (í•œì 1ê¸€ì: ç”², ä¹™, ä¸™, ä¸, æˆŠ, å·±, åºš, è¾›, å£¬, ç™¸)
                  else if (currentAge && !currentGan && text.length === 1 && 
                           text.match(/[ç”²ä¹™ä¸™ä¸æˆŠå·±åºšè¾›å£¬ç™¸]/)) {
                    currentGan = text;
                  }
                  // ì§€ì§€ íŒ¨í„´ (í•œì 1ê¸€ì: å­, ä¸‘, å¯…, å¯, è¾°, å·³, åˆ, æœª, ç”³, é…‰, æˆŒ, äº¥)
                  else if (currentAge && currentGan && !currentJi && text.length === 1 && 
                           text.match(/[å­ä¸‘å¯…å¯è¾°å·³åˆæœªç”³é…‰æˆŒäº¥]/)) {
                    currentJi = text;
                  }
                });
                
                // ë§ˆì§€ë§‰ ë°ì´í„° ì €ì¥
                if (currentAge && currentGan && currentJi) {
                  daeunData.push({ 
                    ageRange: currentAge, 
                    gan: currentGan, 
                    ji: currentJi 
                  });
                }
                
                console.log('âœ… ì¶”ì¶œëœ ëŒ€ìš´ ê°œìˆ˜:', daeunData.length);
              }
              
              // ë°©ë²• 2: div íŒŒì‹±ì´ ì‹¤íŒ¨í–ˆìœ¼ë©´ í…ìŠ¤íŠ¸ ë¼ì¸ ê¸°ë°˜ íŒŒì‹±
              if (daeunData.length === 0 && chartText) {
                console.log('âš ï¸ div íŒŒì‹± ì‹¤íŒ¨, í…ìŠ¤íŠ¸ ë¼ì¸ íŒŒì‹± ì‹œë„...');
                
                const lines = chartText.split('\n')
                  .map(line => line.trim())
                  .filter(line => line.length > 0);
                
                console.log('ğŸ“ ì´ ë¼ì¸ ìˆ˜:', lines.length);
                console.log('ğŸ“ ì²« 10ì¤„:', lines.slice(0, 10));
                
                // 3ì¤„ì”© ë¬¶ì–´ì„œ íŒŒì‹± (ë‚˜ì´, ì²œê°„, ì§€ì§€)
                for (let i = 0; i < lines.length; i += 3) {
                  if (i + 2 < lines.length) {
                    const line1 = lines[i];
                    const line2 = lines[i + 1];
                    const line3 = lines[i + 2];
                    
                    // ë‚˜ì´ ë²”ìœ„ í™•ì¸
                    if (line1.match(/\d+-\d+ì„¸/)) {
                      daeunData.push({ 
                        ageRange: line1, 
                        gan: line2, 
                        ji: line3 
                      });
                    }
                  }
                }
                
                console.log('âœ… ë¼ì¸ íŒŒì‹± ê²°ê³¼:', daeunData.length, 'ê°œ');
              }
              
              // ê²°ê³¼ ì¶œë ¥
              if (daeunData.length > 0) {
                console.log('ğŸ‰ ìµœì¢… ëŒ€ìš´ ë°ì´í„°:', daeunData.length, 'ê°œ');
                
                // ì—­ìˆœìœ¼ë¡œ ì •ë ¬ (ì–´ë¦° ë‚˜ì´ë¶€í„° í‘œì‹œ)
                daeunData.reverse();
                
                // ê°€ë¡œë¡œ í‘œì‹œ (3ì¤„ í˜•ì‹)
                const ageRangeLine = daeunData.map(d => d.ageRange.padEnd(13, ' ')).join('');
                const ganLine = daeunData.map(d => d.gan.padEnd(13, ' ')).join('');
                const jiLine = daeunData.map(d => d.ji.padEnd(13, ' ')).join('');
                
                text += ageRangeLine + '\n';
                text += ganLine + '\n';
                text += jiLine + '\n';
                daeunFound = true;
                
                console.log('âœ… ëŒ€ìš´ í…ìŠ¤íŠ¸ ìƒì„± ì™„ë£Œ!');
              } else {
                console.warn('âš ï¸ ëŒ€ìš´ ë°ì´í„° ì¶”ì¶œ ì‹¤íŒ¨, ì›ë³¸ í‘œì‹œ');
                // íŒŒì‹± ì™„ì „ ì‹¤íŒ¨ì‹œ ì›ë³¸ ê·¸ëŒ€ë¡œ í‘œì‹œ
                const lines = chartText.split('\n')
                  .map(line => line.trim())
                  .filter(line => line.length > 0);
                
                lines.forEach(line => {
                  text += line + '\n';
                });
                daeunFound = true;
              }
            }
            
            // 2. daeun-summaryì—ì„œ ì¶”ê°€ ì •ë³´ ì¶”ì¶œ
            if (daeunSummary && daeunSummary.textContent.trim()) {
              const summaryText = daeunSummary.textContent.trim()
                .replace(/\s+/g, ' ')
                .replace(/í˜„ì¬ ëŒ€ìš´:/g, '\nğŸ“ í˜„ì¬ ëŒ€ìš´:')
                .replace(/ë‹¤ìŒ ëŒ€ìš´:/g, '\nâ¡ï¸ ë‹¤ìŒ ëŒ€ìš´:')
                .replace(/ëŒ€ìš´ ì „í™˜:/g, '\nğŸ”„ ëŒ€ìš´ ì „í™˜:')
                .trim();
              if (summaryText) {
                text += '\n' + summaryText + '\n';
                daeunFound = true;
              }
            }
            
            // ëŒ€ìš´ ì •ë³´ê°€ ì—†ìœ¼ë©´ ì•ˆë‚´ ë©”ì‹œì§€
            if (!daeunFound) {
              text += 'ëŒ€ìš´ ì •ë³´ë¥¼ í‘œì‹œí•˜ë ¤ë©´ "ì‚¬ì£¼ë³´ê¸°"ë¥¼ ë¨¼ì € ì‹¤í–‰í•´ì£¼ì„¸ìš”.\n';
            }
            
            // ë…„ìš´ê°„ì§€ ì •ë³´ ì¶”ê°€ (ì˜¬í•´ë§Œ)
            text += '\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n';
            text += 'ğŸ“… å¹´é‹ (ë…„ìš´) ê°„ì§€ - í•´ë‹¹ë…„ë„\n';
            text += 'â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n';
            
            // ìš°ì„  ì „ì—­ ë³€ìˆ˜ì—ì„œ ë…„ìš´ ë°ì´í„° í™•ì¸ (saju_script_exec.jsì—ì„œ ì €ì¥ë¨)
            let yeonunData = [];
            
            // í˜„ì¬ ë…„ë„ ê³„ì‚°
            const currentYear = new Date().getFullYear();
            const currentYearStr = currentYear + 'ë…„';
            
            // ë°©ë²• 1: window.lastYeonunResultì—ì„œ ë°ì´í„° ê°€ì ¸ì˜¤ê¸° (ê°€ì¥ ì •í™•)
            if (window.lastYeonunResult && Array.isArray(window.lastYeonunResult) && window.lastYeonunResult.length > 0) {
              console.log('âœ… ì „ì—­ ë³€ìˆ˜ì—ì„œ ë…„ìš´ ë°ì´í„° ë°œê²¬:', window.lastYeonunResult.length, 'ê°œ');
              console.log('ğŸ¯ í˜„ì¬ ë…„ë„ í•„í„°ë§:', currentYearStr, '(ìˆ«ì:', currentYear, ')');
              console.log('ğŸ“Š ì²« ë²ˆì§¸ API ë°ì´í„° ìƒ˜í”Œ:', window.lastYeonunResult[0]);
              
              // API ì‘ë‹µ í˜•ì‹: [{ year: 2020, gan: 'åºš', zhi: 'å­' }, ...]
              // í˜„ì¬ ë…„ë„ë§Œ í•„í„°ë§
              const currentYearData = window.lastYeonunResult.find(item => item.year === currentYear);
              
              if (currentYearData) {
                console.log('ğŸ” ì°¾ì€ ì›ë³¸ ë°ì´í„°:', currentYearData);
                console.log('  - year:', currentYearData.year);
                console.log('  - gan:', currentYearData.gan);
                console.log('  - ji:', currentYearData.ji);
                
                yeonunData = [{
                  year: currentYearData.year + 'ë…„',
                  gan: currentYearData.gan,
                  ji: currentYearData.ji  // â† zhiê°€ ì•„ë‹ˆë¼ ji!
                }];
                console.log('âœ… í˜„ì¬ ë…„ë„ ë…„ìš´ ë°œê²¬:', yeonunData[0]);
              } else {
                console.warn('âš ï¸ í˜„ì¬ ë…„ë„ ë…„ìš´ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤:', currentYear);
              }
              
              console.log('ğŸ‰ ì „ì—­ ë³€ìˆ˜ì—ì„œ ìµœì¢… ë…„ìš´ ë°ì´í„°:', yeonunData.length, 'ê°œ');
            }
            
            // ë°©ë²• 2: DOMì—ì„œ íŒŒì‹± (ë°±ì—…) - í˜„ì¬ ë…„ë„ë§Œ
            const sewunAnalysis = document.getElementById('sewun-analysis');
            if (yeonunData.length === 0 && sewunAnalysis && sewunAnalysis.textContent.trim()) {
              console.log('ğŸ” DOMì—ì„œ í˜„ì¬ ë…„ë„ ë…„ìš´ íŒŒì‹± ì‹œì‘...');
              console.log('ğŸ¯ ì°¾ì„ ë…„ë„:', currentYearStr);
              
              const sewunFullText = sewunAnalysis.textContent.trim();
              console.log('ğŸ“„ ë…„ìš´ ì›ë³¸:', sewunFullText.substring(0, 200));
              
              // ëª¨ë“  ìì‹ ìš”ì†Œ í™•ì¸ (ë” ë„“ì€ ë²”ìœ„)
              const allElements = sewunAnalysis.querySelectorAll('*');
              
              console.log('ğŸ“¦ ì´ ìš”ì†Œ ê°œìˆ˜:', allElements.length);
              
              // ë°©ë²• 1: ëª¨ë“  ìš”ì†Œë¥¼ ìˆœíšŒí•˜ë©° í˜„ì¬ ë…„ë„ ë°ì´í„°ë§Œ ì¶”ì¶œ
              if (allElements.length > 0) {
                let foundYear = null;
                let foundGan = null;
                let foundJi = null;
                let debugCount = 0;
                let isCurrentYear = false;
                
                allElements.forEach((elem, idx) => {
                  const text = elem.textContent.trim();
                  
                  // ìì‹ ìš”ì†Œê°€ ì—†ëŠ” ë¦¬í”„ ë…¸ë“œë§Œ ì²˜ë¦¬ (ì¤‘ë³µ ë°©ì§€)
                  if (elem.children.length === 0 && text.length > 0) {
                    if (debugCount < 20) {
                      console.log(`  [${idx}] í…ìŠ¤íŠ¸: "${text}"`);
                      debugCount++;
                    }
                    
                    // ë…„ë„ íŒ¨í„´ (ì˜ˆ: "2026ë…„", "2027ë…„")
                    if (text.match(/^\d{4}ë…„$/)) {
                      // í˜„ì¬ ë…„ë„ì¸ì§€ í™•ì¸
                      if (text === currentYearStr) {
                        console.log(`  ğŸ¯ í˜„ì¬ ë…„ë„ ë°œê²¬: ${text}`);
                        isCurrentYear = true;
                        foundYear = text;
                        foundGan = null;
                        foundJi = null;
                      } else {
                        console.log(`  â­ï¸ ë‹¤ë¥¸ ë…„ë„ ê±´ë„ˆëœ€: ${text}`);
                        isCurrentYear = false;
                      }
                    }
                    // í˜„ì¬ ë…„ë„ì¸ ê²½ìš°ì—ë§Œ ì²œê°„/ì§€ì§€ ìˆ˜ì§‘
                    else if (isCurrentYear) {
                      // ì²œê°„ íŒ¨í„´ (í•œì 1ê¸€ì)
                      if (!foundGan && text.length === 1 && 
                          text.match(/[ç”²ä¹™ä¸™ä¸æˆŠå·±åºšè¾›å£¬ç™¸]/)) {
                        console.log(`  âœ“ ì²œê°„ ë°œê²¬: ${text}`);
                        foundGan = text;
                      }
                      // ì§€ì§€ íŒ¨í„´ (í•œì 1ê¸€ì)
                      else if (foundGan && !foundJi && text.length === 1 && 
                               text.match(/[å­ä¸‘å¯…å¯è¾°å·³åˆæœªç”³é…‰æˆŒäº¥]/)) {
                        console.log(`  âœ“ ì§€ì§€ ë°œê²¬: ${text}`);
                        foundJi = text;
                        
                        // í˜„ì¬ ë…„ë„ ë°ì´í„° ì™„ì„±ë˜ë©´ ì €ì¥í•˜ê³  ì¢…ë£Œ
                        if (foundYear && foundGan && foundJi) {
                          console.log(`  âœ… í˜„ì¬ ë…„ë„ ë…„ìš´ ì™„ì„±: ${foundYear} ${foundGan}${foundJi}`);
                          yeonunData.push({ 
                            year: foundYear, 
                            gan: foundGan, 
                            ji: foundJi 
                          });
                          return; // forEach ì¢…ë£Œ
                        }
                      }
                    }
                  }
                });
                
                console.log('âœ… ì¶”ì¶œëœ ë…„ìš´ ê°œìˆ˜:', yeonunData.length);
              }
              
              // ë°©ë²• 2: div íŒŒì‹±ì´ ì‹¤íŒ¨í–ˆìœ¼ë©´ í…ìŠ¤íŠ¸ ë¼ì¸ ê¸°ë°˜ íŒŒì‹± (í˜„ì¬ ë…„ë„ë§Œ)
              if (yeonunData.length === 0 && sewunFullText) {
                console.log('âš ï¸ div íŒŒì‹± ì‹¤íŒ¨, í…ìŠ¤íŠ¸ ë¼ì¸ íŒŒì‹± ì‹œë„...');
                console.log('ğŸ¯ ì°¾ì„ ë…„ë„:', currentYearStr);
                
                const lines = sewunFullText.split('\n')
                  .map(line => line.trim())
                  .filter(line => line.length > 0);
                
                console.log('ğŸ“ ì´ ë¼ì¸ ìˆ˜:', lines.length);
                console.log('ğŸ“ ì²« 10ì¤„:', lines.slice(0, 10));
                
                // í˜„ì¬ ë…„ë„ë¥¼ ì°¾ì•„ì„œ ê·¸ ë‹¤ìŒ 2ì¤„(ì²œê°„, ì§€ì§€) ì¶”ì¶œ
                for (let i = 0; i < lines.length; i++) {
                  const line = lines[i];
                  
                  // í˜„ì¬ ë…„ë„ íŒ¨í„´ í™•ì¸
                  if (line === currentYearStr) {
                    console.log(`  ğŸ¯ í˜„ì¬ ë…„ë„ ë°œê²¬: ${line}`);
                    
                    // ë‹¤ìŒ 2ì¤„ì´ ìˆìœ¼ë©´ ì²œê°„, ì§€ì§€ë¡œ ê°„ì£¼
                    if (i + 2 < lines.length) {
                      const gan = lines[i + 1];
                      const ji = lines[i + 2];
                      
                      console.log(`  âœ“ ì²œê°„: ${gan}, ì§€ì§€: ${ji}`);
                      
                      yeonunData.push({ 
                        year: line, 
                        gan: gan, 
                        ji: ji 
                      });
                      
                      break; // í˜„ì¬ ë…„ë„ ì°¾ì•˜ìœ¼ë©´ ì¢…ë£Œ
                    }
                  }
                }
                
                console.log('âœ… ë¼ì¸ íŒŒì‹± ê²°ê³¼:', yeonunData.length, 'ê°œ');
              }
            }
            
            // ìµœì¢… ì¶œë ¥ (í˜„ì¬ ë…„ë„ 1ê°œë§Œ)
            if (yeonunData.length > 0) {
              console.log('ğŸ‰ ìµœì¢… ë…„ìš´ ë°ì´í„°:', yeonunData.length, 'ê°œ');
              console.log('ğŸ“Š ë…„ìš´ ë°ì´í„° êµ¬ì¡°:', yeonunData[0]);
              
              // í˜„ì¬ ë…„ë„ ë°ì´í„° (1ê°œ)
              const data = yeonunData[0];
              const year = data.year || '';
              const gan = data.gan || '';
              const ji = data.ji || '';
              
              console.log('ğŸ” ë…„ìš´ ìƒì„¸:');
              console.log('  - year:', year);
              console.log('  - gan:', gan);
              console.log('  - ji:', ji);
              console.log('  - í•©ì¹œ ê²°ê³¼:', `${gan}${ji}`);
              
              // 1ì¤„ë¡œ ê°„ë‹¨í•˜ê²Œ í‘œì‹œ
              text += `ğŸ“ ${year}: ${gan}${ji}\n`;
              
              console.log('âœ… ë…„ìš´ í…ìŠ¤íŠ¸ ìƒì„± ì™„ë£Œ!');
            } else {
              console.warn('âš ï¸ í˜„ì¬ ë…„ë„ ë…„ìš´ ë°ì´í„°ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤');
              text += 'í˜„ì¬ ë…„ë„ ë…„ìš´ ì •ë³´ë¥¼ í‘œì‹œí•˜ë ¤ë©´ "ì‚¬ì£¼ë³´ê¸°"ë¥¼ ë¨¼ì € ì‹¤í–‰í•´ì£¼ì„¸ìš”.\n';
            }
            
            text += '\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n';
            text += 'ğŸŒ ë‚˜ë¼í†¡í†¡ ì‚¬ì£¼í’€ì´\n';
            text += window.location.origin + '/saju/\n';
            text += 'â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n';
            
            return text;
          } catch (error) {
            console.error('âŒ í…ìŠ¤íŠ¸ ìƒì„± ì˜¤ë¥˜:', error);
            return null;
          }
        }
        
        
        // ê³µìœ  ì˜µì…˜ì„ ë³´ì—¬ì£¼ëŠ” í•¨ìˆ˜
        function showShareOptions(text) {
          // ëª¨ë‹¬ ìƒì„±
          const modal = document.createElement('div');
          modal.style.cssText = `
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10000;
          `;
          
          const modalContent = document.createElement('div');
          modalContent.style.cssText = `
            background: white;
            padding: 30px;
            border-radius: 15px;
            max-width: 500px;
            width: 90%;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
          `;
          
          // ëª¨ë°”ì¼ í™˜ê²½ ê°ì§€
          const isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);
          
          modalContent.innerHTML = `
            <h3 style="margin-top:0;color:#333;text-align:center;">ğŸ“¤ ê³µìœ  ë°©ë²• ì„ íƒ</h3>
            <div style="display:flex;flex-direction:column;gap:10px;margin-top:20px;">
              ${isMobile ? `
                <button id="shareKakaoBtn" style="padding:15px;font-size:16px;border:2px solid #FEE500;background:#FEE500;color:#000;border-radius:8px;cursor:pointer;font-weight:600;">
                  ğŸ’¬ ì¹´ì¹´ì˜¤í†¡ìœ¼ë¡œ ê³µìœ 
                </button>
                <button id="shareSMSBtn" style="padding:15px;font-size:16px;border:2px solid #FF9800;background:#FF9800;color:white;border-radius:8px;cursor:pointer;font-weight:600;">
                  ğŸ’¬ ë¬¸ì(SMS)ë¡œ ê³µìœ 
                </button>
                <button id="shareWebBtn" style="padding:15px;font-size:16px;border:2px solid #2196F3;background:#2196F3;color:white;border-radius:8px;cursor:pointer;font-weight:600;">
                  ğŸŒ ê¸°íƒ€ ì•±ìœ¼ë¡œ ê³µìœ 
                </button>
              ` : ''}
              <button id="copyTextBtn" style="padding:15px;font-size:16px;border:2px solid #4CAF50;background:#4CAF50;color:white;border-radius:8px;cursor:pointer;font-weight:600;">
                ğŸ“‹ í…ìŠ¤íŠ¸ ë³µì‚¬í•˜ê¸°
              </button>
              <button id="closeModalBtn" style="padding:15px;font-size:16px;border:2px solid #ccc;background:white;color:#666;border-radius:8px;cursor:pointer;margin-top:10px;">
                ì·¨ì†Œ
              </button>
            </div>
          `;
          
          modal.appendChild(modalContent);
          document.body.appendChild(modal);
          
          // ë²„íŠ¼ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
          document.getElementById('copyTextBtn').addEventListener('click', () => {
            window['copyToClipboard'](text);
            document.body.removeChild(modal);
          });
          
          // ëª¨ë°”ì¼ ì „ìš© ë²„íŠ¼ë“¤
          if (isMobile) {
            document.getElementById('shareKakaoBtn').addEventListener('click', () => {
              window['shareToKakao'](text);
              document.body.removeChild(modal);
            });
            
            document.getElementById('shareSMSBtn').addEventListener('click', () => {
              window['shareToSMS'](text);
              document.body.removeChild(modal);
            });
            
            document.getElementById('shareWebBtn').addEventListener('click', () => {
              window['shareViaWeb'](text);
              document.body.removeChild(modal);
            });
          }
          
          document.getElementById('closeModalBtn').addEventListener('click', () => {
            document.body.removeChild(modal);
          });
          
          // ëª¨ë‹¬ ë°°ê²½ í´ë¦­ ì‹œ ë‹«ê¸°
          modal.addEventListener('click', (e) => {
            if (e.target === modal) {
              document.body.removeChild(modal);
            }
          });
        }
        
        // í´ë¦½ë³´ë“œì— ë³µì‚¬
        function copyToClipboard(text) {
          if (navigator.clipboard && navigator.clipboard.writeText) {
            navigator.clipboard.writeText(text).then(() => {
              alert('âœ… í…ìŠ¤íŠ¸ê°€ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!\n\nì›í•˜ëŠ” ê³³ì— ë¶™ì—¬ë„£ê¸°(Ctrl+V)í•˜ì„¸ìš”.');
            }).catch(err => {
              console.error('í´ë¦½ë³´ë“œ ë³µì‚¬ ì‹¤íŒ¨:', err);
              window['fallbackCopyToClipboard'](text);
            });
          } else {
            window['fallbackCopyToClipboard'](text);
          }
        }
        
        // í´ë¦½ë³´ë“œ ë³µì‚¬ ëŒ€ì²´ ë°©ë²•
        function fallbackCopyToClipboard(text) {
          const textArea = document.createElement('textarea');
          textArea.value = text;
          textArea.style.position = 'fixed';
          textArea.style.left = '-999999px';
          document.body.appendChild(textArea);
          textArea.select();
          try {
            document.execCommand('copy');
            alert('âœ… í…ìŠ¤íŠ¸ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!');
          } catch (err) {
            alert('âŒ ë³µì‚¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ìˆ˜ë™ìœ¼ë¡œ ë³µì‚¬í•´ì£¼ì„¸ìš”.');
            prompt('ì•„ë˜ í…ìŠ¤íŠ¸ë¥¼ ë³µì‚¬í•˜ì„¸ìš”:', text);
          }
          document.body.removeChild(textArea);
        }
        
        // ì¹´ì¹´ì˜¤í†¡ ê³µìœ  (ëª¨ë°”ì¼)
        function shareToKakao(text) {
          // ì¹´ì¹´ì˜¤í†¡ URL ìŠ¤í‚´ ì‚¬ìš©
          const kakaoUrl = `kakaotalk://send?text=${encodeURIComponent(text)}`;
          
          console.log('ğŸ“± ì¹´ì¹´ì˜¤í†¡ ê³µìœ  ì‹œë„...');
          
          // ìƒˆ ì°½ìœ¼ë¡œ ì—´ê¸° ì‹œë„
          const opened = window.open(kakaoUrl, '_blank');
          
          // ì¼ì • ì‹œê°„ í›„ ì¹´ì¹´ì˜¤í†¡ ì„¤ì¹˜ í™•ì¸
          setTimeout(() => {
            if (!opened || opened.closed) {
              // ì¹´ì¹´ì˜¤í†¡ì´ ì„¤ì¹˜ë˜ì§€ ì•Šì€ ê²½ìš°
              if (confirm('ì¹´ì¹´ì˜¤í†¡ì´ ì„¤ì¹˜ë˜ì–´ ìˆì§€ ì•Šê±°ë‚˜ ì—´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\n\ní…ìŠ¤íŠ¸ë¥¼ ë³µì‚¬í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                window['copyToClipboard'](text);
              }
            }
          }, 1500);
        }
        
        // SMS(ë¬¸ì) ê³µìœ  (ëª¨ë°”ì¼)
        function shareToSMS(text) {
          console.log('ğŸ“± SMS ê³µìœ  ì‹œë„...');
          
          // SMS URL ìŠ¤í‚´ ì‚¬ìš©
          // Android: sms:?body=
          // iOS: sms:&body=
          const isIOS = /iPhone|iPad|iPod/i.test(navigator.userAgent);
          const smsUrl = isIOS 
            ? `sms:&body=${encodeURIComponent(text)}`
            : `sms:?body=${encodeURIComponent(text)}`;
          
          window.location.href = smsUrl;
        }
        
        // ì›¹ ê³µìœ  API (ëª¨ë°”ì¼ - ì¹´ì¹´ì˜¤í†¡, ë©”ì‹ ì €, ì´ë©”ì¼ ë“± ì„ íƒ ê°€ëŠ¥)
        function shareViaWeb(text) {
          console.log('ğŸ“± ì›¹ ê³µìœ  API ì‹œë„...');
          
          if (navigator.share) {
            navigator.share({
              title: 'ğŸ“Š ì‚¬ì£¼íŒ”ì ë¶„ì„ ê²°ê³¼',
              text: text
            }).then(() => {
              console.log('âœ… ì›¹ ê³µìœ  ì™„ë£Œ');
            }).catch((error) => {
              // ì‚¬ìš©ìê°€ ì·¨ì†Œí•œ ê²½ìš°
              if (error.name === 'AbortError') {
                console.log('â„¹ï¸ ì‚¬ìš©ìê°€ ê³µìœ ë¥¼ ì·¨ì†Œí–ˆìŠµë‹ˆë‹¤.');
              } else {
                console.error('âŒ ì›¹ ê³µìœ  ì‹¤íŒ¨:', error);
                if (confirm('ê³µìœ ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.\n\ní…ìŠ¤íŠ¸ë¥¼ ë³µì‚¬í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                  window['copyToClipboard'](text);
                }
              }
            });
          } else {
            alert('ì´ ë¸Œë¼ìš°ì €ëŠ” ì›¹ ê³µìœ ë¥¼ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.\ní…ìŠ¤íŠ¸ ë³µì‚¬ ê¸°ëŠ¥ì„ ì‚¬ìš©í•´ì£¼ì„¸ìš”.');
            window['copyToClipboard'](text);
          }
        }
        
        // ğŸ”’ ë‚œë…í™” ë°©ì§€: ëª¨ë“  í•¨ìˆ˜ ì •ì˜ ì™„ë£Œ í›„ ì „ì—­ ê°ì²´ì— ë“±ë¡
        console.log('ğŸ”§ í•¨ìˆ˜ ë“±ë¡ ì‹œì‘...');
        window['loadTicketData'] = loadTicketData;
        window['checkMemberLogin'] = checkMemberLogin;
        window['checkSajuResult'] = checkSajuResult;
        window['redirectToLogin'] = redirectToLogin;
        window['saveFormData'] = saveFormData;
        window['restoreFormData'] = restoreFormData;
        window['generateSajuShareText'] = generateSajuShareText;
        window['showShareOptions'] = showShareOptions;
        window['copyToClipboard'] = copyToClipboard;
        window['fallbackCopyToClipboard'] = fallbackCopyToClipboard;
        window['shareToKakao'] = shareToKakao;
        window['shareToSMS'] = shareToSMS;  // SMS ê³µìœ  í•¨ìˆ˜ ë“±ë¡
        window['shareViaWeb'] = shareViaWeb;
        console.log('âœ… ëª¨ë“  í•¨ìˆ˜ ë“±ë¡ ì™„ë£Œ!');
        
        // í•¨ìˆ˜ ë“±ë¡ ìƒíƒœ í™•ì¸
        console.log('ğŸ” í•¨ìˆ˜ ë“±ë¡ ìƒíƒœ í™•ì¸:');
        console.log('   - checkSajuResult:', typeof window['checkSajuResult']);
        console.log('   - checkMemberLogin:', typeof window['checkMemberLogin']);
        console.log('   - generateSajuShareText:', typeof window['generateSajuShareText']);
        console.log('   - showShareOptions:', typeof window['showShareOptions']);
        
        // ğŸ¯ DOMContentLoaded ì™„ë£Œ í›„ ìµœì¢… ì§„ë‹¨
        console.log('ğŸ¯ DOMContentLoaded ì™„ë£Œ - ìµœì¢… ìƒíƒœ ì§„ë‹¨:');
        setTimeout(() => {
          diagnoseDOMState();
          
          // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë“±ë¡ ìƒíƒœ í…ŒìŠ¤íŠ¸
          console.log('ğŸ§ª ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ í…ŒìŠ¤íŠ¸:');
          const testButtons = [
            { id: 'db-save-btn', name: 'DBì €ì¥' },
            { id: 'send-btn', name: 'ë³´ë‚´ê¸°' },
            { id: 'db-view-btn', name: 'DBë³´ê¸°' }
          ];
          
          testButtons.forEach(btn => {
            const element = document.getElementById(btn.id);
            if (element) {
              // í´ë¦­ ì´ë²¤íŠ¸ ì‹œë®¬ë ˆì´ì…˜ (ì‹¤ì œ ì‹¤í–‰í•˜ì§€ ì•Šê³  ë¦¬ìŠ¤ë„ˆ ì¡´ì¬ë§Œ í™•ì¸)
              const hasListener = element.onclick !== null || 
                                 (element.getAttribute && element.getAttribute('onclick'));
              console.log(`   - ${btn.name} ë²„íŠ¼: ${hasListener ? 'ì´ë²¤íŠ¸ ìˆìŒ' : 'ì´ë²¤íŠ¸ ì—†ìŒ'}`);
            } else {
              console.log(`   - ${btn.name} ë²„íŠ¼: ìš”ì†Œ ì—†ìŒ`);
            }
          });
          
          console.log('ğŸ ëª¨ë“  ì§„ë‹¨ ì™„ë£Œ!');
        }, 200);
      });
    </script>
  </body>
</html>
