<!DOCTYPE html> <html lang="ko"> <head> <meta charset="utf-8" /> <meta name="viewport" content="width=device-width, initial-scale=1" /> <title>관리자 — tickets & thread_messages (비번해시·role 편집)</title> <style> :root { --bg: #f0f4f8; --panel: #ffffff; --muted: #6b7280; --text: #1f2937; --accent: #6366f1; --accent-light: #818cf8; --accent-weak: #eef2ff; --border: #e0e7ef; --good: #10b981; --good-light: #34d399; --warn: #f59e0b; --warn-light: #fbbf24; --bad: #ef4444; --bad-light: #f87171; --chip: #eef2ff; --chip-text: #4338ca; --shadow: 0 4px 16px rgba(99, 102, 241, 0.08), 0 2px 6px rgba(99, 102, 241, 0.04); --shadow-soft: 0 2px 8px rgba(99, 102, 241, 0.06); --shadow-lg: 0 12px 32px rgba(99, 102, 241, 0.12), 0 4px 12px rgba(99, 102, 241, 0.06); --glow: 0 0 20px rgba(99, 102, 241, 0.15); --radius: 16px; --grid-width: 58%; } [data-theme='soft-dark'] { --bg: #0b1220; --panel: #111827; --muted: #9ca3af; --text: #e5e7eb; --accent: #818cf8; --accent-light: #a5b4fc; --accent-weak: #1e293b; --border: #1f2937; --good: #34d399; --good-light: #6ee7b7; --warn: #fbbf24; --warn-light: #fcd34d; --bad: #f87171; --bad-light: #fca5a5; --chip: #1e293b; --chip-text: #a5b4fc; --shadow: 0 8px 24px rgba(0, 0, 0, 0.35), 0 4px 10px rgba(0, 0, 0, 0.25); --shadow-soft: 0 4px 12px rgba(0, 0, 0, 0.25); --shadow-lg: 0 16px 40px rgba(0, 0, 0, 0.45), 0 6px 16px rgba(0, 0, 0, 0.35); --glow: 0 0 24px rgba(129, 140, 248, 0.25); } html, body { height: 100%; } body { margin: 0; font-family: ui-sans-serif, system-ui, -apple-system, 'Segoe UI', Roboto, 'Apple SD Gothic Neo', 'Noto Sans KR', 'Malgun Gothic', sans-serif; background: radial-gradient( circle at 20% 15%, rgba(99, 102, 241, 0.12), transparent 50% ), radial-gradient( circle at 80% 85%, rgba(16, 185, 129, 0.1), transparent 55% ), var(--bg); color: var(--text); -webkit-font-smoothing: antialiased; text-rendering: optimizeLegibility; } .wrap { display: grid; gap: 16px; padding: 16px; max-width: 1400px; margin: 0 auto; grid-template-rows: auto 1fr auto; min-height: 100dvh; } header { background: var(--panel); border: 1px solid var(--border); border-radius: var(--radius); box-shadow: var(--shadow); padding: 14px 18px; display: flex; align-items: center; justify-content: space-between; gap: 12px; backdrop-filter: blur(12px) saturate(180%); background: linear-gradient( 135deg, rgba(99, 102, 241, 0.08), rgba(16, 185, 129, 0.06) ), var(--panel); } .brand { display: flex; align-items: center; gap: 10px; font-weight: 700; font-size: 16px; } .brand .dot { width: 12px; height: 12px; border-radius: 50%; background: linear-gradient(135deg, var(--accent), var(--good)); box-shadow: 0 2px 8px rgba(99, 102, 241, 0.35); animation: pulse 2s ease-in-out infinite; } @keyframes pulse { 0%, 100% { transform: scale(1); opacity: 1; } 50% { transform: scale(1.15); opacity: 0.85; } } .toolbar { display: flex; gap: 8px; flex-wrap: wrap; align-items: center; } .btn { appearance: none; border: 1px solid var(--border); background: var(--panel); color: var(--text); padding: 9px 16px; border-radius: 12px; font-weight: 600; font-size: 14px; cursor: pointer; box-shadow: var(--shadow-soft); transition: all 0.2s ease; } .btn:hover { border-color: var(--accent); transform: translateY(-1px); box-shadow: var(--shadow-lg); } .btn:active { transform: translateY(0); } .btn.primary { background: linear-gradient(135deg, var(--accent), var(--accent-light)); color: #fff; border-color: transparent; } .btn.primary:hover { box-shadow: var(--glow), var(--shadow-lg); } .btn.ghost { background: rgba(255, 255, 255, 0.5); backdrop-filter: blur(8px); } .btn.bad { border-color: transparent; background: linear-gradient(135deg, var(--bad), var(--bad-light)); color: #fff; } .btn.good { border-color: transparent; background: linear-gradient(135deg, var(--good), var(--good-light)); color: #fff; } .btn.warn { border-color: transparent; background: linear-gradient(135deg, var(--warn), var(--warn-light)); color: #231; } .btn-close { appearance: none; border: none; background: #dc3545; color: #fff; padding: 8px 16px; border-radius: 10px; font-weight: 700; font-size: 14px; cursor: pointer; box-shadow: 0 2px 8px rgba(220, 53, 69, 0.3); transition: all 0.2s ease; display: flex; align-items: center; gap: 6px; } .btn-close:hover { background: #c82333; transform: translateY(-1px); box-shadow: 0 4px 12px rgba(220, 53, 69, 0.4); } .btn-close:active { transform: translateY(0); } .chips { display: flex; gap: 8px; align-items: center; flex-wrap: wrap; } .chip { background: linear-gradient( 135deg, var(--chip), rgba(99, 102, 241, 0.08) ); color: var(--chip-text); padding: 7px 12px; border-radius: 999px; font-size: 12px; font-weight: 600; border: 1px solid rgba(99, 102, 241, 0.2); box-shadow: 0 2px 6px rgba(99, 102, 241, 0.1); } main { display: grid; gap: 0; grid-template-columns: var(--grid-width, 48%) auto 1fr; } @media (max-width: 1100px) { main { grid-template-columns: 1fr; gap: 16px; } } .resizer { width: 18px; cursor: col-resize; background: linear-gradient( 90deg, transparent, rgba(99, 102, 241, 0.06), transparent ); border-left: 1px solid var(--border); border-right: 1px solid var(--border); position: relative; transition: background 0.2s ease; } .resizer:hover { background: linear-gradient( 90deg, transparent, rgba(99, 102, 241, 0.12), transparent ); } .resizer::before { content: '⋮'; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); color: var(--muted); font-size: 18px; font-weight: bold; pointer-events: none; } @media (max-width: 1100px) { .resizer { display: none; } } #ticketsPanel { margin-right: 0; } #threadsPanel { margin-left: 0; } .panel { background: var(--panel); border: 1px solid var(--border); border-radius: var(--radius); box-shadow: var(--shadow); display: flex; flex-direction: column; min-height: 360px; overflow: hidden; transition: box-shadow 0.3s ease; } .panel:hover { box-shadow: var(--shadow-lg); } .panel header { border-radius: 0; border: 0; box-shadow: none; padding: 12px 14px; gap: 10px; align-items: flex-start; background: linear-gradient( 180deg, rgba(99, 102, 241, 0.04), transparent ); } .panel-title { font-weight: 800; font-size: 16px; letter-spacing: -0.5px; white-space: nowrap; } .filters { display: grid; gap: 8px; grid-template-columns: 1fr; } .filters-row { display: flex; gap: 8px; flex-wrap: wrap; align-items: center; } .field { display: flex; gap: 6px; align-items: center; background: var(--panel); padding: 8px 12px; border-radius: 12px; border: 1px solid var(--border); box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.05); transition: all 0.2s ease; } .field:focus-within { border-color: var(--accent); box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.15); } .field label { font-size: 12px; color: var(--muted); font-weight: 600; } .select, .input { appearance: none; border: 1px solid var(--border); background: var(--panel); color: var(--text); padding: 8px 12px; border-radius: 10px; min-width: 140px; transition: all 0.2s ease; box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.05); } .select:focus, .input:focus { outline: none; border-color: var(--accent); box-shadow: 0 0 0 2px rgba(99, 102, 241, 0.12); } .input.search { flex: 1; min-width: 220px; } .grid { overflow: auto; border-top: 2px solid var(--border); border-bottom: 2px solid var(--border); padding: 0 16px; } table { border-collapse: separate; border-spacing: 0; width: 100%; table-layout: fixed; } thead th { position: sticky; top: 0; background: var(--panel); border-bottom: 2px solid var(--border); text-align: left; font-size: 12px; font-weight: 700; color: var(--muted); padding: 10px; backdrop-filter: saturate(1.2) blur(4px); cursor: pointer; white-space: nowrap; text-transform: uppercase; letter-spacing: 0.5px; } tbody td { border-bottom: 1px solid var(--border); padding: 10px; font-size: 14px; vertical-align: top; } tbody tr { transition: all 0.2s ease; } tbody tr:hover { background: linear-gradient( 90deg, rgba(99, 102, 241, 0.06), rgba(16, 185, 129, 0.04) ); transform: translateX(2px); } .cut { display: block; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; } tr:hover td { background: transparent; } tr.selected td { background: linear-gradient( 90deg, rgba(99, 102, 241, 0.1), rgba(16, 185, 129, 0.08) ); } .mono { font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, 'Liberation Mono', monospace; font-size: 12px; } .status { display: inline-flex; align-items: center; gap: 6px; padding: 5px 10px; border-radius: 999px; border: 1px solid transparent; font-size: 11px; font-weight: 700; } .status.new { background: linear-gradient( 135deg, rgba(10, 88, 202, 0.15), rgba(10, 88, 202, 0.08) ); color: #0a58ca; border-color: rgba(10, 88, 202, 0.25); } .status.pending { background: linear-gradient( 135deg, rgba(245, 158, 11, 0.2), rgba(245, 158, 11, 0.12) ); color: #b45309; border-color: rgba(245, 158, 11, 0.3); } .status.closed { background: linear-gradient( 135deg, rgba(16, 185, 129, 0.2), rgba(16, 185, 129, 0.12) ); color: #047857; border-color: rgba(16, 185, 129, 0.3); } .muted { color: var(--muted); } footer { display: flex; justify-content: space-between; align-items: center; gap: 8px; padding: 8px 16px; color: var(--muted); font-size: 12px; } dialog::backdrop { background: rgba(0, 0, 0, 0.45); backdrop-filter: blur(4px); } dialog { border: 1px solid var(--border); border-radius: 18px; padding: 0; background: var(--panel); color: var(--text); box-shadow: var(--shadow-lg); max-width: min(720px, 96vw); } .dialog-head { padding: 16px 18px; border-bottom: 2px solid var(--border); font-weight: 800; font-size: 17px; letter-spacing: -0.5px; background: linear-gradient( 180deg, rgba(99, 102, 241, 0.04), transparent ); } .dialog-body { padding: 16px 18px; display: grid; gap: 12px; } .form-grid { display: grid; gap: 12px; grid-template-columns: 1fr 1fr; } .form-grid .full { grid-column: 1/-1; } .form-item { display: flex; flex-direction: column; gap: 6px; } .form-item label { font-size: 12px; font-weight: 600; color: var(--muted); } .form-item input, .form-item textarea, .form-item select { padding: 10px 12px; border-radius: 10px; border: 1px solid var(--border); background: var(--panel); color: var(--text); transition: all 0.2s ease; box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.05); } .form-item input:focus, .form-item textarea:focus, .form-item select:focus { outline: none; border-color: var(--accent); box-shadow: 0 0 0 2px rgba(99, 102, 241, 0.12); } .dialog-foot { display: flex; justify-content: flex-end; gap: 8px; padding: 14px 16px; border-top: 2px solid var(--border); background: linear-gradient( 180deg, transparent, rgba(99, 102, 241, 0.03) ); } /* 추천 폭 */ #tblTickets th:nth-child(1), #tblTickets td:nth-child(1) { width: 120px; } #tblTickets th:nth-child(2), #tblTickets td:nth-child(2) { width: 92px; } #tblTickets th:nth-child(3), #tblTickets td:nth-child(3) { width: 100px; } #tblTickets th:nth-child(4), #tblTickets td:nth-child(4) { width: 120px; } #tblTickets th:nth-child(5), #tblTickets td:nth-child(5) { width: auto; } #tblTickets th:nth-child(6), #tblTickets td:nth-child(6) { width: 120px; } #tblTickets th:nth-child(7), #tblTickets td:nth-child(7) { width: 220px; } #tblThreads th:nth-child(1), #tblThreads td:nth-child(1) { width: 120px; } #tblThreads th:nth-child(2), #tblThreads td:nth-child(2) { width: 120px; } #tblThreads th:nth-child(3), #tblThreads td:nth-child(3) { width: 110px; } /* role */ #tblThreads th:nth-child(4), #tblThreads td:nth-child(4) { width: auto; } /* body */ #tblThreads th:nth-child(5), #tblThreads td:nth-child(5) { width: 220px; } /* message_id */ </style> <link rel="stylesheet" href="{{ url_for('common_static', filename='security.css') }}" /> </head> <body data-theme="soft-light"> <div class="wrap"> <header> <div class="brand"> <span class="dot"></span ><span>관리자 페이지 · 비밀상담요청 & 관리자 답변</span> </div> <div class="toolbar"> <button class="btn" id="btnTheme">테마: 부드러운 라이트</button> <span class="chips"> <span class="chip">정렬: 헤더 클릭</span> <span class="chip">검색: 통합 키워드</span> </span> <button class="btn-close" id="btnClose"> <span>✕</span> <span>닫기</span> </button> </div> </header> <main> <section class="panel" id="ticketsPanel"> <header> <div class="panel-title">① 비밀상담요청</div> <div class="filters" style="width: 100%"> <div class="filters-row"> <div class="field"> <label>상태</label> <select class="select" id="filterStatus"> <option value="">전체</option> <option value="OPEN">OPEN (미답변)</option> <option value="ANSWERED">ANSWERED (답변완료)</option> <option value="CLOSED">CLOSED (종결)</option> </select> </div> <div class="field"> <label>관리자답변유무</label> <select class="select" id="filterHasReply"> <option value="">전체</option> <option value="true">있음</option> <option value="false">없음</option> </select> </div> <input class="input search" id="searchTickets" placeholder="통합 검색: 작성자 이름/ 제목/ 상담문의 내용/ 상담요청 ID" /> <button class="btn good" id="btnAddTicket">티켓 추가</button> <button class="btn warn" id="btnEditTicket" disabled> 수정 </button> <button class="btn bad" id="btnDelTicket" disabled>삭제</button> </div> </div> </header> <div class="grid"> <table id="tblTickets"> <thead> <tr> <th data-sort="title_masked">제목</th> <th data-sort="status">상태</th> <th data-sort="has_admin_reply">답변여부</th> <th data-sort="author_name">이름</th> <th data-sort="author_contact">메모</th> <th data-sort="snsgu">자료구분</th> <th data-sort="created_at">등록일</th> </tr> </thead> <tbody></tbody> </table> </div> <footer> <div> 좌측 선택 시 우측에 관리자 답변이 표시됩니다. (셀 1줄·말줄임) </div> <div id="ticketsCount">0건</div> </footer> </section> <div class="resizer" id="resizer"></div> <section class="panel" id="threadsPanel"> <header> <div class="panel-title"> ② 관리자 답변 <span class="muted" id="threadsTitleHint"></span> </div> <div class="filters"> <div class="filters-row"> <input class="input search" id="searchThreads" placeholder="답변 본문/관리자ID/역할/메시지ID 검색" /> <button class="btn good" id="btnAddMsg" disabled> 답변 추가 </button> <button class="btn warn" id="btnEditMsg" disabled>수정</button> <button class="btn bad" id="btnDelMsg" disabled>삭제</button> </div> </div> </header> <div class="grid" id="threadsGrid"> <table id="tblThreads"> <thead> <tr> <th data-sort="created_at">작성시간</th> <th data-sort="admin_id">관리자ID</th> <th data-sort="role">역할(role)</th> <th data-sort="body">본문</th> <th data-sort="message_id">Msg ID</th> </tr> </thead> <tbody></tbody> </table> </div> <footer> <div id="threadsHint"> 티켓을 선택하면 관련 답변이 여기에 표시됩니다. </div> <div id="threadsCount">0건</div> </footer> </section> </main> <footer> <span>© talktalk-center · 관리자 전용 화면</span> <span class="muted">단축키: ↑↓ 선택, Enter 수정, Del 삭제, / 검색</span> </footer> </div> <dialog id="dlgTicket"> <div class="dialog-head" id="dlgTicketTitle">티켓 추가</div> <div class="dialog-body"> <div class="form-grid"> <div class="form-item"> <label>회원 ID (smember_id)</label> <input id="t_smember_id" /> </div> <div class="form-item"> <label>작성자 이름 (author_name)</label> <input id="t_author_name" /> </div> <div class="form-item"> <label>상태 (status)</label> <select id="t_status"> <option value="OPEN">OPEN (미답변)</option> <option value="ANSWERED">ANSWERED (답변완료)</option> <option value="CLOSED">CLOSED (종결)</option> </select> </div> <div class="form-item"> <label>제목 (title_masked)</label> <input id="t_title_masked" /> </div> <div class="form-item full"> <label>문의 내용 (content_enc)</label> <textarea id="t_content_enc" rows="5"></textarea> </div> <div class="form-item full" id="t_post_pwd_hash_row" style="display: none" > <label >게시글 비밀번호 해시 (bcrypt) — <span class="muted">보통 60자</span></label > <input id="t_post_pwd_hash" class="mono" placeholder="$2b$..." /> </div> </div> <div class="muted"> * ticket_id / created_at 자동 생성. post_pwd_hash는 수정 모드에서만 편집. </div> </div> <div class="dialog-foot"> <button class="btn ghost" data-close>취소</button> <button class="btn primary" id="btnSaveTicket">저장</button> </div> </dialog> <dialog id="dlgMsg"> <div class="dialog-head" id="dlgMsgTitle">답변 추가</div> <div class="dialog-body"> <div class="form-grid"> <div class="form-item"> <label>관리자 ID (admin_id)</label> <input id="m_admin_id" /> </div> <div class="form-item"> <label>역할 (role)</label> <select id="m_role"> <option value="SUPERADMIN">superadmin</option> <option value="ADMIN">admin</option> <option value="ADVISER">adviser</option> <option value="COUNSELOR">counselor</option> <option value="THERAPIST">therapist</option> <option value="PSYCHOLOGIST">psychologist</option> <option value="MENTOR">mentor</option> <option value="STAFF">staff</option> <option value="AUDITOR">auditor</option> <option value="AGENT">agent</option> </select> </div> <div class="form-item"> <label>가시성 (visibility)</label> <select id="m_visibility"> <option value="private">private</option> <option value="internal">internal</option> </select> </div> <div class="form-item full"> <label>답변 본문 (body)</label> <textarea id="m_body" rows="6"></textarea> </div> </div> <div class="muted"> * message_id / created_at / ticket_id 자동 연결. </div> </div> <div class="dialog-foot"> <button class="btn ghost" data-close>취소</button> <button class="btn primary" id="btnSaveMsg">저장</button> </div> </dialog> <script src="{{ url_for('common_static', filename='security.js') }}"></script> <script src="{{ url_for('common_static', filename='admin_session.js') }}"></script> <script src="{{ url_for('common_static', filename='member_session.js') }}"></script> <script src="{{ url_for('static', filename='admin_memlist.js') }}"></script> </body> </html>