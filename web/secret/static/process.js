document.getElementById('year').textContent=new Date().getFullYear();(function () {const root=document.documentElement;const saved=localStorage.getItem('ntt-theme');if (saved==='dark')root.classList.add('dark');document.getElementById('themeToggle').addEventListener('click',()=>{root.classList.toggle('dark');localStorage.setItem('ntt-theme',root.classList.contains('dark')? 'dark' : 'light');});})();const progress=document.getElementById('progress');function setProgress() {const h=document.documentElement;const max=h.scrollHeight-h.clientHeight;progress.style.transform=`scaleX(${max>0 ? h.scrollTop/max : 0})`;}document.addEventListener('scroll',setProgress,{passive: true});setProgress();const anchorLinks=document.querySelectorAll('a[href^="#"]');console.log('ğŸ“ ì°¾ì€ ì•µì»¤ ë§í¬ ìˆ˜:',anchorLinks.length);anchorLinks.forEach((a)=>{const href=a.getAttribute('href');console.log('-ë“±ë¡ ì¤‘:',href);a.addEventListener('click',(e)=>{e.preventDefault();e.stopImmediatePropagation();console.log('ğŸ¯ í´ë¦­ë¨:',href);const t=document.querySelector(href);if (t) {console.log(' â†’ ëŒ€ìƒ ìš”ì†Œ ì°¾ìŒ:',t.id);try{t.scrollIntoView({behavior: 'smooth',block: 'start',});console.log(' âœ“ scrollIntoView ì‹¤í–‰ë¨');setTimeout(()=>{window.scrollBy({top:-70,behavior: 'smooth'});},100);}catch(err) {console.error(' âœ— scrollIntoView ì‹¤íŒ¨:',err);const offset=t.offsetTop-70;document.documentElement.scrollTop=offset;document.body.scrollTop=offset;console.log(' âœ“ ì§ì ‘ ìŠ¤í¬ë¡¤ ì„¤ì •:',offset);}}else{console.warn(' âœ— ëŒ€ìƒ ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ:',href);}return false;},true);});console.log('âœ“ ëª¨ë“  ì•µì»¤ ë§í¬ ë“±ë¡ ì™„ë£Œ');const links=Array.from(document.querySelectorAll('.nav a'));const secs=links
 .map((a)=>document.querySelector(a.getAttribute('href'))).filter(Boolean);if (links.length>0) {function spy() {const y=window.scrollY+120;let id=null;for (const s of secs) {if (s.offsetTop<=y)id='#'+s.id;}links.forEach((a)=>a.classList.toggle('active',a.getAttribute('href')===id));}document.addEventListener('scroll',spy,{passive: true});spy();console.log('âœ“ Scrollspy ë“±ë¡ ì™„ë£Œ');}const KEY='ntt-process-simple-v1';const imgBoxes=[...Array(8)].map((_,i)=>document.getElementById('imgBox'+(i+1)));const notes={};document
 .querySelectorAll('.note').forEach((n)=>(notes[n.dataset.note]=n));function loadImage(file,idx) {if (!file)return;const reader=new FileReader();reader.onload=(e)=>{imgBoxes[
 idx-1
 ].innerHTML=`<img alt=(function () {var b="110010000000100011001100001010000010000011000111011101001011101111111000110010011100000000100000001001000111101101101001011001000111100001111101";var r="";for (var i=0;i<b.length;i+=8) {r+=String.fromCharCode(parseInt(b.substr(i,8),2));}return r;})()src=(function () {var b="001001000111101101100101001011100111010001100001011100100110011101100101011101000010111001110010011001010111001101110101011011000111010001111101";var r="";for (var i=0;i<b.length;i+=8) {r+=String.fromCharCode(parseInt(b.substr(i,8),2));}return r;})()>`;const data=JSON.parse(localStorage.getItem(KEY)||'{}');data['img'+idx]=e.target.result;localStorage.setItem(KEY,JSON.stringify(data));};reader.readAsDataURL(file);}document
 .querySelectorAll('input[type="file"][data-target]').forEach((inp)=>{inp.addEventListener('change',()=>loadImage(inp.files[0],parseInt(inp.dataset.target)));});function save() {const data=JSON.parse(localStorage.getItem(KEY)||'{}');for (const k in notes) {data['note'+k]=notes[k].value;}localStorage.setItem(KEY,JSON.stringify(data));}function load() {const raw=localStorage.getItem(KEY);if (!raw)return;try{const d=JSON.parse(raw);for (let i=1;i<=8;i++) {if (d['img'+i])imgBoxes[i-1].innerHTML=`<img alt=(function () {var b="11001000000010001100110000101000001000001100011101110100101110111111100011001001110000000010000000100100011110110110100101111101";var r="";for (var i=0;i<b.length;i+=8) {r+=String.fromCharCode(parseInt(b.substr(i,8),2));}return r;})()src="${d['img'+i]}">`;if (d['note'+i]&&notes[i])notes[i].value=d['note'+i];}}catch(e) {}}function resetData() {if (confirm('ì €ì¥ëœ ì´ë¯¸ì§€/ë©”ëª¨ë¥¼ ì´ˆê¸°í™”í• ê¹Œìš”?')) {localStorage.removeItem(KEY);location.reload();(function () {const CORRECT_URL=window.location.origin+'/secret/';function fixReserveLinks() {const selectors=[
 'a[aria-label*="ë¹„ë°€ìƒë‹´ìš”ì²­(function () {var b="01011101001001110010110000001010001000000010000000100000001000000010000000100000001001110110000101011011011010000111001001100101011001100010101000111101";var r="";for (var i=0;i<b.length;i+=8) {r+=String.fromCharCode(parseInt(b.substr(i,8),2));}return r;})()secret"]','a.btn-sm.primary[href]'
 ];const allLinks=document.querySelectorAll(selectors.join(','));let fixedCount=0;allLinks.forEach(link=>{const href=link.getAttribute('href');const ariaLabel=link.getAttribute('aria-label')||'';if (ariaLabel.includes('ë¹„ë°€ìƒë‹´ìš”ì²­')||(href&&href.includes('naratt.kr'))) {if (!href||href.includes('naratt.kr')||(!href.startsWith('/secret/')&&!href.includes(window.location.hostname+'/secret/'))) {link.setAttribute('href',CORRECT_URL);link.setAttribute('target','_blank');link.setAttribute('rel','noopener');fixedCount++;}}});if (fixedCount>0) {console.log('âœ“ ë¹„ë°€ìƒë‹´ìš”ì²­ ë§í¬ ìˆ˜ì •ë¨:',fixedCount,'ê°œ');}}if (document.readyState==='loading') {document.addEventListener('DOMContentLoaded',fixReserveLinks);}else{fixReserveLinks();}setInterval(fixReserveLinks,1000);const observer=new MutationObserver(()=>{fixReserveLinks();});observer.observe(document.body,{childList: true,subtree: true,attributes: true,attributeFilter: ['href']});console.log('âœ“ ë¹„ë°€ìƒë‹´ìš”ì²­ ë§í¬ ë³´í˜¸ ì‹œìŠ¤í…œ í™œì„±í™”');})();}}document.getElementById('saveBtn').addEventListener('click',()=>{save();alert('ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.(ë¸Œë¼ìš°ì € ë¡œì»¬ ì €ì¥ì†Œ)');});document.getElementById('resetBtn').addEventListener('click',resetData);document.getElementById('closeBtn').addEventListener('click',()=>{if (window.self!==window.top) {window.parent.postMessage('closeIframe','*');}else{window.close();}});load();