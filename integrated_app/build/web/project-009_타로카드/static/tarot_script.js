(function(){const errBox=document.getElementById('err');window.addEventListener('error',(e)=>{errBox.textContent='ì‹¤í–‰ ì˜¤ë¥˜: '+(e&&e.message?e.message:'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜');errBox.style.display='block';});const MAJOR_ARCANA=[{en:'The Fool',kr:'ë°”ë³´'},{en:'The Magician',kr:'ë§ˆë²•ì‚¬'},{en:'The High Priestess',kr:'ì—¬ì‚¬ì œ'},{en:'The Empress',kr:'ì—¬ì œ'},{en:'The Emperor',kr:'í™©ì œ'},{en:'The Hierophant',kr:'êµí™©'},{en:'The Lovers',kr:'ì—°ì¸'},{en:'The Chariot',kr:'ì „ì°¨'},{en:'Strength',kr:'í˜'},{en:'The Hermit',kr:'ì€ë‘”ì'},{en:'Wheel of Fortune',kr:'ìš´ëª…ì˜ ìˆ˜ë ˆë°”í€´'},{en:'Justice',kr:'ì •ì˜'},{en:'The Hanged Man',kr:'ë§¤ë‹¬ë¦° ë‚¨ì'},{en:'Death',kr:'ì£½ìŒ'},{en:'Temperance',kr:'ì ˆì œ'},{en:'The Devil',kr:'ì•…ë§ˆ'},{en:'The Tower',kr:'íƒ‘'},{en:'The Star',kr:'ë³„'},{en:'The Moon',kr:'ë‹¬'},{en:'The Sun',kr:'íƒœì–‘'},{en:'Judgement',kr:'ì‹¬íŒ'},{en:'The World',kr:'ì„¸ê³„'},];const SUITS=[{en:'Wands',kr:'ì™„ë“œ'},{en:'Cups',kr:'ì»µ'},{en:'Swords',kr:'ì†Œë“œ'},{en:'Pentacles',kr:'íœíƒ€í´'},];const MINOR=['Ace','Two','Three','Four','Five','Six','Seven','Eight','Nine','Ten','Page','Knight','Queen','King',];const FACE_KO={Page:'í˜ì´ì§€',Knight:'ë‚˜ì´íŠ¸',Queen:'í€¸',King:'í‚¹',};const DECK=[];MAJOR_ARCANA.forEach((c,i)=>DECK.push({id:i,en:c.en,kr:c.kr,type:'major'}));let _idx=MAJOR_ARCANA.length;SUITS.forEach((s)=>MINOR.forEach((n)=>DECK.push({id:_idx++,en:`${n}of ${s.en}`,kr:`${s.kr}${n=='Ace'?'ì—ì´ìŠ¤':FACE_KO[n]||n}`,type:'minor',suit:s.en,num:n,})));const KWD_MAJOR={'The Fool':{up:['ëŒ€ë‹´í•œ ì‹œì‘','ì‹ ë¢°ì˜ ì í”„','ì´ˆì‹¬ì˜ ììœ '],rev:['ì¶©ë™ì  ì„ íƒ','ì¤€ë¹„ ë¯¸í¡','í˜„ì‹¤ê° ë¶€ì¡±'],},'The Magician':{up:['ì˜ì§€â†’í˜„ì‹¤í™”','ì§‘ì¤‘ë ¥','ìì› í†µí•©'],rev:['ê¸°ìˆ  ë‚¨ìš©','ê³¼ì¥/ì†ì„','ì˜ì§€ ë¶„ì‚°'],},'The High Priestess':{up:['ê¹Šì€ ì§ê´€','ë¹„ë°€ì˜ ë¬¸','ê°ì •ì˜ ì •ì '],rev:['ì‹ í˜¸ ë¬´ì‹œ','ê°ì • ë‘”ê°','ë‚´ë©´ê³¼ ë‹¨ì ˆ'],},'The Empress':{up:['í’ìš”/ì„±ì¥','ê´€ê³„ ì–‘ìœ¡','ì°½ì¡°ì„±'],rev:['ê³¼ë³´í˜¸','ê²Œìœ¼ë¦„','ê²½ê³„ íë¦¼'],},'The Emperor':{up:['ì§ˆì„œ/ê·œì¹™','ì±…ì„ ë¦¬ë”ì‹­','ê²½ê³„ ì„¤ì •'],rev:['ê¶Œìœ„ì£¼ì˜','ê²½ì§ì„±','ìœµí†µì„± ê²°í•'],},'The Hierophant':{up:['ì •í†µ/ë©˜í† ','ì²´ê³„ í•™ìŠµ','ì œë„ì  ì•ˆì „'],rev:['í˜•ì‹ì£¼ì˜','ê¶Œìœ„ ë°˜ê°','í‹€ì— ê°‡í˜'],},'The Lovers':{up:['ê°€ì¹˜ ì •ë ¬','ëŒë¦¼/ì„ íƒ','ê´€ê³„ì˜ í•©'],rev:['ìš°ìœ ë¶€ë‹¨','ìœ í˜¹/ì‚¼ê°','ê°€ì¹˜ ë¶ˆì¼ì¹˜'],},'The Chariot':{up:['ì˜ì§€ ìŠ¹ë¦¬','ë°©í–¥ í†µì œ','ì§‘ì¤‘ ì „ì§„'],rev:['í­ì£¼/í¸í–¥','ë™ë ¥ ë¶„ì‚°','í†µì œ ìƒì‹¤'],},Strength:{up:['ë¶€ë“œëŸ¬ìš´ í˜','ìê¸°ì¡°ì ˆ','íšŒë³µ íƒ„ë ¥'],rev:['ì–µëˆ„ë¥¸ ë¶„ë…¸','ë¶ˆì•ˆ/ì†Œì§„','ìì±…'],},'The Hermit':{up:['ë‚´ë©´ íƒêµ¬','í˜„ì/ì§€ë„','ê¹Šì€ í†µì°°'],rev:['ê³ ë¦½í™”','ê³¼ë„í•œ ì‹ ì¤‘','í–‰ë™ ì§€ì—°'],},'Wheel of Fortune':{up:['ë³€ê³¡/ì „í™˜','ìš´ íë¦„','ì£¼ê¸° ì¸ì‹'],rev:['íƒ€ì´ë° ì•…í™”','ê¸°íšŒ ë†“ì¹¨','ë°˜ë³µ íŒ¨í„´'],},Justice:{up:['ê³µì •/ê· í˜•','ì‚¬ì‹¤ ê²€ì¦','ì±…ì„ ìˆ˜ìš©'],rev:['ë¶ˆê· í˜•','ì±…ì„ íšŒí”¼','ì™œê³¡'],},'The Hanged Man':{up:['ê´€ì  ì „í™˜','ìœ ë³´ì˜ ì§€í˜œ','ì˜ë¯¸ ìˆëŠ” í¬ìƒ'],rev:['ë¬´ê¸°ë ¥í•œ ì •ì²´','í—Œì‹  í›„íšŒ','ì§€ì—°ë§Œ ë°˜ë³µ'],},Death:{up:['ë‹¨í˜¸í•œ ì¢…ë£Œ','ì •ë¦¬/íƒˆí”¼','ìƒˆ êµ­ë©´'],rev:['ë¯¸ë ¨/ì €í•­','ë íšŒí”¼','ì§€ì—°ëœ ë³€ì‹ '],},Temperance:{up:['í˜¼í•©/ì¡°ìœ¨','ì ë‹¹í•¨','ì¹˜ìœ  íë¦„'],rev:['ê³¼ìœ ë¶ˆê¸‰','ë¶ˆê· í˜•','ì ˆì œ ì‹¤íŒ¨'],},'The Devil':{up:['ì§‘ì°© ì¸ì‹','ìœ í˜¹ ì ê²€','ì˜ì¡´ êµ¬ì¡°'],rev:['ëŠì–´ë‚´ê¸°','íƒˆì¤‘ë…','ê²½ê³„ íšŒë³µ'],},'The Tower':{up:['ì¶©ê²©ì  ì§„ì‹¤','í—ˆìƒ ë¶•ê´´','ì¬êµ¬ì„±'],rev:['í”¼í•´ ìµœì†Œí™”','ê²½ê³  ì‹ í˜¸','ì—°ì°©ë¥™'],},'The Star':{up:['í¬ë§/íšŒë³µ','ì •í™”','ì˜ê°ì˜ ë¹›'],rev:['ìì‹ ê° ì €í•˜','íë¦¿í•¨','ì‹ ë¢° í”ë“¤ë¦¼'],},'The Moon':{up:['ë¶ˆí™•ì‹¤ì„±','ë¬´ì˜ì‹','ìƒìƒ/ë‘ë ¤ì›€'],rev:['ëª…ë£Œí•´ì§','ì˜¤í•´ í•´ì†Œ','í˜„ì‹¤ ì ê²€'],},'The Sun':{up:['ëª…ë£Œ/ì„±ì·¨','ìƒê¸°','ê³µê°œ/íˆ¬ëª…'],rev:['ì§€ì—°ëœ ì„±ê³µ','ê³¼ë„í•œ ë‚™ê´€','ì£¼ëª© ê³¼ë¶€í•˜'],},Judgement:{up:['ì†Œëª…/ê°ì„±','í‰ê°€/ì •ì‚°','ì¬ê¸°íšŒ'],rev:['ìì±… ë£¨í”„','ê²°ì • ë¯¸ë£¸','ì‹ í˜¸ ë¬´ì‹œ'],},'The World':{up:['ì™„ì„±/í†µí•©','ìˆœí™˜ ì¢…ë£Œ','ë‹¤ìŒ ì±•í„°'],rev:['ë¯¸ì™„ì˜ ê³ ë¦¬','ë‹«íŒ ì„¸ê³„','ìŠ¤ì¼€ì¼ì—… í•„ìš”'],},};const SUIT_BASE={Wands:{up:['ë™ê¸°','ì¶”ì§„','ì—´ì • ì‹¤í–‰'],rev:['ì†Œì§„','ì‚°ë§Œ','ì†ë„ ê³¼ë‹¤'],},Cups:{up:['ê°ì •','ê´€ê³„','ê³µê° êµë¥˜'],rev:['ê°ì • ê³¼ì‰','ì˜ì¡´','íšŒí”¼'],},Swords:{up:['ì´ì„±','íŒë‹¨','ëª…ë£Œ ì†Œí†µ'],rev:['ê³¼ì‰ ë¹„íŒ','ê°ˆë“±','ëƒ‰ì†Œ'],},Pentacles:{up:['í˜„ì‹¤','ìì›','ì„±ê³¼ ì¶•ì '],rev:['ì§€ì—°','ì§‘ì°©','ë¶ˆì•ˆì •'],},};const RANK_BASE={Ace:{up:['ê¸°ì›','ì›ë™ë ¥','ê¸°íšŒ ì°½'],rev:['ì§€ì—°','ì‹œë™ ë¶ˆëŸ‰','ë¶„ì‚°'],},Two:{up:['ì„ íƒ','ì •ë ¬','ê· í˜•'],rev:['ìš°ìœ ë¶€ë‹¨','ë¹„ëŒ€ì¹­','ëŒ€ë¦½'],},Three:{up:['í™•ì¥','í˜‘ì—…','ì´ˆê¸° ì„±ê³¼'],rev:['ì§€ì—°','ë¶ˆí˜‘','ì¬ì¡°ì •'],},Four:{up:['ì•ˆì •','êµ¬ì¡°','ì •ì°©'],rev:['ì •ì²´','ê¶Œíƒœ','ê²½ì§']},Five:{up:['ë„ì „','ê²½ìŸ','ê°ˆë“±'],rev:['ì†ì‹¤ ì¶•ì†Œ','ì¬ì •ë¹„','ì¤‘ì¬'],},Six:{up:['ì¡°í™” íšŒë³µ','ì¸ì •','ì§„ì „'],rev:['ìë¦¬ì‹¸ì›€','í—ˆìƒ ì‡¼','ì§€ì—°'],},Seven:{up:['í‰ê°€/ìˆ˜ì„±','ë°©ì–´','ì„ ë³„'],rev:['ë¶ˆì•ˆ','ë°©ì–´ ê³¼ì‰','ê¸°ì¤€ í˜¼ì„ '],},Eight:{up:['ì†ë„/ëª°ì…','ì´ë™','ì§‘ì¤‘'],rev:['ì‚°ë§Œ','ì§€ì²´','ë°©í–¥ ì¬ì„¤ì •'],},Nine:{up:['ì¸ë‚´/ìœ ì§€','ê²½ê³„','ì™„ì£¼ ì§ì „'],rev:['ê³¼ë¶€í•˜','ê³ ë¦½','íšŒë³µ í•„ìš”'],},Ten:{up:['ì™„ê²°/ì±…ì„','ë¶€ë‹´ ì¢…ê²°'],rev:['ê³¼ì¤‘','ë¯¸ì™„','ìœ„ì„ í•„ìš”'],},Page:{up:['í•™ìŠµ/ë©”ì‹ ì €','íƒìƒ‰','ì‹ í˜¸'],rev:['ìœ ì¹˜í•¨','ë¯¸ì„±ìˆ™','í”¼ìƒ'],},Knight:{up:['ì¶”ì§„/ëª¨í—˜','ì „ê°œ','ì†ë„'],rev:['ê²½ì†”','ë¶ˆì•ˆì •','ì¶©ëŒ'],},Queen:{up:['ìˆ™ë ¨/ëŒë´„','ë‚´ë©´ í†µì°°'],rev:['ê°ì • í¸í–¥','ì†Œê·¹','íì‡„'],},King:{up:['í†µì†”/ì „ë¬¸','ì˜ì‚¬ê²°ì •'],rev:['ê¶Œìœ„ ë‚¨ìš©','ê²½ì§','ë…ì„ '],},};function buildMinorKeywords(suit,rank,reversed){const s=SUIT_BASE[suit];const r=RANK_BASE[rank];const out=[];(reversed?s.rev:s.up).forEach((k)=>out.push(k));(reversed?r.rev:r.up).forEach((k)=>out.push(k));return out.slice(0,5);}
function getKeywords(card,reversed){if(card.type==='major'){const e=KWD_MAJOR[card.en];return e?(reversed?e.rev:e.up):[];}
return buildMinorKeywords(card.suit,card.num,reversed);}
const spread=document.getElementById('spread');const resultBox=document.getElementById('result');const status=document.getElementById('status');const btnReset=document.getElementById('reset');const btnReshuffle=document.getElementById('reshuffle');const maxCountInput=document.getElementById('maxCount');const themeBtn=document.getElementById('themeBtn');const closeBtn=document.getElementById('closeBtn');const slotsWrap=document.getElementById('slots');const showTips=document.getElementById('showTips');const presetSelect=document.getElementById('presetSelect');const applyPresetBtn=document.getElementById('applyPreset');const THEMES=['theme-light-1','theme-light-2','theme-light-3','theme-light','theme-mid','theme-dark',];let themeIdx=0;try{const saved=localStorage.getItem('tarot_theme_idx');if(saved!==null)themeIdx=+saved%THEMES.length;}catch(e){}
document.body.classList.remove(...THEMES);document.body.classList.add(THEMES[themeIdx]);function cycleTheme(){document.body.classList.remove(...THEMES);themeIdx=(themeIdx+1)%THEMES.length;document.body.classList.add(THEMES[themeIdx]);try{localStorage.setItem('tarot_theme_idx',String(themeIdx));}catch(e){}}
themeBtn.addEventListener('click',cycleTheme);window.addEventListener('keydown',(e)=>{if(e.key==='t'||e.key==='T')cycleTheme();if(e.key==='Escape')goBack();});function goBack(){if(window.history.length>1){window.history.back();}else{window.location.href='/';}}
closeBtn.addEventListener('click',goBack);const PRESETS={oneCard:{count:1,labels:['ì˜¤ëŠ˜ì˜ ì¡°ì–¸'],tips:['í•µì‹¬ ê¸°ì¡°Â·íƒœë„ 1ê°€ì§€'],},threeCard:{count:3,labels:['ê³¼ê±°','í˜„ì¬','ë¯¸ë˜'],tips:['ê¸°ì›/ì›ì¸','í•µì‹¬ ì´ìŠˆ','ì „ê°œ ë°©í–¥'],},fiveInsight:{count:5,labels:['ë¬¸ì œ','ì›ì¸','ì¡°ì–¸','ì¥ì• ','ê²°ê³¼'],tips:['ë¬¸ì œ ì •ì˜','ë¿Œë¦¬ ì›ì¸','ì‹¤í–‰ íŒíŠ¸','ì£¼ì˜ ì§€ì ','ì˜ˆìƒ ê²°ê³¼'],},decision2:{count:2,labels:['ì„ íƒ A','ì„ íƒ B'],tips:['Aì˜ ë³¸ì§ˆ/ê²°ê³¼','Bì˜ ë³¸ì§ˆ/ê²°ê³¼'],},relationship_basic:{count:5,labels:['ë‚˜ì˜ ìƒíƒœ','ìƒëŒ€ ìƒíƒœ','ê´€ê³„ ìƒíƒœ','ì¥ì• /ê°ˆë“±','ì‹¤ì²œ ì¡°ì–¸'],tips:['ë‚˜ì˜ ìš•êµ¬/ë¶ˆì•ˆ','ìƒëŒ€ì˜ ìš•êµ¬/ìš°ë ¤','ê±°ë¦¬/ì˜ì¡´/í˜¸í˜œì„±','ê°ˆë“± ì›ì¸Â·íŒ¨í„´','ì¦‰ì‹œ í–‰ë™ í•˜ë‚˜',],},relationship_deep:{count:7,labels:['ìƒëŒ€ì˜ í˜„ì¬','ë‚˜ì˜ í˜„ì¬','ê´€ê³„ ì—­í•™','ì¥ì• /ê°ˆë“±','ì„±ì¥ í¬ì¸íŠ¸','ì‹¤ì²œ ì¡°ì–¸','ë‹¨ê¸° ì „ë§',],tips:['ìƒëŒ€ ê°ì •Â·ì˜ë„','ë‚˜ì˜ ìš•êµ¬Â·ê²½ê³„','í˜ì˜ ê· í˜•/ì˜ì¡´/ê±°ë¦¬','ê°ˆë“± ì´‰ë°œ ìš”ì¸','ê´€ê³„ ì„±ìˆ™ì˜ ì—´ì‡ ','ì¦‰ì‹œ ì ìš©í•  í•œ ê°€ì§€','1~3ê°œì›” ë¶„ìœ„ê¸°',],},compatibility6:{count:6,labels:['ë‚˜ì˜ ê°•ì ','ë‚˜ì˜ ì•½ì ','ìƒëŒ€ ê°•ì ','ìƒëŒ€ ì•½ì ','ì‹œë„ˆì§€','ì£¼ì˜ì ',],tips:['ê´€ê³„ì—ì„œ ë°œíœ˜ë˜ëŠ” ì¥ì ','ë³´ì™„í•  ì ','ê´€ê³„ì—ì„œì˜ ì¥ì ','ë³´ì™„í•  ì ','í•©/ì¶© í¬ì¸íŠ¸','ë¦¬ìŠ¤í¬ ê´€ë¦¬',],},career_path:{count:6,labels:['í˜„ìƒ','í•µì‹¬ ì—­ëŸ‰','ê¸°íšŒ','ë¦¬ìŠ¤í¬','ì „ëµ','ê²°ê³¼'],tips:['í˜„ì¬ í¬ì§€ì…˜','ë‚´ê°€ ì˜í•˜ëŠ” ê²ƒ','ì—´ë¦¬ëŠ” ë¬¸/íŠ¸ë Œë“œ','ì¥ì• ë¬¼/ì œì•½','êµ¬ì²´ì  ì•¡ì…˜','ì¤‘ê¸° ì „ë§',],},interview:{count:6,labels:['ê°•ì  ì–´í•„','ë³´ì™„ í¬ì¸íŠ¸','ë©´ì ‘ê´€ ê´€ì ','ë¬¸í™” ì í•©ë„','ì§ˆë¬¸ ì „ëµ','í•©ê²© ê°€ëŠ¥ì„±',],tips:['í•µì‹¬ ì—­ëŸ‰Â·ì„±ê³¼','ê°œì„ /í•™ìŠµ ì˜ì§€','ê·¸ë“¤ì´ ë³´ëŠ” ë‚˜','íŒ€/ì¡°ì§ í•','ê¼­ í•  ì§ˆë¬¸','í™•ë¥ /ë³´ì™„',],},negotiation:{count:7,labels:['í˜„ ìƒí™©','ìƒëŒ€ ì´í•´ê´€ê³„','ë‚´ ì´í•´ê´€ê³„','êµí™˜ ê°€ì¹˜','ì–‘ë³´ í•œê³„','ì œì•ˆ ë©”ì‹œì§€','ì˜ˆìƒ ê²°ê³¼',],tips:['ì‚¬ì‹¤/ìˆ«ì/ê°ì • ë¶„ë¦¬','ìƒëŒ€ì˜ ë“ì‹¤/ì••ë°•','ë‚´ ìš°ì„ ìˆœìœ„/ë ˆë“œë¼ì¸','ëˆ ì™¸ ê°€ì¹˜','ìµœì†Œ ìˆ˜ìš©ì¹˜','í•œ ë¬¸ì¥ ì œì•ˆ','A/B/C ì‹œë‚˜ë¦¬ì˜¤',],},contract:{count:6,labels:['ìƒëŒ€ ì˜ë„','ë‚´ í˜‘ìƒë ¥','í•µì‹¬ ì¡°ê±´','ë¦¬ìŠ¤í¬','BATNA','ê²°ë¡ /íƒ€ì´ë°',],tips:['ìˆ«ì ë’¤ ì˜ë„','ì§€ë ›ëŒ€/ì¦ê±°','ê°€ê²©Â·ë²”ìœ„Â·SLA','ë¶ˆë¦¬í•œ ì¡°í•­','ìµœì„  ëŒ€ì•ˆ','ì–¸ì œ/ì–´ë–»ê²Œ',],},startup:{count:7,labels:['ë¬¸ì œ ì •ì˜','ê³ ê°/í˜ë¥´ì†Œë‚˜','ì†”ë£¨ì…˜ í•µì‹¬','ì‹œì¥/ê²½ìŸ','ì‹¤í—˜ ì„¤ê³„','ë¦¬ìŠ¤í¬ ê´€ë¦¬','ëŸ°ì›¨ì´/ì „ë§',],tips:['Pain ëª…í™•ë„','ì´ˆê¸° íƒ€ê¹ƒ','ì°¨ë³„Â·ë¶ˆê°€ê²°ì„±','ëŒ€ì²´ì¬/ìš°ìœ„','MVPÂ·ì§€í‘œ','ë²•/íŒ€/ê¸°ìˆ ','í˜„ê¸ˆ/ë‹¤ìŒ ë¶„ê¸°',],},investment:{count:6,labels:['í˜„ì¬ í¬ì§€ì…˜','ê¸°íšŒ ìš”ì¸','ë¦¬ìŠ¤í¬ ìš”ì¸','ì§„ì…/ì²­ì‚°','ìê¸ˆê´€ë¦¬','ì „ë§',],tips:['ë…¸ì¶œ/ë¶„ì‚°','ëª¨ë©˜í…€/ê°€ì¹˜/ì´ë²¤íŠ¸','ë³€ë™/ê·œì œ','ìˆ«ì ê¸°ì¤€','ì‚¬ì´ì§•/ì†ì ˆ','ë‹¨/ì¤‘ê¸°',],},horseshoe7:{count:7,labels:['ê³¼ê±°','í˜„ì¬','ë¯¸ë˜','ì¡°ì–¸','ì™¸ë¶€ì˜í–¥','ì¥ì• /ë„ì „','ê²°ë¡ '],tips:['íë¦„ì˜ ê¸°ì›','í•µì‹¬ ì´ìŠˆ','ì „ê°œ ë°©í–¥','í•µì‹¬ í–‰ë™','í™˜ê²½/íƒ€ì','ë‚´Â·ì™¸ë¶€ ì¥ì• ','ì¢…í•© íŒë‹¨',],},celtic10:{count:10,labels:['í˜„ì¬ìƒí™©','êµì°¨/ì¥ì• ','ì˜ì‹(ì˜ë„)','ë¬´ì˜ì‹(ê·¼ì›)','ê³¼ê±°','ë¯¸ë˜','ìì‹ ì˜íƒœë„','í™˜ê²½/íƒ€ì¸','í¬ë§/ë‘ë ¤ì›€','ê²°ë¡ ',],tips:['í•µì‹¬ í…Œë§ˆ','ì¦‰ì‹œ ì¥ì• ','ê²‰ ëª©í‘œ','ìˆ¨ì€ ë™ì¸','ë°°ê²½','ë‹¤ê°€ì˜¬ ê²ƒ','ë‚´ íƒœë„','ì£¼ë³€ ì˜í–¥','ë°”ëŒ/ìš°ë ¤','ìµœì¢… ê²°ë¡ ',],},astro_12house:{count:12,labels:['1 í•˜ìš°ìŠ¤(ìê¸°)','2(ìì›)','3(ì†Œí†µ)','4(ê°€ì •)','5(ì°½ì¡°/ì—°ì• )','6(ì¼/ê±´ê°•)','7(íŒŒíŠ¸ë„ˆ)','8(í•©ì/ë³€í™”)','9(ì² í•™/êµìœ¡)','10(ì»¤ë¦¬ì–´)','11(ë„¤íŠ¸ì›Œí¬)','12(ë¬´ì˜ì‹)',],tips:['ì •ì²´ì„±/ì¸ìƒ','ëˆ/ê°€ì¹˜ê´€','í•™ìŠµ/ì´ì›ƒ/ë¬¸ì„œ','ë¿Œë¦¬/ê°€ì¡±','í‘œí˜„/ì—°ì• /ì·¨ë¯¸','ì¼ìƒ/ê±´ê°•/ì„œë¹„ìŠ¤','ê´€ê³„/ê³„ì•½','ê³µë™ìì›/ì‹¬ë¦¬ë³€í™˜','ì—¬í–‰/ê³ ë“±êµìœ¡/ì‹ ë…','ì§ì—…/ëª…ì„±','ì¹œêµ¬/ì»¤ë®¤ë‹ˆí‹°','ì˜ì„±/ìˆ¨ì€ ì˜í–¥',],},astro_planets7:{count:7,labels:['íƒœì–‘','ë‹¬','ìˆ˜ì„±','ê¸ˆì„±','í™”ì„±','ëª©ì„±','í† ì„±'],tips:['ì˜ì§€/ìê¸°í‘œí˜„','ê°ì •/ìŠµê´€','ì‚¬ê³ /ì†Œí†µ','ë§¤ë ¥/ê´€ê³„','ì¶”ì§„/ê°ˆë“±','í™•ì¥/ê¸°íšŒ','í•œê³„/êµ¬ì¡°',],},astro_elements4:{count:4,labels:['ë¶ˆ(í™”)','í™(í† )','ê³µê¸°','ë¬¼'],tips:['ë™ê¸°/ì—´ì •','í˜„ì‹¤/ì§€ì†','ì‚¬ê³ /ì†Œí†µ','ê°ì •/ê´€ê³„'],},astro_year12:{count:12,labels:['1ì›”','2ì›”','3ì›”','4ì›”','5ì›”','6ì›”','7ì›”','8ì›”','9ì›”','10ì›”','11ì›”','12ì›”',],tips:['ì—°ì´ˆ ê¸°ì¡°','ê´€ê³„/ìì› ì •ë¹„','ì†Œí†µ/í•™ìŠµ','ê°€ì •/ì•ˆì •','í‘œí˜„/ì—°ì• ','ê±´ê°•/ì¼ìƒ','íŒŒíŠ¸ë„ˆì‹­','ë³€í™”/ì§‘ì¤‘','ì—¬í–‰/í•™ìŠµ','ì»¤ë¦¬ì–´','ë„¤íŠ¸ì›Œí¬','ì •ë¦¬/íšŒë³µ',],},};let currentLabels=[];let currentTips=[];const quickButtons=document.querySelectorAll('.preset-spreads .preset');quickButtons.forEach((btn)=>btn.addEventListener('click',()=>applyPreset(btn.dataset.name)));applyPresetBtn.addEventListener('click',()=>{const v=presetSelect.value;if(v)applyPreset(v);});function applyPreset(name){const p=PRESETS[name];if(!p)return;maxCountInput.value=String(p.count);currentLabels=p.labels.slice();currentTips=p.tips?p.tips.slice():[];onMaxChange();toast(`${name.replace(/_/g,' ').toUpperCase()}í”„ë¦¬ì…‹ ì ìš© â€” ${p.count}ì¥`);}
function toast(msg){let t=document.getElementById('presetToast');if(!t){t=document.createElement('div');t.id='presetToast';Object.assign(t.style,{position:'fixed',left:'50%',bottom:'20px',transform:'translateX(-50%)',background:'rgba(15,23,42,.88)',color:'#e2e8f0',border:'1px solid rgba(148,163,184,.3)',padding:'10px 14px',borderRadius:'12px',fontWeight:'700',zIndex:'9999',transition:'opacity .3s',});document.body.appendChild(t);}
t.textContent=msg;t.style.opacity='1';clearTimeout(t._timer);t._timer=setTimeout(()=>(t.style.opacity='0'),1400);}
let order=[],picked=[],locked=false;function shuffleDeck(){order=[...DECK.keys()];for(let i=order.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[order[i],order[j]]=[order[j],order[i]];}}
function getCardSVG(card){if(card.type==='major')
return'<svg class="cardimg" viewBox="0 0 32 32"><circle cx="16" cy="16" r="13" fill="#f7e8ff"/><polygon points="16,4 19,13 29,13 21,18 24,28 16,22 8,28 11,18 3,13 13,13" fill="#e573b7"/></svg>';if(card.suit==='Wands')
return'<svg class="cardimg" viewBox="0 0 32 32"><rect x="14" y="6" width="4" height="20" rx="2" fill="#e573b7"/><circle cx="16" cy="26" r="3" fill="#ffe4ef"/></svg>';if(card.suit==='Cups')
return'<svg class="cardimg" viewBox="0 0 32 32"><ellipse cx="16" cy="12" rx="8" ry="6" fill="#ffe4ef"/><rect x="12" y="12" width="8" height="10" rx="4" fill="#e573b7"/></svg>';if(card.suit==='Swords')
return'<svg class="cardimg" viewBox="0 0 32 32"><rect x="15" y="6" width="2" height="18" fill="#e573b7"/><polygon points="16,4 18,8 14,8" fill="#ffe4ef"/></svg>';if(card.suit==='Pentacles')
return'<svg class="cardimg" viewBox="0 0 32 32"><circle cx="16" cy="16" r="8" fill="#ffe4ef"/><polygon points="16,10 19,18 13,18" fill="#e573b7"/></svg>';return'';}
function renderSpread(keepDeck=false){if(keepDeck&&spread.classList.contains('deck-mode')){const existingDeck=document.getElementById('deckStack');const cards=spread.querySelectorAll('.tarot');cards.forEach((c)=>c.remove());}else if(!keepDeck){spread.innerHTML='';}
order.forEach((dex,idx)=>{const card=DECK[dex];const el=document.createElement('button');el.className='tarot';el.setAttribute('data-id',String(card.id));el.setAttribute('aria-label','ì¹´ë“œ ì„ íƒ');if(idx>=10){el.style.setProperty('--i',String(idx-10));}
el.innerHTML='<div class="inner"><div class="back"><span>TAROT</span></div><div class="face">'+
getCardSVG(card)+
'<div class="title">#'+
(card.id+1)+
' '+
card.kr+
'</div><div class="subtitle">('+
card.en+
')</div></div></div><div class="badge">#</div>';el.addEventListener('click',()=>onPick(el,card));spread.appendChild(el);});}
function spreadDeck(){shuffleDeck();renderSpread(false);spread.classList.remove('deck-mode');const deckStack=document.getElementById('deckStack');if(deckStack){deckStack.remove();}
toast('âœ¨ 78ì¥ì˜ ì¹´ë“œê°€ ë¬´ì‘ìœ„ë¡œ í¼ì³ì¡ŒìŠµë‹ˆë‹¤!');}
function collectDeck(){spread.classList.add('deck-mode');const existingDeck=document.getElementById('deckStack');if(existingDeck){existingDeck.remove();}
const deckStack=document.createElement('div');deckStack.id='deckStack';deckStack.className='deck-stack';deckStack.innerHTML='<div class="deck-prompt"><div class="deck-text">ğŸ´ í´ë¦­í•˜ì—¬ ì¹´ë“œ í¼ì¹˜ê¸°</div></div>';deckStack.addEventListener('click',spreadDeck);spread.insertBefore(deckStack,spread.firstChild);}
function initializeDeck(){const initialDeckStack=document.getElementById('deckStack');if(initialDeckStack){initialDeckStack.addEventListener('click',spreadDeck);}}
function onPick(el,card){if(locked)return;const i=picked.findIndex((p)=>p.id===card.id);if(i>=0){picked.splice(i,1);el.classList.remove('flipped','selected');el.style.transform='';el.querySelector('.badge').textContent='#';updateSelectedUI();return;}
const maxCount=parseInt(maxCountInput.value,10);if(picked.length>=maxCount)return;const reversed=Math.random()<0.5;el.style.transition='transform 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55)';setTimeout(()=>{el.classList.add('flipped','selected');if(reversed){el.style.transform='rotate(180deg)';}},50);const kw=getKeywords(card,reversed);picked.push({id:card.id,en:card.en,kr:card.kr,reversed,kw});el.querySelector('.badge').textContent='#'+picked.length;updateSelectedUI();if(picked.length===maxCount){locked=true;}}
function updateSelectedUI(){const maxCount=parseInt(maxCountInput.value,10);(document.getElementById('status')||{innerHTML:''}).innerHTML='ì§„í–‰: <b>'+
picked.length+
' / '+
maxCount+
'</b>'+
(currentLabels.length?' <span style="opacity:.8">(í”„ë¦¬ì…‹ ì ìš©)</span>':'');slotsWrap.innerHTML='';for(let i=0;i<maxCount;i++){const slot=document.createElement('div');slot.className='slot';const mini=document.createElement('div');mini.className='mini';const wrap=document.createElement('div');wrap.className='info';const label=document.createElement('div');label.className='label';const tipEl=document.createElement('div');tipEl.className='tip';const kwEl=document.createElement('div');kwEl.className='kw';label.textContent=currentLabels[i]||i+1+'ë²ˆ ì¹´ë“œ';tipEl.textContent=showTips.checked&&currentTips[i]?'ğŸ’¡ '+currentTips[i]:'';if(picked[i]){const c=picked[i];mini.innerHTML='<div style="position:relative;width:46px;height:69px">'+
'<div style="position:absolute;inset:0;background:linear-gradient(135deg,#ffe4ef 60%,#f7e8ff 100%);border-radius:8px;display:flex;flex-direction:column;align-items:center;justify-content:center;padding:6px;text-align:center;'+
(c.reversed?'transform:rotate(180deg);':'')+
'">'+
getCardSVG(c)+
"<div style='font-weight:800;font-size:11px;background:rgba(255,255,255,.7);border-radius:6px;padding:2px 6px;margin-top:2px'>#"+
(c.id+1)+
' '+
c.kr+
'</div>'+
"<div style='font-size:10px;color:#475569;background:rgba(255,255,255,.7);border-radius:6px;padding:2px 6px;margin-top:2px'>("+
c.en+
')</div>'+
"<div style='font-size:10px;color:#e573b7;margin-top:2px'>"+
(c.reversed?'ì—­ìœ„':'ì •ìœ„')+
'</div>'+
'</div></div>';kwEl.innerHTML='<b>'+
(c.reversed?'ì—­ìœ„':'ì •ìœ„')+
':</b> '+
(c.kw&&c.kw.length?c.kw.join(' Â· '):'â€”');}else{mini.textContent='#'+(i+1);kwEl.textContent='';}
wrap.appendChild(label);if(showTips.checked&&currentTips[i])wrap.appendChild(tipEl);wrap.appendChild(kwEl);slot.appendChild(mini);slot.appendChild(wrap);slotsWrap.appendChild(slot);}
resultBox.textContent=picked.length?picked.map((p,i)=>i+
1+
'. #'+
(p.id+1)+
' '+
p.kr+
' ('+
p.en+
') â€” '+
(p.reversed?'ì—­ìœ„':'ì •ìœ„')+
' | '+
(p.kw?p.kw.join(', '):'')).join('\n'):'ì•„ì§ ì„ íƒëœ ì¹´ë“œê°€ ì—†ìŠµë‹ˆë‹¤.';}
function resetAll(){picked=[];locked=false;document.querySelectorAll('.tarot').forEach((el)=>{el.classList.remove('flipped','selected');el.style.transform='';const b=el.querySelector('.badge');if(b)b.textContent='#';});updateSelectedUI();}
function reshuffleAll(){shuffleDeck();picked=[];locked=false;renderSpread(false);collectDeck();updateSelectedUI();toast('ğŸ”„ ì¹´ë“œë¥¼ ë‹¤ì‹œ ì„ì—ˆìŠµë‹ˆë‹¤! ë±ì„ í´ë¦­í•˜ì—¬ í¼ì¹˜ì„¸ìš”.');}
function onMaxChange(){resetAll();updateSelectedUI();}
document.querySelectorAll('.preset-spreads .preset').forEach((btn)=>btn.addEventListener('click',()=>applyPreset(btn.dataset.name)));btnReset.addEventListener('click',resetAll);btnReshuffle.addEventListener('click',reshuffleAll);maxCountInput.addEventListener('change',onMaxChange);showTips.addEventListener('change',updateSelectedUI);shuffleDeck();renderSpread(true);initializeDeck();updateSelectedUI();})();